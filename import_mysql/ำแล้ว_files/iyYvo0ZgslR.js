if (self.CavalryLogger) { CavalryLogger.start_js(["5IX07"]); }

__d("FBRTCDismissReason",[],(function(a,b,c,d,e,f){e.exports={CALL_ENDED:0,ANSWERED_ON_ANOTHER_DEVICE:1,IN_ANOTHER_CALL:2,CONNECTION_DROPPED:3,REJECTED_ON_ANOTHER_DEVICE:4,REMOVED_BY_PARTICIPANT:5,REJECTED_BY_CALLEE:6,INTERNAL_ERROR:7,JOIN_APPROVAL_DENIED:8}}),null);
__d("FBRTCHangupReason",[],(function(a,b,c,d,e,f){e.exports={IGNORE_CALL:0,HANGUP_CALL:1,NO_ANSWER_TIMEOUT:2,CLIENT_ERROR:3,IN_ANOTHER_CALL:4,CLIENT_INTERRUPTED:5,SESSION_MIGRATED:6}}),null);
__d("FBRTCMediaType",[],(function(a,b,c,d,e,f){e.exports={AUDIO:0,VIDEO:1,DATA:2}}),null);
__d("FBRTCRtcResponseStatusCode",[],(function(a,b,c,d,e,f){e.exports={OK:200,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,METHOD_NOT_ALLOWED:406,CONDITIONAL_REQUEST_FAILED:412,BUSY_HERE:486,SERVER_INTERNAL_ERROR:500,SERVICE_UNAVAILABLE:503,PRECONDITION_FAILURE:580}}),null);
__d("ChromeExtensionInstallError",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;b=babelHelpers.inherits(a,Error);g=b&&b.prototype;function a(a,b,c){g.constructor.call(this,a),this.message=a,this.$ChromeExtensionInstallError3=a,this.$ChromeExtensionInstallError1=c,this.$ChromeExtensionInstallError2=b,this.name=this.constructor.name}a.prototype.toString=function(){return this.name+": "+[this.message,this.$ChromeExtensionInstallError2,this.$ChromeExtensionInstallError1].join("-")};a.prototype.getTypedMessage=function(){return this.$ChromeExtensionInstallError3};a.prototype.getInstallType=function(){return this.$ChromeExtensionInstallError2};e.exports=a}),null);
__d("ChromeExtensionInstallErrorTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHROME_WEBSTORE_UNDEFINED:"CHROME_WEBSTORE_UNDEFINED",EXTENSION_INSTALL_FAILED:"EXTENSION_INSTALL_FAILED",EXTENSION_STORE_INSTALL_TIMEOUT:"EXTENSION_STORE_INSTALL_TIMEOUT"})}),null);
__d("RTCChromeExtensionListener",["DateConsts","EventEmitter"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("DateConsts").MS_PER_SEC;var h=c;d=babelHelpers.inherits(a,b("EventEmitter"));g=d&&d.prototype;function a(a){g.constructor.call(this),this.$RTCChromeExtensionListener1=!1,this.$RTCChromeExtensionListener2=null,this.$RTCChromeExtensionListener5=function(a){var b=a;if(a.type==="notificationButtonClicked"){var c=a.buttonIndex;a=a.notificationId;c!==0&&c!==1&&(b={type:"notificationClicked",notificationId:a})}this.emit(b.type,b)}.bind(this),this.$RTCChromeExtensionListener6=function(a){a.onMessage.removeListener(this.$RTCChromeExtensionListener5),this.$RTCChromeExtensionListener2=null,this.emit("portDisconnected"),this.$RTCChromeExtensionListener1===!1&&this.$RTCChromeExtensionListener7(h)}.bind(this),this.$RTCChromeExtensionListener3=a}a.prototype.$RTCChromeExtensionListener4=function(){if(this.$RTCChromeExtensionListener2==null)try{var a=window.chrome.runtime.connect(this.$RTCChromeExtensionListener3,{name:"notifications"});a.onMessage.addListener(this.$RTCChromeExtensionListener5);a.onDisconnect.addListener(this.$RTCChromeExtensionListener6);this.$RTCChromeExtensionListener2=a;this.emit("portConnected")}catch(a){this.emit("portConnectionError",a)}};a.prototype.$RTCChromeExtensionListener7=function(){var a=arguments.length<=0||arguments[0]===undefined?10:arguments[0];window.setTimeout(function(){this.$RTCChromeExtensionListener4()}.bind(this),a)};a.prototype.connect=function(){this.$RTCChromeExtensionListener7()};a.prototype.disconnect=function(){this.$RTCChromeExtensionListener2!=null&&(this.$RTCChromeExtensionListener1=!0,this.$RTCChromeExtensionListener2.disconnect(),this.$RTCChromeExtensionListener2=null)};e.exports=a}),null);
__d("RTCChromeScreenSharingExtension",["Promise","RTCChromeExtensionListener","uuid"],(function(a,b,c,d,e,f){__p&&__p();var g="ncfpggehkhmjpdjpefomjchjafhmbnai";function a(a){return new(b("RTCChromeExtensionListener"))(a)}function h(a,c){return new(b("Promise"))(function(b,d){window.chrome.runtime.sendMessage(c,a,function(a){if(a!=null)typeof a==="object"&&a.type==="error"?d(new Error(a.message)):b(a);else{a=window.chrome.runtime.lastError.message;d(new Error(a))}})})}function c(a){var b=arguments.length<=1||arguments[1]===undefined?["screen","window","tab"]:arguments[1];return h({type:"getStreamID",sources:b},a)}function d(a,b){return h({type:"cancel",requestID:a},b)}function f(){return b("uuid")()}e.exports={EXTENSION_ID:g,connectToNotifications:a,generateNotificationID:f,getMediaSourceFromExtension:c,sendExtensionRequest:h,stopExtensionScreenSharing:d}}),null);
__d("ScreenSharingExtensionInstallationEvent",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({STARTED:"started",INSTALLED:"installed",FAILED:"failed"})}),null);
__d("ScreenSharingExtensionInstallationType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({INLINE:"inline",STORE:"store"})}),null);
__d("ScreenSharingExtensionInstallationTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.clear()}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:ScreenSharingExtensionInstallationLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:ScreenSharingExtensionInstallationLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:ScreenSharingExtensionInstallationLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setExtensionID=function(a){this.$1.extension_id=a;return this};a.prototype.setFailReason=function(a){this.$1.fail_reason=a;return this};a.prototype.setInstallEvent=function(a){this.$1.install_event=a;return this};a.prototype.setSourceApp=function(a){this.$1.source_app=a;return this};a.prototype.setType=function(a){this.$1.type=a;return this};a.prototype.setURIPath=function(a){this.$1.uri_path=a;return this};a.prototype.setVC=function(a){this.$1.vc=a;return this};c={extension_id:!0,fail_reason:!0,install_event:!0,source_app:!0,type:!0,uri_path:!0,vc:!0};e.exports=a}),null);
__d("CollabRTCChromeScreenSharingExtension",["invariant","Promise","regeneratorRuntime","ChromeExtensionInstallErrorTypes","ChromeExtensionInstallError","DateConsts","ScreenSharingExtensionInstallationType","ScreenSharingExtensionInstallationEvent","ScreenSharingExtensionInstallationTypedLogger","RTCChromeScreenSharingExtension","gkx","idx","isFacebookURI","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();c=b("DateConsts").MS_PER_MIN;var h=b("RTCChromeScreenSharingExtension").EXTENSION_ID,i=b("RTCChromeScreenSharingExtension").generateNotificationID,j=b("RTCChromeScreenSharingExtension").getMediaSourceFromExtension,k=b("RTCChromeScreenSharingExtension").sendExtensionRequest,l=b("RTCChromeScreenSharingExtension").stopExtensionScreenSharing,m="DIALOG_USER_CANCEL",n="EXTENSION_NOT_FOUND",o="MESSAGESENDER_TAB_UNDEFINED",p="REQUEST_ID_UNDEFINED",q="UNEXPECTED_ERROR",r="data-fb-only-screensharing-extension-available",s=250,t=2*c,u=2;function a(){this.DIALOG_USER_CANCEL=m,this.EXTENSION_NOT_FOUND=n,this.MESSAGESENDER_TAB_UNDEFINED=o,this.REQUEST_ID_UNDEFINED=p,this.UNEXPECTED_ERROR=q,this.$2=h}a.prototype.isInstalled=function(){var a=document;a=a.documentElement;return a!=null?a.hasAttribute(r)&&a.getAttribute(r)==="true"?!0:!1:!1};a.prototype.$3=function(a,c){__p&&__p();var d=(c=a)!=null?(c=c.chrome)!=null?c.webstore:c:c;if(d==null)return b("Promise").reject(new(b("ChromeExtensionInstallError"))(b("ChromeExtensionInstallErrorTypes").CHROME_WEBSTORE_UNDEFINED,b("ScreenSharingExtensionInstallationType").INLINE));var e=window.document.documentElement;v(this.getExtensionURL(),window.document);a!==window&&v(this.getExtensionURL(),a.document);return new(b("Promise"))(function(a,c){d.install(this.getExtensionURL(),function(){e!=null&&e.setAttribute(this.getPresenseAttr(),"true"),a()}.bind(this),function(a,d){c(new(b("ChromeExtensionInstallError"))(b("ChromeExtensionInstallErrorTypes").EXTENSION_INSTALL_FAILED,b("ScreenSharingExtensionInstallationType").INLINE,d))})}.bind(this)).then(function(){this.$4(u);return b("ScreenSharingExtensionInstallationType").INLINE}.bind(this))};a.prototype.$5=function(a){__p&&__p();if(this.isInstalled())return b("Promise").resolve(b("ScreenSharingExtensionInstallationType").STORE);v(this.getExtensionURL(),window.document);a=(a=window)!=null?(a=a.chrome)!=null?a.webstore:a:a;if(a==null)return b("Promise").reject(new(b("ChromeExtensionInstallError"))(b("ChromeExtensionInstallErrorTypes").CHROME_WEBSTORE_UNDEFINED,b("ScreenSharingExtensionInstallationType").STORE));window.open(this.getExtensionURL(),"_blank");return this.$4(t/s).then(function(){var a=window.document.documentElement;a.setAttribute(this.getPresenseAttr(),"true");return b("ScreenSharingExtensionInstallationType").STORE}.bind(this))["catch"](function(){throw new(b("ChromeExtensionInstallError"))(b("ChromeExtensionInstallErrorTypes").EXTENSION_STORE_INSTALL_TIMEOUT,b("ScreenSharingExtensionInstallationType").STORE)})};a.prototype.getPresenseAttr=function(){return r};a.prototype.isInlineInstallCapableDomain=function(){return b("isFacebookURI")(b("URI").getRequestURI())};a.prototype.install=function(a){if(this.isInstalled())return b("Promise").resolve();new(b("ScreenSharingExtensionInstallationTypedLogger"))().setInstallEvent(b("ScreenSharingExtensionInstallationEvent").STARTED).setExtensionID(this.$2).setSourceApp(a).log();return this.$6(a).then(function(c){new(b("ScreenSharingExtensionInstallationTypedLogger"))().setInstallEvent(b("ScreenSharingExtensionInstallationEvent").INSTALLED).setExtensionID(this.$2).setType(c).setSourceApp(a).setURIPath(b("URI").getRequestURI().getPath()).log()}.bind(this))["catch"](function(c){new(b("ScreenSharingExtensionInstallationTypedLogger"))().setInstallEvent(b("ScreenSharingExtensionInstallationEvent").FAILED).setExtensionID(this.$2).setFailReason(c.getTypedMessage()).setType(c.getInstallType()).setSourceApp(a).setURIPath(b("URI").getRequestURI().getPath()).log();throw c}.bind(this))};a.prototype.$6=function(a){__p&&__p();if(!this.isInlineInstallCapableDomain())return this.$5(a);if(window.opener){if(b("gkx")("AT4oK_7JC5TTZYywhfbwFBQ7pWrCP25GhIYJYeTXORatm7YiPEPnzywhysM8xfJZufAO5vBilwUW96zDpBUM53et41qE6E73Q_2-qy7gqb5uKw"))return this.$5(a);try{window.opener.document;return window.opener.closed?this.$5(a):this.$3(window.opener,a)}catch(b){return this.$5(a)}}return this.$3(window,a)};a.prototype.getSourceID=function(a){__p&&__p();var c;return b("regeneratorRuntime").async(function(d){__p&&__p();while(1)switch(d.prev=d.next){case 0:if(this.isInstalled()){d.next=2;break}throw new Error(n);case 2:d.next=4;return b("regeneratorRuntime").awrap(j(this.$2,a));case 4:c=d.sent;d.t0=c.type;d.next=d.t0==="streamID"?8:d.t0==="canceledGetStreamID"?10:11;break;case 8:this.$1=c.requestID;return d.abrupt("return",c.streamID);case 10:throw new Error(m);case 11:throw new Error(q);case 12:case"end":return d.stop()}},null,this)};a.prototype.getExtensionID=function(){return this.$2};a.prototype.getExtensionURL=function(){return"https://chrome.google.com/webstore/detail/"+this.$2};a.prototype.stop=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:a.next=2;return b("regeneratorRuntime").awrap(l(this.$1,this.$2));case 2:this.$1=null;case 3:case"end":return a.stop()}},null,this)};a.prototype.$4=function(a){return k({type:"ping"},this.$2)["catch"](function(b){if(a<1)throw b;return w(s).then(function(){return this.$4(a-1)}.bind(this))}.bind(this))};a.prototype.isMinimumVersionNumber=function(a,c,d){__p&&__p();var e,f,g,h,i,j;return b("regeneratorRuntime").async(function(l){__p&&__p();while(1)switch(l.prev=l.next){case 0:if(this.isInstalled()){l.next=2;break}throw new Error("Chrome extension is not installed");case 2:l.next=4;return b("regeneratorRuntime").awrap(k({type:"ping"},this.$2));case 4:e=l.sent;f=e.version;g=f.split(".").map(function(a){return parseInt(a,10)});h=g[0];i=g[1];j=g[2];if(!(h>=a)){l.next=14;break}if(!(i>c)){l.next=13;break}return l.abrupt("return",!0);case 13:return l.abrupt("return",i===c&&j>=d);case 14:return l.abrupt("return",!1);case 15:case"end":return l.stop()}},null,this)};a.prototype.isNewVersion=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.isMinimumVersionNumber(1,10,0));case 2:a=c.sent;if(!(a===!0)){c.next=5;break}return c.abrupt("return");case 5:throw new Error("Chrome extension version is lower than 1.10.0");case 6:case"end":return c.stop()}},null,this)};a.prototype.focusTabAndWindow=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:c.next=4;return b("regeneratorRuntime").awrap(k({type:"focusTabAndWindow"},this.$2));case 4:a=c.sent;return c.abrupt("return",{tab:a.tab,window:a.window});case 6:case"end":return c.stop()}},null,this)};a.prototype.getLastFocusedWindow=function(a){__p&&__p();var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:d.next=4;return b("regeneratorRuntime").awrap(k({type:"getLastFocusedWindow",getInfo:a},this.$2));case 4:c=d.sent;return d.abrupt("return",c.window);case 6:case"end":return d.stop()}},null,this)};a.prototype.getTabForSender=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:c.next=4;return b("regeneratorRuntime").awrap(k({type:"getTabForSender"},this.$2));case 4:a=c.sent;return c.abrupt("return",a.tab);case 6:case"end":return c.stop()}},null,this)};a.prototype.getTabAndWindowForSender=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:c.next=4;return b("regeneratorRuntime").awrap(k({type:"getTabAndWindowForSender"},this.$2));case 4:a=c.sent;return c.abrupt("return",{tab:a.tab,window:a.window});case 6:case"end":return c.stop()}},null,this)};a.prototype.getWindow=function(a,c){__p&&__p();var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:e.next=4;return b("regeneratorRuntime").awrap(k({type:"getWindow",windowId:a,getInfo:c},this.$2));case 4:d=e.sent;return e.abrupt("return",d.window);case 6:case"end":return e.stop()}},null,this)};a.prototype.updateTab=function(a,c){__p&&__p();var d,e;return b("regeneratorRuntime").async(function(f){__p&&__p();while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:d={type:"updateTab",updateProperties:a};c!==undefined&&(d.tabId=c);f.next=6;return b("regeneratorRuntime").awrap(k(d,this.$2));case 6:e=f.sent;return f.abrupt("return",e.tab);case 8:case"end":return f.stop()}},null,this)};a.prototype.updateWindow=function(a,c){__p&&__p();var d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:e.next=4;return b("regeneratorRuntime").awrap(k({type:"updateWindow",windowId:a,updateInfo:c},this.$2));case 4:d=e.sent;return e.abrupt("return",d.window);case 6:case"end":return e.stop()}},null,this)};a.prototype.clearNotification=function(a){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this.isNotificationPermissionGranted());case 2:c=e.sent;if(!(c===!1)){e.next=5;break}throw new Error("Chrome extension notifications permission not granted");case 5:e.next=7;return b("regeneratorRuntime").awrap(k({type:"clearNotification",notificationId:a},this.$2));case 7:d=e.sent;return e.abrupt("return",d.wasCleared);case 9:case"end":return e.stop()}},null,this)};a.prototype.createNotification=function(a){__p&&__p();var c,d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(this.isNotificationPermissionGranted());case 2:c=e.sent;if(!(c===!1)){e.next=5;break}throw new Error("Chrome extension notifications permission not granted");case 5:e.next=7;return b("regeneratorRuntime").awrap(k({type:"createNotification",notificationId:i(),options:a},this.$2));case 7:d=e.sent;return e.abrupt("return",d.notificationId);case 9:case"end":return e.stop()}},null,this)};a.prototype.getAllNotifications=function(){__p&&__p();var a,c;return b("regeneratorRuntime").async(function(d){__p&&__p();while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(this.isNotificationPermissionGranted());case 2:a=d.sent;if(!(a===!1)){d.next=5;break}throw new Error("Chrome extension notifications permission not granted");case 5:d.next=7;return b("regeneratorRuntime").awrap(k({type:"getAllNotifications"},this.$2));case 7:c=d.sent;return d.abrupt("return",Object.keys(c.notifications));case 9:case"end":return d.stop()}},null,this)};a.prototype.getNotificationsPermissionLevel=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(this.isNewVersion());case 2:c.next=4;return b("regeneratorRuntime").awrap(k({type:"getNotificationsPermissionLevel"},this.$2));case 4:a=c.sent;return c.abrupt("return",a.level);case 6:case"end":return c.stop()}},null,this)};a.prototype.updateNotification=function(a,c){__p&&__p();var d,e;return b("regeneratorRuntime").async(function(f){__p&&__p();while(1)switch(f.prev=f.next){case 0:f.next=2;return b("regeneratorRuntime").awrap(this.isNotificationPermissionGranted());case 2:d=f.sent;if(!(d===!1)){f.next=5;break}throw new Error("Chrome extension notifications permission not granted");case 5:f.next=7;return b("regeneratorRuntime").awrap(k({type:"updateNotification",notificationId:a,options:c},this.$2));case 7:e=f.sent;return f.abrupt("return",e.wasUpdated);case 9:case"end":return f.stop()}},null,this)};a.prototype.isNotificationPermissionGranted=function(){__p&&__p();var a;return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:a="denied";c.prev=1;c.next=4;return b("regeneratorRuntime").awrap(this.getNotificationsPermissionLevel());case 4:a=c.sent;c.next=10;break;case 7:c.prev=7,c.t0=c["catch"](1),a="denied";case 10:c.t1=a;c.next=c.t1==="granted"?13:c.t1==="denied"?14:15;break;case 13:return c.abrupt("return",!0);case 14:return c.abrupt("return",!1);case 15:throw new Error("Received an unexpected permission level: "+a);case 16:case"end":return c.stop()}},null,this,[[1,7]])};function v(a,b){var c="chrome-webstore-item";if(!b.querySelector('link[href="'+a+'"][rel="'+c+'"]')){var d=b.createElement("link");d.setAttribute("href",a);d.setAttribute("rel",c);b.head!=null||g(0);b.head.appendChild(d)}}function w(a){return new(b("Promise"))(function(b){return setTimeout(b,a)})}e.exports=new a()}),null);
__d("CollabRTCChromeScreenSharing",["CollabRTCChromeScreenSharingExtension"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={focusTabAndWindow:function(){return b("CollabRTCChromeScreenSharingExtension").focusTabAndWindow()},getLastFocusedWindow:function(a){return b("CollabRTCChromeScreenSharingExtension").getLastFocusedWindow(a)},getTabForSender:function(){return b("CollabRTCChromeScreenSharingExtension").getTabForSender()},getTabAndWindowForSender:function(){return b("CollabRTCChromeScreenSharingExtension").getTabAndWindowForSender()},getWindow:function(a,c){return b("CollabRTCChromeScreenSharingExtension").getWindow(a,c)},getSourceID:function(a,c){return b("CollabRTCChromeScreenSharingExtension").install(c).then(function(){return b("CollabRTCChromeScreenSharingExtension").getSourceID(a)})},stop:function(){return b("CollabRTCChromeScreenSharingExtension").stop()},updateTab:function(a,c){return b("CollabRTCChromeScreenSharingExtension").updateTab(a,c)},updateWindow:function(a,c){return b("CollabRTCChromeScreenSharingExtension").updateWindow(a,c)}};e.exports=a}),null);
__d("RTCAppDispatcher",["ExplicitRegistrationDispatcher"],(function(a,b,c,d,e,f){var g;c=babelHelpers.inherits(a,b("ExplicitRegistrationDispatcher"));g=c&&c.prototype;function a(a){"use strict";g.constructor.call(this,a),this.dispatch=this.dispatch.bind(this)}e.exports=new a({strict:!0})}),null);
__d("RTCEndCallReason",["fbt","FBRTCConstants","FBRTCDismissReason","FBRTCHangupReason","FBRTCRtcResponseStatusCode"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").CallEndReason,i=b("FBRTCConstants").CollabCallEndSubreason;function j(a){this.$1=-1,this.$3="local",typeof a==="string"||a instanceof String?this.$1=h.strNames.indexOf(a):this.$1=a}j.prototype.setSubreason=function(a){this.$2=a;return this};j.prototype.getSubreason=function(){return this.$2};j.prototype.setRemoteEnded=function(a){this.$3=a?"remote":"local";return this};j.prototype.getRemoteEnded=function(){return this.$3==="remote"};j.prototype.toStrName=function(){var a=arguments.length<=0||arguments[0]===undefined?!0:arguments[0];return a?this.$4()+"_"+this.$3:this.$4()};j.prototype.$4=function(){return this.$1<0||this.$1>h.strNames.length?"Unknown":h.strNames[this.$1]};j.prototype.getReasonID=function(){return this.$1};j.prototype.toString=function(){var a=arguments.length<=0||arguments[0]===undefined?!1:arguments[0],b=(this.$5()||"").toString();return a?b+" "+this.$6():b};j.prototype.$5=function(){__p&&__p();switch(this.$1){case h.NO_ANSWER_TIMEOUT:case h.IGNORE_CALL:return g._("No Answer");case h.OTHER_NOT_CAPABLE:if(this.$2===i.MCU_INVALID_STREAM_CONFIGURATION)return g._("Too many clients connected to the room");case h.INCOMING_TIMEOUT:case h.NO_PERMISSION:case h.OTHER_CARRIER_BLOCKED:return g._("Not Reachable");case h.SIGNALING_MESSAGE_FAILED:case h.WEBRTC_ERROR:case h.NO_UI_ERROR:case h.CALLER_NOT_VISIBLE:case h.CLIENT_ERROR:return g._("Call Failed");case h.UNSUPPORTED_VERSION:return g._("Can't Connect Call");case h.IN_ANOTHER_CALL:return g._("In Another Call");case h.CARRIER_BLOCKED:return g._("Switch to Wi-Fi to complete your call");case h.CLIENT_INTERRUPTED:return g._("Call Interrupted");case h.HANGUP_CALL:case h.ACCEPT_AFTER_HANGUP:return g._("Call Ended");case h.CONNECTION_DROPPED:return g._("Connection Lost");case h.OTHER_INSTANCE_HANDLED:return null;case h.CLIENT_ENCRYPTION_ERROR:return g._("Client Encryption Error");case h.INACTIVE_TIMEOUT:return g._("Call is Inactive");default:return null}};j.prototype.$6=function(){__p&&__p();if(this.$1!==h.OTHER_NOT_CAPABLE&&this.$1!==h.SIGNALING_MESSAGE_FAILED)return"";switch(this.$2){case i.REMOTE_PEER_HANGUP:case i.REMOTE_PEER_REJECT:return"";case i.CLOSED_BY_MCU:return"- Call expired";case i.CLOSED_AS_STALE:return"- Server failed, call is stale";case i.CALL_INITIALIZATION_FAILED:return"- Call initialization to room failed";case i.SIP_CONNECTION_INITIALIZATION_FAILED:return"or No Answer";case i.LOST_MCU_CONNECTION:return"- MCU Media connection failed";case i.LOST_MCU_THRIFT_CONNECTION:return"- MCU infrastructure dropped connection";case i.LOST_SIP_ADAPTER_CONNECTION:return"- SIP infrastructure dropped connection";case i.MCU_NO_AUDIO_STREAM:return"- Invalid audio stream";case i.MCU_INVALID_STREAM_CONFIGURATION:return"- Invalid stream configuration";case i.UNKNOWN:default:return"- Unexpected call failure: "+(this.$2||"null")}};j.fromHangupReason=function(a){switch(a){case b("FBRTCHangupReason").IGNORE_CALL:return new j(h.IGNORE_CALL);case b("FBRTCHangupReason").NO_ANSWER_TIMEOUT:return new j(h.NO_ANSWER_TIMEOUT);case b("FBRTCHangupReason").HANGUP_CALL:return new j(h.HANGUP_CALL);case b("FBRTCHangupReason").CLIENT_ERROR:return new j(h.CLIENT_ERROR);case b("FBRTCHangupReason").IN_ANOTHER_CALL:return new j(h.IN_ANOTHER_CALL);case b("FBRTCHangupReason").CLIENT_INTERRUPTED:return new j(h.CLIENT_INTERRUPTED);default:return new j(h.HANGUP_CALL)}};j.fromDismissRequest=function(a){__p&&__p();if(!a)return new j(h.HANGUP_CALL);switch(a.reason){case b("FBRTCDismissReason").ANSWERED_ON_ANOTHER_DEVICE:case b("FBRTCDismissReason").REJECTED_ON_ANOTHER_DEVICE:return new j(h.OTHER_INSTANCE_HANDLED);case b("FBRTCDismissReason").CALL_ENDED:return new j(h.HANGUP_CALL);case b("FBRTCDismissReason").IN_ANOTHER_CALL:return new j(h.IN_ANOTHER_CALL);case b("FBRTCDismissReason").CONNECTION_DROPPED:return new j(h.CONNECTION_DROPPED);case b("FBRTCDismissReason").REMOVED_BY_PARTICIPANT:return new j(h.HANGUP_CALL);case b("FBRTCDismissReason").REJECTED_BY_CALLEE:return new j(h.IGNORE_CALL);case b("FBRTCDismissReason").INTERNAL_ERROR:return new j(h.SIGNALING_MESSAGE_FAILED);default:return new j(h.HANGUP_CALL)}};j.fromResponseStatusCode=function(a){switch(a){case b("FBRTCRtcResponseStatusCode").PRECONDITION_FAILURE:case b("FBRTCRtcResponseStatusCode").METHOD_NOT_ALLOWED:case b("FBRTCRtcResponseStatusCode").UNAUTHORIZED:return new j(h.NO_PERMISSION);case b("FBRTCRtcResponseStatusCode").SERVICE_UNAVAILABLE:return new j(h.SIGNALING_MESSAGE_FAILED);case b("FBRTCRtcResponseStatusCode").SERVER_INTERNAL_ERROR:case b("FBRTCRtcResponseStatusCode").BAD_REQUEST:case b("FBRTCRtcResponseStatusCode").BUSY_HERE:case b("FBRTCRtcResponseStatusCode").CONDITIONAL_REQUEST_FAILED:case b("FBRTCRtcResponseStatusCode").NOT_FOUND:return new j(h.CLIENT_ERROR);default:return new j(h.HANGUP_CALL)}};e.exports=j}),null);
__d("RTCMediaDevices",["invariant","Promise","RTCOnDeviceChangePoller"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=navigator.mediaDevices&&typeof navigator.mediaDevices.enumerateDevices==="function",i=window.MediaStreamTrack&&window.MediaStreamTrack.getSources==="function",j=1e3,k=void 0;a={addEventListener:function(a,c){if(a==="devicechange"&&b("RTCOnDeviceChangePoller").isNeeded()){k||(k=new(b("RTCOnDeviceChangePoller"))(j));k.add(c);return}var d=navigator;d=d.mediaDevices;d&&"addEventListener"in d&&d.addEventListener(a,c)},removeEventListener:function(a,c){if(a==="devicechange"&&b("RTCOnDeviceChangePoller").isNeeded()){k&&k.remove(c);return}var d=navigator;d=d.mediaDevices;d&&"removeEventListener"in d&&d.removeEventListener(a,c)},isSupported:function(a){switch(a){case"enumerateDevices":return h||i;default:return Boolean(navigator.mediaDevices)}},enumerateDevices:function(){if(h){navigator.mediaDevices||g(0);return b("Promise").resolve(navigator.mediaDevices.enumerateDevices())}else if(i)return new(b("Promise"))(function(a){return window.MediaStreamTrack.getSources(a)}).then(l);return b("Promise").reject(new Error("enumerateDevices() not supported"))},filterDevicesOfKind:function(a,b){return a.filter(function(a){return a.kind===b})}};function l(a){return a.map(function(a){var b=a.id,c=a.kind;a=a.label;return{deviceId:b,groupId:"",kind:c==="video"?"videoinput":"audioinput",label:a}})}e.exports=a}),null);
__d("RTCOnDeviceChangePoller",["Promise","FBRTCLogger","RTCMediaDevices"],(function(a,b,c,d,e,f){__p&&__p();a.isNeeded=function(){"use strict";var a=navigator;a=a.mediaDevices;return!b("RTCMediaDevices").isSupported("enumerateDevices")||a&&"ondevicechange"in a?!1:!0};function a(a){"use strict";__p&&__p();this.$1=[],this.$2="",this.$4=null,this.$7=function(){__p&&__p();b("RTCMediaDevices").enumerateDevices().then(function(a){__p&&__p();a=a.map(function(a){return a.deviceId+":"+a.label+":"+a.groupId}).sort().join("~");if(a===this.$2)return;this.$2=a;for(var a=this.$1,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;try{d()}catch(a){}}}.bind(this))["catch"](function(a){return b("Promise").resolve()}).then(function(){this.$4=setTimeout(this.$7,this.$3)}.bind(this))["catch"](function(a){})}.bind(this),this.$3=a}a.prototype.add=function(a){"use strict";this.$1.push(a),this.$5()};a.prototype.remove=function(a){"use strict";this.$1=this.$1.filter(function(b){return b!==a}),this.$6()};a.prototype.$5=function(){"use strict";if(this.$4!==null)return;this.$4=setTimeout(this.$7,0)};a.prototype.$6=function(){"use strict";if(this.$1.length>0)return;this.$4!==null&&(clearTimeout(this.$4),this.$4=null)};e.exports=a}),null);
__d("RTCUserMediaConstraints",["FBRTCConstants","RTCConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=b("FBRTCConstants").RTCConstraints;var g=b("FBRTCConstants").VideoQuality,h={width:a.FHD_WIDTH,height:a.FHD_HEIGHT,frameRate:a.FRAME_RATE},i={width:a.HD_WIDTH,height:a.HD_HEIGHT,frameRate:a.FRAME_RATE},j={width:a.SD_WIDTH,height:a.SD_HEIGHT,frameRate:a.FRAME_RATE},k={width:a.LQ_WIDTH,height:a.LQ_HEIGHT,frameRate:a.LQ_FRAME_RATE},l={audio:function(a){return a?{deviceId:{exact:a}}:!0},video:function(a,c){var d=arguments.length<=2||arguments[2]===undefined?b("RTCConfig").CollaborationCallQuality.videoToRoom:arguments[2];if(a===g.NO_VIDEO)return!1;var e=c?{deviceId:{exact:c}}:null;if(a===g.CUSTOM_VIDEO)return babelHelpers["extends"]({},d,e);var f=m(a);return babelHelpers["extends"]({width:n(f,"width"),height:n(f,"height"),frameRate:n(f,"frameRate",{frameRate:10})},e)},chromeMediaSource:function(a,b){a=a.video;a=l.chromify(a);if(typeof a!=="object")return{audio:!1,video:Boolean(a)};var c=a.mandatory;a=a.optional;a=a===undefined?[]:a;return{audio:!1,video:{mandatory:babelHelpers["extends"]({},c,{chromeMediaSource:"desktop",chromeMediaSourceId:b}),optional:[{googTemporalLayeredScreencast:!0}].concat(a)}}},chromify:function(a,b){__p&&__p();if(!a||typeof a!=="object")return Boolean(a);if(!r(a))return a;b=b?b.optionalConstraintsOnly:!1;var c=a.mandatory;c=c===undefined?{}:c;var d=a.optional;d=d===undefined?[]:d;for(var e=Object.entries(a),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;var i=h[0];h=h[1];if(i==="require"||i==="advanced"||i==="mediaSource")continue;h=h&&typeof h==="object"?h:{ideal:h};Number.isFinite(h.exact)&&(h.min=h.exact,h.max=h.exact);var j=h.ideal,k=h.exact;if(j!==undefined)if(Number.isFinite(j)){var l;d.push((l={},l[q(i,"min")]=j,l),(l={},l[q(i,"max")]=j,l))}else{d.push((l={},l[q(i)]=j,l))}if(!b)if(k!==undefined&&!Number.isFinite(k))c[q(i)]=k;else{j=["min","max"];for(var l=0;l<j.length;l++){k=j[l];Number.isFinite(h[k])&&(c[q(i,k)]=h[k])}}}a.advanced&&d.push.apply(d,a.advanced);k={};Object.keys(c).length>0?k.mandatory=c:b&&(k.mandatory={});d.length>0&&(k.optional=d);return k}};function m(a){switch(a){case g.FHD_VIDEO:return h;case g.HD_VIDEO:return i;case g.LQ_VIDEO:return k;case g.SD_VIDEO:return j;default:return i}}function n(a,b){var c=arguments.length<=2||arguments[2]===undefined?o(a):arguments[2],d=a[b];return{min:Math.min(c[b],d),max:Math.max(p(a)[b],d),ideal:d}}function o(a){switch(a){case h:return i;case i:return j;case j:case k:default:return k}}function p(a){switch(a){case k:return j;case j:return i;case i:case h:default:return h}}function q(b,a){return a?""+a+b.charAt(0).toUpperCase()+b.slice(1):b==="deviceId"?"sourceId":b}function r(a){return Object.keys(a).some(function(a){return a!=="mandatory"&&a!=="optional"})}e.exports=l}),null);
__d("MediaRequestSourceApp",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({LIVE_BROADCAST:"live_broadcast",RTC_CALL:"rtc_call",SCREEN_RECORDER:"screen_recorder",UNKNOWN:"unknown",WIRELESS_SCREEN_SHARING:"wireless_screen_sharing"})}),null);
__d("MediaStream",[],(function(a,b,c,d,e,f){e.exports=window.MediaStream||window.webkitMediaStream}),null);
__d("RTCAudioTrackNoiseDetector",["invariant","Promise","MediaStream"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h="audio track with absolute silence",i="audio track data timeout",j='wrong track type, expected "audio"',k=100;a={ABSOLUTE_SILENCE_ERROR:h,DATA_TIMEOUT_ERROR:i,WRONG_TRACK_TYPE_ERROR:j,detect:function(a,c){__p&&__p();if("kind"in a&&a.kind!=="audio")return b("Promise").reject(new Error(j));var d=new(b("MediaStream"))();d.addTrack(a);var e=new AudioContext(),f=e.createMediaStreamSource(d),l=e.createScriptProcessor(0,1,1),m=k,n=function(){__p&&__p();l!=null||g(0);l.onaudioprocess=null;l.disconnect();l=null;f!=null||g(0);f.disconnect();f=null;d!=null||g(0);d.removeTrack(a);d=null;e!=null||g(0);return b("Promise").resolve(e.close())["catch"](function(){return b("Promise").resolve()}).then(function(){e=null})};return b("Promise").race([new(b("Promise"))(function(a,b){__p&&__p();l!=null||g(0),l.onaudioprocess=function(c){__p&&__p();c=c.inputBuffer;for(var c=c.getChannelData(0),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;if(f!==0){a();return}}m>0?m--:b(new Error(h))},f!=null||g(0),f.connect(l),e!=null||g(0),l.connect(e.destination)}),new(b("Promise"))(function(a){return setTimeout(a,c)}).then(function(){throw new Error(i)})]).then(function(){return n()})["catch"](function(a){return n().then(function(){throw a})})}};e.exports=a}),null);
__d("RTCVideoTrackActivityDetector",["invariant","Promise","MediaStream"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=window.URL||window.webkitURL,i=HTMLMediaElement&&"srcObject"in HTMLMediaElement.prototype,j="video track playback timeout",k="unexpected video track ready state",l='wrong track type, expected "video"';a={PLAYBACK_TIMEOUT_ERROR:j,WRONG_READY_STATE_ERROR:k,WRONG_TRACK_TYPE_ERROR:l,detect:function(a,c){__p&&__p();if("kind"in a&&a.kind!=="video")return b("Promise").reject(new Error(l));var d=document.createElement("video");d.muted=!0;var e=new(b("MediaStream"))();e.addTrack(a);var f=void 0,m=null,n=function(){clearInterval(m),d&&(d.pause(),i?d.srcObject=null:d.src&&(h.revokeObjectURL(d.src),d.src=""),d.removeEventListener("timeupdate",f),d=null),e&&(e.removeTrack(a),e=null)};return b("Promise").race([new(b("Promise"))(function(c,j){d!=null||g(0),i?d.srcObject=e:d.src=h.createObjectURL(e),f=function(b){d!=null||g(0),d.currentTime>0&&(a.readyState==="live"?(c(),n()):j(new Error(k)))},b("Promise").resolve(d.pause()).then(function(){d!=null||g(0);return d.play()}).then(function(){f(),d!=null||g(0),d.addEventListener("timeupdate",f),m=setInterval(f,50)})["catch"](function(a){return j(a)})}),new(b("Promise"))(function(a){return setTimeout(a,c)}).then(function(){throw new Error(j)})])["catch"](function(a){n();throw a})}};e.exports=a}),null);
__d("RTCMediaStreamValidator",["Promise","RTCAudioTrackNoiseDetector","RTCVideoTrackActivityDetector"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="no audio tracks",h="no video tracks",i="too many audio tracks",j="too many video tracks",k="unexpected audio track(s)",l="unexpected video track(s)";a={NO_AUDIO_TRACKS_ERROR:g,NO_VIDEO_TRACKS_ERROR:h,TOO_MANY_AUDIO_TRACKS_ERROR:i,TOO_MANY_VIDEO_TRACKS_ERROR:j,UNEXPECTED_AUDIO_TRACKS_ERROR:k,UNEXPECTED_VIDEO_TRACKS_ERROR:l,validate:function(a,c){var d=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],e=arguments.length<=3||arguments[3]===undefined?{}:arguments[3],f=d.audio,g=f===undefined?!0:f,h=d.video,i=h===undefined?!0:h,j=e.audio,k=j===undefined?1e3:j,l=e.video,o=l===undefined?1e3:l;return b("Promise").all([m(a,c,g,k),n(a,c,i,o)]).then(function(){return a})}};function m(a,c,d,e){var f=a.getAudioTracks();if(!c.audio)return f.length>0?b("Promise").reject(new Error(k)):b("Promise").resolve(a);if(f.length<1)return b("Promise").reject(new Error(g));else if(f.length>1)return b("Promise").reject(new Error(i));return d?b("RTCAudioTrackNoiseDetector").detect(f[0],e).then(function(){return a}):b("Promise").resolve(a)}function n(a,c,d,e){var f=a.getVideoTracks();if(!c.video)return f.length>0?b("Promise").reject(new Error(l)):b("Promise").resolve(a);if(f.length<1)return b("Promise").reject(new Error(h));else if(f.length>1)return b("Promise").reject(new Error(j));return d?b("RTCVideoTrackActivityDetector").detect(f[0],e).then(function(){return a}):b("Promise").resolve(a)}e.exports=a}),null);
__d("UserMediaRequestError",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=babelHelpers.inherits(h,Error);g=a&&a.prototype;function h(a,b,c){g.constructor.call(this,b),this.constraint=c,this.nativeErrorName=a,this.message=i(b),this.name=j(a)}h.createFromNative=function(a){var b=a.message,c=a.name;a=a.constraint;return new h(c,b,a||"")};h.prototype.isRecoverableError=function(){return this.name==="InvalidStateError"?!0:!1};h.prototype.getEndCallSubReason=function(){return"MediaFailed: "+this.name+", "+this.constraint};function i(a){switch(a){case"The operation is insecure.":return"The request is not allowed by the user agent or the platform in the current context.";default:return a}}function j(a){switch(a){case"ConstraintNotSatisfiedError":return"OverconstrainedError";case"NO_DEVICES_FOUND":case"DevicesNotFoundError":return"NotFoundError";case"MediaDeviceFailedDueToShutdown":case"MediaDeviceKillSwitchOn":case"TrackStartError":return"NotReadableError";case"PermissionDeniedError":case"PERMISSION_DENIED":case"PermissionDismissedError":return"NotAllowedError";default:return a}}e.exports=h}),null);
__d("RTCUtils",["invariant","Promise","CurrentUser","FBLogger","FBRTCLogger","FBRTCSupport","FBRTCUtils","MediaRequestSourceApp","RTCAudioTrackNoiseDetector","RTCEndCallReason","RTCMediaDevices","RTCMediaStreamValidator","RTCScreenSharing","RTCUser","RTCUserMediaConstraints","RTCVideoFilterRenderer","RTCVideoTrackActivityDetector","URI","UserAgent","UserMediaRequestError","randomInt"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("RTCAudioTrackNoiseDetector").DATA_TIMEOUT_ERROR,i=b("RTCVideoTrackActivityDetector").PLAYBACK_TIMEOUT_ERROR,j={generateRandomInt:function(){return b("randomInt")(0,4294967294)+1},isGroupCall:function(a){return a.split(":")[0]==="GROUP"},isMessengerCall:function(a){return a.split(":")[0]==="MESSENGER"},isBonfireCall:function(a){return!!this.parseBonfireID(a)},isAlohaCall:function(a){return a.split(":")[0]==="ALOHA"},isSupportedMWCall:function(a){return j.isGroupCall(a)||j.isMessengerCall(a)||j.isAlohaCall(a)||j.isBonfireCall(a)},parseBonfireID:function(a){a=a.match(/BONFIRE:(\d+)/);return a&&a.length>1?a[1]:null},getPeerID:function(a){if(j.isGroupCall(a))throw new Error("Not a P2P call: "+a);a=a.split(":");a=a.slice(1);return a[0]===b("CurrentUser").getID()?a[1]:a[0]},getMessengerCallID:function(a){if(!j.isMessengerCall(a))throw new Error("Not a Messenger call: "+a);return Number(a.split(":")[1])},createRequestHeader:function(a,b,c,d,e){a={type:a,transactionId:j.generateRandomInt().toString(),retryCount:0,conferenceName:b,clientSessionId:d?d:""};c&&(a.serverInfoData=c);e&&(a.extensions={esc_p2p_call_id:e});return a},createClientContextMessage:function(a,b){a={num_participants:a,trigger:b};b={header:{topic_DEPRECATED:"client_context",shouldSendToAllUsers:!1},body:{genericMessage:{topic:"client_context",data:JSON.stringify(a)}}};return b},createResponseHeader:function(a,b,c){b={type:a.type,transactionId:a.transactionId,retryCount:0,conferenceName:a.conferenceName,responseStatusCode:b,clientSessionId:c?c:""};a.serverInfoData&&(b.serverInfoData=a.serverInfoData);return b},maybeRemoveVideoConstraint:function(a){return b("RTCMediaDevices").enumerateDevices().then(function(b){return b.some(function(a){return a.kind==="videoinput"})?a:babelHelpers["extends"]({},a,{video:!1})})["catch"](function(){return b("Promise").resolve(a)})},getUserMediaWithAudioFallback:function(a,b){return a.video?j.maybeRemoveVideoConstraint(a).then(function(a){return j.getUserMedia(a,b)})["catch"](function(b){if(a.video&&(b.name==="NotFoundError"||b.name==="StreamFailedToStart"||b.name==="OverconstrainedError"))return j.getUserMedia({video:!1,audio:a.audio});throw b}):j.getUserMedia(a,b)},getUserScreenMedia:function(a,c,d){return b("RTCScreenSharing").getUserMedia(a,c,d)},getUserMedia:function(a,c){__p&&__p();var d=navigator,e=d.mediaDevices;if(typeof a.video==="object"&&a.video.mediaSource){b("FBLogger")("rtc_www").mustfix("Please use %s instead of %s for screen","RTCUtils.getUserScreenMedia()","RTCUtils.getUserMedia()");return b("RTCScreenSharing").getUserMedia(a,b("MediaRequestSourceApp").UNKNOWN)}d=c&&c.optionalConstraintsOnly&&a.video;var f=j._parseConstraints(a,{optionalConstraintsOnly:!!d}),g=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return new(b("Promise"))(function(a,b){e&&typeof e.getUserMedia==="function"?a(e.getUserMedia(f).then(function(a){return j._maybeSupportFilteredStreams(a,!!(c&&c.supportFilteredStreams))})):g?g.call(navigator,f,a,b):b("getUserMedia not supported")})["catch"](function(a){throw b("UserMediaRequestError").createFromNative(a)})},_parseConstraints:function(a,c){if(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera")){var d=a.audio,e=a.video,f={};d!=undefined&&(f.audio=b("RTCUserMediaConstraints").chromify(d));e!=undefined&&(f.video=b("RTCUserMediaConstraints").chromify(e,c));return f}return a},_maybeSupportFilteredStreams:function(a,c){return c&&a.getVideoTracks().length>0&&b("FBRTCSupport").isVideoFilterEffectSupported()?b("RTCVideoFilterRenderer").initStreamForFilters(a):a},getUserMediaWithValidation:function(a){__p&&__p();var c=arguments.length<=1||arguments[1]===undefined?{audio:!0,video:!0}:arguments[1],d=arguments.length<=2||arguments[2]===undefined?5:arguments[2],e=arguments.length<=3||arguments[3]===undefined?{audio:1e3,video:1e3}:arguments[3];return new(b("Promise"))(function(f,g){__p&&__p();var k=function d(k){j.getUserMedia(a).then(function(d){return b("RTCMediaStreamValidator").validate(d,a,c,e).then(function(a){return f({stream:a})})["catch"](function(a){if(a.message===h||a.message===i)f({stream:d,err:a});else{j.stopMediaStream(d);throw a}})},g)["catch"](function(a){k>0?d(k-1):g(a)})};k(d)})},isFullScreen:function(){return Boolean(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement)},requestFullScreen:function(){var a=arguments.length<=0||arguments[0]===undefined?document.documentElement:arguments[0];typeof a.requestFullscreen==="function"?a.requestFullscreen():typeof a.msRequestFullscreen==="function"?a.msRequestFullscreen():typeof a.mozRequestFullScreen==="function"?a.mozRequestFullScreen():typeof a.webkitRequestFullscreen==="function"&&a.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT)},exitFullScreen:function(){typeof document.exitFullscreen==="function"?document.exitFullscreen():typeof document.msExitFullscreen==="function"?document.msExitFullscreen():typeof document.mozCancelFullScreen==="function"?document.mozCancelFullScreen():typeof document.webkitExitFullscreen==="function"&&document.webkitExitFullscreen()},toggleFullScreen:function(){j.isFullScreen()?j.exitFullScreen():j.requestFullScreen()},endCallReasonFromHangupReason:function(a){return b("RTCEndCallReason").fromHangupReason(a).getReasonID()},endCallReasonFromDismissRequest:function(a){return b("RTCEndCallReason").fromDismissRequest(a).getReasonID()},endCallReasonFromResponseStatusCode:function(a){return b("RTCEndCallReason").fromResponseStatusCode(a).getReasonID()},stopMediaStream:function(a){__p&&__p();if(!a.active&&"active"in a)return;for(var a=a.getTracks(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.readyState!=="ended"&&d.stop()}},transferAudioTracks:function(a,b){__p&&__p();for(var c=b.getAudioTracks(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;a.addTrack(f);b.removeTrack(f)}},payloadParticipantsToRTCUsers:function(a){return a.map(function(a){var c=a.big_image_src||a.image_src;a.fbid||g(0);return new(b("RTCUser"))({FBID:a.fbid,profileUrl:new(b("URI"))(a.href),profilePictureUrl:c,isMessengerUser:!!a.is_messenger_user,isPartiesUser:!!a.is_parties_user,userName:a.name,userShortName:a.short_name,vanity:a.vanity||""})})},getStreamVideoResolution:function(a){return new(b("Promise"))(function(c,d){var e=document.createElement("video");b("FBRTCUtils").attachMediaStream(e,a);var f=function(){e.removeEventListener("loadedmetadata",g),e.removeEventListener("error",h),b("FBRTCUtils").attachMediaStream(e,null)},g=function(){c({height:e.videoHeight,width:e.videoWidth}),f()},h=function(){d(e.error),f()};e.addEventListener("loadedmetadata",g);e.addEventListener("error",h)})},limitFrameRate:function(a){a=a.getVideoTracks();a=a[0];if(a.applyConstraints){var b=a.getConstraints();b.frameRate=15;a.applyConstraints(b)}},isScreenSharingSupported:function(){return b("UserAgent").isBrowser("Chrome")},filterDevicesByKind:function(a,b){return a?a.filter(function(a){return a.kind===b}):[]}};e.exports=j}),null);
__d("RTCConferenceState",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({AWAITING_USER_START:"AWAITING_USER_START",CONNECTED:"CONNECTED",CONNECTING:"CONNECTING",NEW:"NEW",RENEGOTIATING:"RENEGOTIATING",TERMINATED:"TERMINATED",TERMINATING:"TERMINATING"})}),null);
__d("FBRTCCallSummaryReducer",["FBRTCCallSummaryStore","FBRTCLogger","FBRTCMediaMetricParser","FBRTCParticipantCallState","RTCCallActionTypes","RTCCallStore","RTCConferenceState","RTCUtils","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCLogger").Key;a={setCallSummary:function(a,c){switch(c.type){case b("RTCCallActionTypes").SET_CALL_SUMMARY:return a.set("callSummary",c.callSummary)}return a},onCallStarted:function(a,c){switch(c.type){case b("RTCCallActionTypes").INCOMING_CALL_SUCCESS:case b("RTCCallActionTypes").CALL_SUCCESS:c=function c(){var d=b("RTCCallStore").getState().callInfo.conferenceState;d!==b("RTCConferenceState").TERMINATED&&(a.callSummary.save(b("FBRTCCallSummaryStore").getInstance()),setTimeout(c,1e4))};c();b("FBRTCMediaMetricParser").startCollectingMediaStats();return a}return a},onMessageSignaling:function(a,c){__p&&__p();var d=b("gkx")("AT5-ilhz2Zk92PzchYxBHGqoisb5ux7QmaEBEJm2aKeVNmdUsAWWKWhG8p6BLcmhJ0gE1S7cCgFDgPSw8BNz-AY8ykEB300_SDpJTp693IJpgg");switch(c.type){case b("RTCCallActionTypes").ON_JOIN_REQUEST_SENT:d?a.callSummary.setJoinRequestSent():a.callSummary.isCaller()?a.callSummary.setOfferSentTime():a.callSummary.setAnswerSentTime();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").ON_RECEIVED_JOIN_RESPONSE:d&&a.callSummary.setJoinResponseReceived();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").ON_JOIN_RESPONSE:!d&&!a.callSummary.isCaller()&&(a.callSummary.onCallConnected(),a.callSummary.onNetworkReady(),a.callSummary.save(b("FBRTCCallSummaryStore").getInstance()));a.callSummary.setServerInfoData(c.serverInfoData);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").ON_PROCESSED_JOIN_RESPONSE:d&&a.callSummary.setJoinResponseProcessed();a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS:a.callSummary.isCaller()&&!d&&(a.callSummary.setAnswerReceivedTime(),a.callSummary.isNetworkReady()&&a.callSummary.onCallConnected(),a.callSummary.save(b("FBRTCCallSummaryStore").getInstance()));return a;case b("RTCCallActionTypes").ON_CONFERENCE_STATE:var e=b("RTCCallStore").getState().callInfo.conferenceName;b("RTCUtils").isGroupCall(e)&&!d&&(a.callSummary.onNetworkReady(),a.callSummary.save(b("FBRTCCallSummaryStore").getInstance()));e=c.request.conferenceStateRequest();var f=e.participantStates;Object.keys(f).forEach(function(c){if(c!==b("RTCCallStore").getState().localUser.FBID)switch(f[c].state){case b("FBRTCParticipantCallState").UNKNOWN:case b("FBRTCParticipantCallState").CONTACTING:case b("FBRTCParticipantCallState").UNREACHABLE:return;case b("FBRTCParticipantCallState").CONNECTED:d||(a.callSummary.onNetworkReady(),a.callSummary.isAnswerReceived()&&a.callSummary.onCallConnected());default:a.callSummary.isCaller()&&!d&&a.callSummary.setOfferAckReceivedTime(),a.callSummary.save(b("FBRTCCallSummaryStore").getInstance())}});return a}return a},onCallEnded:function(a,c){switch(c.type){case b("RTCCallActionTypes").CALL_ERROR:case b("RTCCallActionTypes").HANGUP:case b("RTCCallActionTypes").END_CALL:a.callSummary.onCallEnded(c.endCallReason,!1,!1,c.endCallSubreason);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").DISMISS:a.callSummary.onCallEnded(c.endCallReason,!0,!1,c.endCallSubreason);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a}return a},onSurveyResult:function(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").RATING_SHOWN:a.callSummary.addExtraInfo(g.RATING_SHOWN,"1");a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").FEEDBACK_SHOWN:a.callSummary.addExtraInfo(g.SURVEY_SHOWN,"1");a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").SUBMIT_RATING:a.callSummary.addExtraInfo(g.RATING,c.rating);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a;case b("RTCCallActionTypes").SUBMIT_FEEDBACK:a.callSummary.addExtraInfo(g.SURVEY_DETAILS,c.feedback);a.callSummary.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}};e.exports=a}),null);
__d("RTCGroupCallEscalationActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({GROUP_ESCALATION_START:"GROUP_ESCALATION_START",GROUP_ESCALATION_SUCCESS:"GROUP_ESCALATION_SUCCESS",GROUP_ESCALATION_CANCEL:"GROUP_ESCALATION_CANCEL",GROUP_ESCALATION_SET_USERS_TO_RING:"GROUP_ESCALATION_SET_USERS_TO_RING",GROUP_ESCALATION_CLEAR_P2P_CONNECTION:"GROUP_ESCALATION_CLEAR_P2P_CONNECTION",GROUP_ESCALATION_SET_P2P_CALLSUMMARY:"GROUP_ESCALATION_SET_P2P_CALLSUMMARY",GROUP_ESCALATION_ADD_LOCAL_STREAM:"GROUP_ESCALATION_ADD_LOCAL_STREAM"})}),null);
__d("RTCVideoFilterActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({SET_FILTER:"SET_FILTER"})}),null);
__d("RTCCallReducer",["invariant","FBRTCCallSummaryStore","FBRTCConstants","FBRTCParticipantCallState","FBRTCRtcResponseStatusCode","FBRTCScreenSharingUtils","FunnelLogger","immutable","RTCCallActionTypes","RTCCallStore","RTCConferenceState","RTCGroupCallEscalationActionTypes","RTCUser","RTCUtils","RTCVideoFilterActionTypes","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").SignalingProtocol;function a(a,c){switch(c.type){case b("RTCCallActionTypes").INIT:return a.set("callInfo",a.callInfo.set("callID",c.callID).set("conferenceName",c.conferenceName).set("serverInfoData",c.serverInfoData).set("protocol",c.protocol));case b("RTCCallActionTypes").RESET:return a.set("callInfo",a.callInfo.set("conferenceState",b("RTCConferenceState").NEW).set("conferenceName",c.conferenceName)).set("callSummary",null).set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}))}return a}function c(a,c){switch(c.type){case b("RTCCallActionTypes").CALL:return a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").CONNECTING).set("connections",a.connections.add(c.peerConnection));case b("RTCCallActionTypes").CALL_ERROR:return a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").TERMINATED);case b("RTCCallActionTypes").CALL_SUCCESS:return c.connected?a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").CONNECTED):a}return a}function d(a,c){switch(c.type){case b("RTCCallActionTypes").INCOMING_CALL_SUCCESS:return a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").CONNECTED)}return a}function f(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").HANGUP:a.connections.forEach(function(a){return a.close()});return a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").TERMINATING).set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}));case b("RTCCallActionTypes").DISMISS:c.transaction.sendResponse(c.request.createResponse(b("FBRTCRtcResponseStatusCode").OK,{callID:a.callInfo.callID}));case b("RTCCallActionTypes").END_CALL:a.connections.forEach(function(a){return a.close()});return a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").TERMINATED).set("connections",b("immutable").Set()).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeAllStreams()}));case b("RTCCallActionTypes").HANGUP_ERROR:case b("RTCCallActionTypes").HANGUP_SUCCESS:return a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").TERMINATED)}return a}function i(a,c){__p&&__p();switch(c.type){case b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_CLEAR_P2P_CONNECTION:var d=b("RTCCallStore").getConnection(h.P2P);if(d){c=function(){__p&&__p();var c=d.getRemoteStreams(),e=c[0];d.close();b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","shutdown_p2p_connection");var f=a.localUser;if(!b("FBRTCScreenSharingUtils").isGroupCallScreenSharingSupported()){c=f.getScreenStream();if(c){var g=f.getStream();g&&b("RTCUtils").transferAudioTracks(g,c);b("RTCUtils").stopMediaStream(c);f=f.removeScreenStream(c)}}return{v:a.withMutations(function(a){a.set("connections",a.connections.remove(d)).set("localUser",f).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeStream(e)}))})}}();if(typeof c==="object")return c.v}}return a}function j(a,c){__p&&__p();var d;switch(c.type){case b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_CANCEL:var e=b("RTCCallStore").getConnection(h.MULTIWAY);if(e){var d=function(){var d=e.getRemoteStreams(),f=d[0],g=a.callSummary;c.p2pCallSummary&&(g=c.p2pCallSummary,b("FBRTCCallSummaryStore").getInstance().removeCallSummary(a.callSummary.peerID,a.callSummary.callID));e.close();b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","shutdown_mw_connection");return{v:a.withMutations(function(a){a.set("callInfo",a.callInfo.set("conferenceState",b("RTCConferenceState").CONNECTED).set("conferenceName",g.callID).set("protocol","p2p").set("serverInfoData","")).set("callSummary",g).set("connections",a.connections.remove(e)).set("remoteUsers",a.remoteUsers.map(function(a){return a.removeStream(f)}))})}}();if(typeof d==="object")return d.v}}return a}function k(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").ON_PARTICIPANTS_ADDED:var d=a.remoteUsers.map(function(a){return a.FBID});return a.set("remoteUsers",a.remoteUsers.union(Object.keys(c.participants).filter(function(a){return!d.has(c.participants[a].fbid)}).map(function(a){var d=c.participants[a],e=d.big_image_src||d.image_src;c.images&&c.images[a]&&(e=c.images[a]);d.fbid||g(0);return new(b("RTCUser"))({FBID:d.fbid,profileUrl:new(b("URI"))(d.href),profilePictureUrl:e,isMessengerUser:!!d.is_messenger_user,isPartiesUser:!!d.is_parties_user,userName:d.name,userShortName:d.short_name,vanity:d.vanity})})))}return a}function l(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").ON_CONFERENCE_STATE:var d=c.transaction,e=c.request,f=c.request.conferenceStateRequest();if(c.conferenceStateVersion>=f.version){d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{ConferenceStateResponse:{currentVerison:c.conferenceStateVersion}},callID:a.callInfo.callID}));return a}c.resolve(f.version);var g=a.remoteUsers.map(function(a){var b=f.participantStates[a.FBID];return b?a.setParticipantState(b):a}),h=g.some(function(a){a=a.participantState;return a&&a.state===b("FBRTCParticipantCallState").CONNECTED});h=h?b("RTCConferenceState").CONNECTED:a.callInfo.conferenceState;d.sendResponse(e.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{ConferenceStateResponse:{currentVerison:c.conferenceStateVersion}},callID:a.callInfo.callID}));return a.setIn(["remoteUsers"],g).setIn(["callInfo","conferenceState"],h)}return a}function m(a,c){switch(c.type){case b("RTCCallActionTypes").ON_JOIN_RESPONSE:return a.setIn(["callInfo","serverInfoData"],c.serverInfoData)}return a}function n(a,c){switch(c.type){case b("RTCCallActionTypes").INIT_LOCAL_USER:return a.set("localUser",c.localUser);case b("RTCCallActionTypes").INIT_REMOTE_USERS:return a.set("remoteUsers",c.remoteUsers)}return a}function o(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").ADD_LOCAL_STREAM:return a.set("localUser",a.localUser.addStream(c.stream));case b("RTCCallActionTypes").SET_PREFERRED_LOCAL_STREAM:return a.set("localUser",a.localUser.setPreferredStream(c.stream));case b("RTCCallActionTypes").REMOVE_LOCAL_STREAM:return a.set("localUser",a.localUser.removeStream(c.stream));case b("RTCCallActionTypes").REPLACE_LOCAL_STREAM:var d=c.oldStream.getAudioTracks();d=d[0];if(d!=null)for(var e=c.newStream.getAudioTracks(),f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h.enabled=d.enabled}return a.set("localUser",a.localUser.replaceStream(c.oldStream,c.newStream));case b("RTCCallActionTypes").REMOVE_ALL_LOCAL_STREAMS:if(c.stopStreams)for(var h=a.localUser.streams,g=Array.isArray(h),f=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(f>=h.length)break;e=h[f++]}else{f=h.next();if(f.done)break;e=f.value}d=e;b("RTCUtils").stopMediaStream(d)}return a.set("localUser",a.localUser.removeAllStreams())}return a}function p(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").ADD_LOCAL_SCREEN_STREAM:return a.set("localUser",a.localUser.addScreenStream(c.stream));case b("RTCCallActionTypes").REMOVE_LOCAL_SCREEN_STREAM:return a.set("localUser",a.localUser.removeScreenStream(c.stream));case b("RTCCallActionTypes").REMOVE_ALL_LOCAL_SCREEN_STREAMS:if(c.stopStreams)for(var d=a.localUser.screenStreams,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b("RTCUtils").stopMediaStream(g)}return a.set("localUser",a.localUser.removeAllScreenStreams());case b("RTCCallActionTypes").REPLACE_LOCAL_SCREEN_STREAM:return a.set("localUser",a.localUser.replaceScreenStream(c.oldStream,c.newStream))}return a}function q(a,c){__p&&__p();var d=void 0;switch(c.type){case b("RTCCallActionTypes").ADD_REMOTE_STREAM:d=u(a,c);if(!d)return a;var e=a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.addStream(c.stream)));return t(e,{type:b("RTCCallActionTypes").TOGGLE_REMOTE_STREAM,mediaStatus:e.mediaStatus.toJS()});case b("RTCCallActionTypes").SET_PREFERRED_REMOTE_STREAM:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.setPreferredStream(c.stream)));case b("RTCCallActionTypes").REMOVE_REMOTE_STREAM:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeStream(c.stream)));case b("RTCCallActionTypes").REMOVE_ALL_REMOTE_STREAMS:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeAllStreams().removeAllScreenStreams()))}return a}function r(a,c){var d=void 0;switch(c.type){case b("RTCCallActionTypes").ADD_REMOTE_TRACK:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.clone()));case b("RTCCallActionTypes").REMOVE_REMOTE_TRACK:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.clone()))}return a}function s(a,c){var d=void 0;switch(c.type){case b("RTCCallActionTypes").ADD_REMOTE_SCREEN_STREAM:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.addScreenStream(c.stream)));case b("RTCCallActionTypes").REMOVE_REMOTE_SCREEN_STREAM:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.removeScreenStream(c.stream)))}return a}function t(a,c){__p&&__p();var d=void 0;switch(c.type){case b("RTCCallActionTypes").TOGGLE_REMOTE_STREAM:return a.set("remoteUsers",Object.entries(c.mediaStatus).reduce(function(b,c){__p&&__p();var d=c[0];c=c[1];var e=b.reduce(function(b,a){var c=a.streams.map(function(a){return a.getTracks().find(function(a){return a.id===d})}).find(Boolean);return c?{user:a,track:c}:b},{}),a=e.user;e=e.track;if(a&&e){if(e.kind==="audio"&&a.isAudioMuted()===c)return b["delete"](a).add(a.toggleMuteAudio());if(e.kind==="video"&&a.isVideoMuted()===c)return b["delete"](a).add(a.toggleMuteVideo())}return b},a.remoteUsers)).set("mediaStatus",b("immutable").Map(c.mediaStatus));case b("RTCCallActionTypes").REMOTE_VIDEO_MUTED:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.toggleMuteVideo(!0)));case b("RTCCallActionTypes").REMOTE_VIDEO_UNMUTED:d=u(a,c);return!d?a:a.setIn(["remoteUsers"],a.remoteUsers["delete"](d).add(d.toggleMuteVideo(!1)))}return a}function u(a,b){return a.remoteUsers.find(function(a){return b.userID?a.FBID==b.userID:a.FBID===b.stream.id.split(":")[0]})}function v(a,c){switch(c.type){case b("RTCCallActionTypes").WAIT_FOR_USER_INPUT:return a.callInfo.conferenceState===b("RTCConferenceState").NEW?a.setIn(["callInfo","conferenceState"],b("RTCConferenceState").AWAITING_USER_START):a}return a}function w(a,c){switch(c.type){case b("RTCVideoFilterActionTypes").SET_FILTER:return a.set("localUser",a.localUser.setVideoFilter(c.filter))}return a}e.exports={abortMultiwayEscalationProcess:j,callInit:a,callStart:c,callEnd:f,completeTransitionToMultiway:i,onParticipantsChanged:k,incomingCallStart:d,initUsers:n,processLocalStream:o,processLocalScreenStream:p,processRemoteStream:q,processRemoteScreenStream:s,processRemoteTrack:r,toggleRemoteStream:t,processConferenceState:l,processJoinResponse:m,setVideoFilter:w,waitForUserInput:v}}),null);
__d("RTCCallControlReducer",["RTCCallActionTypes"],(function(a,b,c,d,e,f){"use strict";function a(a,c){switch(c.type){case b("RTCCallActionTypes").AUDIO_MUTED:case b("RTCCallActionTypes").AUDIO_UNMUTED:return a.set("localUser",a.localUser.toggleMuteAudio());case b("RTCCallActionTypes").VIDEO_MUTED:case b("RTCCallActionTypes").VIDEO_UNMUTED:return a.set("localUser",a.localUser.toggleMuteVideo())}return a}e.exports={toggleLocalStream:a}}),null);
__d("RTCCallStoreState",["CurrentUser","immutable","RTCConferenceState","RTCUser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;d={debugID:0,callID:"",conferenceState:b("RTCConferenceState").NEW,conferenceName:"",protocol:"",serverInfoData:""};g=babelHelpers.inherits(a,b("immutable").Record(d));g&&g.prototype;function a(){g.apply(this,arguments)}f={connections:b("immutable").Set(),localUser:new(b("RTCUser"))({FBID:b("CurrentUser").getID()}),remoteUsers:b("immutable").Set(),callInfo:new a(),callSummary:null,mediaStatus:b("immutable").Map()};h=babelHelpers.inherits(c,b("immutable").Record(f));h&&h.prototype;function c(){h.apply(this,arguments)}e.exports=c}),null);
__d("RTCCallStore",["FBRTCCallSummaryReducer","FluxReduceStore","MessengerRTCFunnelLogger","RTCAppDispatcher","RTCCallControlReducer","RTCCallReducer","RTCCallStoreState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("FBRTCCallSummaryReducer").onCallEnded,b("FBRTCCallSummaryReducer").onCallStarted,b("FBRTCCallSummaryReducer").onMessageSignaling,b("FBRTCCallSummaryReducer").onSurveyResult,b("FBRTCCallSummaryReducer").setCallSummary,b("RTCCallControlReducer").toggleLocalStream,b("RTCCallReducer").abortMultiwayEscalationProcess,b("RTCCallReducer").callEnd,b("RTCCallReducer").callInit,b("RTCCallReducer").callStart,b("RTCCallReducer").completeTransitionToMultiway,b("RTCCallReducer").incomingCallStart,b("RTCCallReducer").initUsers,b("RTCCallReducer").onParticipantsChanged,b("RTCCallReducer").processConferenceState,b("RTCCallReducer").processJoinResponse,b("RTCCallReducer").processLocalScreenStream,b("RTCCallReducer").processLocalStream,b("RTCCallReducer").processRemoteScreenStream,b("RTCCallReducer").processRemoteStream,b("RTCCallReducer").processRemoteTrack,b("RTCCallReducer").toggleRemoteStream,b("RTCCallReducer").setVideoFilter,b("RTCCallReducer").waitForUserInput,b("MessengerRTCFunnelLogger").logRTCCallAction];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("RTCCallStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.prototype.hasRemoteVideo=function(){return this.getState().remoteUsers.some(function(a){return a.hasStream()&&!a.areAllTracksMuted(a.streams.first().getVideoTracks())})};a.prototype.hasLocalVideo=function(){var a=this.getState();a=a.localUser;return a.hasStream()&&!a.areAllTracksMuted(a.streams.first().getVideoTracks())};a.prototype.getConnection=function(a){var b=this.getState();b=b.connections;a&&(b=b.filter(function(b){return b.getSignalingProtocol()===a}));return b.first()};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("RTCVideoFilterActions",["RTCAppDispatcher","RTCVideoFilterActionTypes"],(function(a,b,c,d,e,f){"use strict";a={setVideoFilter:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCVideoFilterActionTypes").SET_FILTER,filter:a})},removeVideoFilter:function(){b("RTCAppDispatcher").dispatch({type:b("RTCVideoFilterActionTypes").SET_FILTER,filter:null})}};e.exports=a}),null);
__d("RTCVideoFilterRenderer",["invariant","RTCCallStore","RTCVideoFilterActions","RTCVideoFilterConfig"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("RTCVideoFilterConfig").config;i.initStreamForFilters=function(a){a=i.initFilters(a);return a};i.applyStreamEffect=function(a){i.createEffectElement(a),b("RTCVideoFilterActions").setVideoFilter(a),i.applyFilters()};i.removeStreamEffect=function(){b("RTCVideoFilterActions").removeVideoFilter(),i.applyFilters()};i.initCanvas=function(a){__p&&__p();var b=document.createElement("canvas"),c=document.createElement("video");c.className="filteredVideo";c.src=window.URL.createObjectURL(a);c.srcObject=a;b.width=a.getVideoTracks()[0].getSettings().width;b.height=a.getVideoTracks()[0].getSettings().height;a=document;a=a.body;a!=null||g(0);a.append(b);a.append(c);return{cvs:b,vid:c}};i.initFilters=function(a){var b=null;!document.querySelector("canvas")||!document.querySelector("video.filteredVideo")?b=i.initCanvas(a).cvs:b=document.querySelector("canvas");if(b===null)return a;i.applyFilters();a=new MediaStream([a.getAudioTracks()[0],b.captureStream(30).getVideoTracks()[0]]);return a};i.createEffectElement=function(a){__p&&__p();if(document.querySelector("video."+a))return null;var b=document.createElement("video");b.className=a;b.crossOrigin="anonymous";b.src=h[a].video_url;b.play();b.autoplay=!0;b.loop=!0;a=document;a=a.body;a!=null||g(0);a.append(b);return b};function i(){}i.applyFilters=function(){__p&&__p();var a=b("RTCCallStore").getState().localUser.videoFilter,c=document.querySelector("canvas"),d=document.querySelector("video.filteredVideo");if(c==null||d==null)return;c=c.getContext("2d");var e=d.videoWidth,f=d.videoHeight;c.drawImage(d,0,0,e,f);if(a){d=document.querySelector("video."+(a?a:""));c.drawImage(d,0,0,e,f)}window.requestAnimationFrame(i.applyFilters)};e.exports=i}),null);
__d("RTCScreenSharing",["Promise","CollabRTCChromeScreenSharing","RTCUserMediaConstraints","RTCUtils","UserAgent","WorkplaceChatHelper"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g="SCREEN_SHARING_NOT_SUPPORTED",h="UNEXPECTED_ERROR",i={SCREEN_SHARING_NOT_SUPPORTED:g,getUserMedia:function(a,c,d){__p&&__p();return b("UserAgent").isBrowser("Chrome")?(b("WorkplaceChatHelper").isDesktopChatApp()?b("WorkplaceChatHelper").getScreenSharingSourceID():b("CollabRTCChromeScreenSharing").getSourceID(d,c)).then(function(c){return b("RTCUtils").getUserMedia(b("RTCUserMediaConstraints").chromeMediaSource(a,c))}).then(function(a){__p&&__p();for(var b=a.getTracks(),c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.addEventListener("ended",function(b){return setTimeout(function(){a.active||i.stop()})})}return a}):b("Promise").reject(new Error(g))},stop:function(){return b("UserAgent").isBrowser("Chrome")?b("WorkplaceChatHelper").isDesktopChatApp()?b("WorkplaceChatHelper").stopScreenSharing():b("CollabRTCChromeScreenSharing").stop():b("Promise").reject(new Error(h))}};e.exports=i}),null);
__d("FBRTCChromeMediaStatsReport",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();if(a)for(var a=a.values(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.type==="ssrc"&&d.audioOutputLevel?this.$1=d:d.type==="ssrc"&&d.mediaType==="video"&&(d.bytesReceived?this.$2=d:this.$3=d)}}a.prototype.getVideoBytesReceived=function(){return this.$2&&this.$2.bytesReceived?Number(this.$2.bytesReceived):null};a.prototype.getFramesDecoded=function(){return this.$2&&this.$2.framesDecoded?Number(this.$2.framesDecoded):null};a.prototype.getInboundQpSum=function(){return this.$2&&this.$2.qpSum?Number(this.$2.qpSum):null};a.prototype.getFramesEncoded=function(){return this.$3&&this.$3.framesEncoded?Number(this.$3.framesEncoded):null};a.prototype.getOutboundQpSum=function(){return this.$3&&this.$3.qpSum?Number(this.$3.qpSum):null};a.prototype.getAudioJitter=function(){return this.$1&&this.$1.googJitterReceived?Number(this.$1.googJitterReceived):null};a.prototype.getJitterBufferDelay=function(){return this.$1&&this.$1.googCurrentDelayMs?Number(this.$1.googCurrentDelayMs):null};a.prototype.getAccelerateRate=function(){return this.$1&&this.$1.googAccelerateRate?Number(this.$1.googAccelerateRate):null};a.prototype.getPreemptiveExpandRate=function(){return this.$1&&this.$1.googPreemptiveExpandRate?Number(this.$1.googPreemptiveExpandRate):null};a.prototype.getExpandRate=function(){return this.$1&&this.$1.googExpandRate?Number(this.$1.googExpandRate):null};a.prototype.getDiscardRate=function(){return this.$1&&this.$1.googSecondaryDiscardedRate?Number(this.$1.googSecondaryDiscardedRate):null};e.exports=a}),null);
__d("FBRTCMozMediaStatsReport",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){__p&&__p();for(var a=a.values(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.type==="inbound-rtp"&&d.mediaType==="audio"&&d.isRemote?this.$1=d:d.type==="inbound-rtp"&&d.mediaType==="video"&&!d.isRemote?this.$2=d:d.type==="outbound-rtp"&&d.mediaType==="video"&&!d.isRemote&&(this.$3=d)}}a.prototype.getFramesDecoded=function(){return this.$2&&this.$2.framesDecoded?Number(this.$2.framesDecoded):null};a.prototype.getFramesEncoded=function(){return this.$3&&this.$3.framesEncoded?Number(this.$3.framesEncoded):null};a.prototype.getVideoBytesReceived=function(){return this.$2&&this.$2.bytesReceived?Number(this.$2.bytesReceived):null};a.prototype.getAudioJitter=function(){return this.$1&&this.$1.jitter?Number(this.$1.jitter):null};a.prototype.getJitterBufferDelay=function(){return this.$1&&this.$1.mozJitterBufferDelay?Number(this.$1.mozJitterBufferDelay):null};a.prototype.getInboundQpSum=function(){return null};a.prototype.getOutboundQpSum=function(){return null};a.prototype.getAccelerateRate=function(){return null};a.prototype.getPreemptiveExpandRate=function(){return null};a.prototype.getExpandRate=function(){return null};a.prototype.getDiscardRate=function(){return null};e.exports=a}),null);
__d("RTCIceCandidate",[],(function(a,b,c,d,e,f){"use strict";e.exports=window.RTCIceCandidate||window.mozRTCPeerConnection}),null);
__d("RTCPeerConnection",[],(function(a,b,c,d,e,f){"use strict";e.exports=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection}),null);
__d("RTCSessionDescription",["invariant","FBRTCConfig","FBRTCConstants","FBRTCMediaType","FBRTCSdpUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").SignalingProtocol,i=window.RTCSessionDescription||window.mozRTCSessionDescription,j=2,k="o",l="m",m="a",n="rtpmap",o="ssrc-group",p="ssrc",q="cname",r="msid",s="mslabel",t="label",u="sendonly",v="recvonly",w="sendrecv",x="inactive",y="offer",z="answer",A="=",B=" ",C=":",D="\r\n",E="audio",F="video",G="application",H=function(a,b){return a.startsWith(b+A)},I=function(a){return a.substr(j)},J=function(a,b){return a.startsWith(b+D)||a.startsWith(b+C)},K=function(a,b){return a.substr(b.length+1)};function L(a){this.$1=[],this.$2="-",this.$3="multiway",this.$4=1,this.$5="IN",this.$6="IP4",this.$7="127.0.0.1",a.forEach(function(a){if(H(a,k)){var b=I(a).split(B);b.length==6&&(this.$2=b[0],this.$3=b[1],this.$4=parseInt(b[2],10),this.$5=b[3],this.$6=b[4],this.$7=b[5])}this.$1.push(a)}.bind(this))}L.prototype.setVersion=function(a){this.$4=a};L.prototype.getVersion=function(){return this.$4};L.prototype.toSdp=function(){return this.$1.map(function(a){if(H(a,k))return k+A+this.$2+B+this.$3+B+this.$4+B+this.$5+B+this.$6+B+this.$7;else return a}.bind(this)).join(D)};function M(a,b){__p&&__p();var c=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$1=[];var d={},e=[],f=[];a.forEach(function(a){__p&&__p();var b=I(a);H(a,l)&&(this.$4=b.split(B)[0]);if(H(a,m)&&J(b,n)){var c=K(b,n);c=c.split(B);var g=c[0];c=c[1];d[c]=g}H(a,m)&&J(b,p)?this.$6(b,e):H(a,m)&&J(b,o)?this.$7(b,f):H(a,m)&&(b===u||b===v||b===w||b===x)?this.$5=b:this.$1.push(a)}.bind(this));Object.keys(c).forEach(function(a){if(d[a]){var b=Object.keys(c[a]).map(function(b){return b+"="+c[a][b]}).join(";");this.$1.push("a=fmtp:"+d[a]+" "+b)}}.bind(this));this.$3={};this.$2={};e.forEach(function(a){if(Object.prototype.hasOwnProperty.call(a,q)){var b=a.cname;!this.$3[b]?this.$3[b]=[a]:this.$3[b].push(a);a=this.findSsrcGroupForSsrc(f,a.ssrc);a&&(!this.$2[b]?this.$2[b]=[a]:this.$2[b].push(a),this.removeSsrcGroup(a,f))}}.bind(this));this.$4!==G&&(b===y?e.length===0?this.$5=v:this.$5=w:b===z&&(this.$5=w))}M.prototype.getMediaType=function(){return this.$4};M.prototype.findSsrcGroupForSsrc=function(a,b){return a.find(function(a){a=a.ssrcs;return a.some(function(a){return a===b})})};M.prototype.addStreamsForEndpoint=function(a,b){this.$3[a]=b};M.prototype.addSsrcGroupsForEndpoint=function(a,b){this.$3[a].forEach(function(c){c=c.ssrc;c=this.findSsrcGroupForSsrc(b,c);c&&(!this.$2[a]?this.$2[a]=[c]:this.$2[a].push(c),this.removeSsrcGroup(c,b))}.bind(this))};M.prototype.removeSsrcGroup=function(a,b){a=b.indexOf(a);a!==-1&&b.splice(a,1)};M.prototype.$7=function(a,b){a=K(a,o);if(a){a=a.split(B);var c=a[0];a=a.slice(1);b.push({semantics:c,ssrcs:a.map(function(a){return parseInt(a,10)})})}};M.prototype.$6=function(a,b){__p&&__p();var c=a.indexOf(B),d=a.substr(0,c),e=parseInt(K(d,p),10);d=a.substr(c+1);a=b.find(function(a){return a.ssrc===e});a||(a={},a.ssrc=e,b.push(a));if(J(d,q))a.cname=K(d,q);else if(J(d,r)){c=K(d,r).split(B);a.msid={id:c[0],appdata:c[1]}}else J(d,s)?a.mslabel=K(d,s):J(d,t)&&(a.label=K(d,t))};M.prototype.toSdp=function(){__p&&__p();var a=[];this.$1.forEach(function(b){a.push(b)});for(var b in this.$2)this.$2[b].forEach(function(b){a.push(m+A+o+C+b.semantics+B+b.ssrcs.join(B))});a.push(m+A+this.$5);for(var c in this.$3)this.$3[c].forEach(function(b){b.cname&&a.push(m+A+p+C+b.ssrc+B+q+C+b.cname),b.msid&&a.push(m+A+p+C+b.ssrc+B+r+C+b.msid.id+(b.msid.appdata?B+b.msid.appdata:"")),b.mslabel&&a.push(m+A+p+C+b.ssrc+B+s+C+b.mslabel),b.label&&a.push(m+A+p+C+b.ssrc+B+t+C+b.label)});return a.join(D)};function a(a){__p&&__p();var b=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],c=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],d=b.type,e=d===undefined?"offer":d,f=b.sdp,g=f===undefined?"":f;this.$2=a;this.type=e;switch(a){case h.CUSTOM:this.$1=g;return;case h.MULTIWAY:this.$3(g,c);return;case h.P2P:this.$4(g,c);return}}a.prototype.$3=function(a,c){__p&&__p();this.type=="offer"&&(a=b("FBRTCSdpUtils").removeUnknownRtpHeaderExtensions(a));a=a.trim().split(D);var d=[],e=0;while(e<a.length&&!H(a[e],l))d.push(a[e]),e++;this.sessionDescription=new L(d);this.mediaDescriptions=[];while(e<a.length){d=[];d.push(a[e]);e++;while(e<a.length&&!H(a[e],l))d.push(a[e]),e++;this.mediaDescriptions.push(new M(d,this.type,c.FORMAT_PARAMETERS))}};a.prototype.$4=function(a,c){__p&&__p();var d=[function(a){return b("FBRTCSdpUtils").addIceOptionToSdp(a,"fb-force-5245")},function(a){return b("FBRTCSdpUtils").useDTLSOverCrypto(a)}];if(this.type==="offer"){c.DISABLE_VIDEO&&d.push(function(a){return b("FBRTCSdpUtils").disableVideo(a)});d.push(function(a){return b("FBRTCSdpUtils").replaceRTPSAVPFProfile(a)},function(a){return b("FBRTCSdpUtils").preferIsac(a)},function(a){return b("FBRTCSdpUtils").addSetup(a)},function(a){return b("FBRTCSdpUtils").removeUnknownRtpHeaderExtensions(a)});b("FBRTCConfig").isVCEndpointCall()||d.push(function(a){return b("FBRTCSdpUtils").removeSdparta(a)});c.ADD_AUDIO_NACK&&d.push(function(a){return b("FBRTCSdpUtils").addAudioNack(a)});if(c.FORMAT_PARAMETERS){var e=function(a){__p&&__p();var c=a[0];a=a[1];var e=function(a){var e=a[0],f=a[1];typeof f==="string"||g(0);d.push(function(a){return b("FBRTCSdpUtils").addFmtp(a,c,e,f)})};for(var a=Object.entries(a),f=Array.isArray(a),h=0,a=f?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var i;if(f){if(h>=a.length)break;i=a[h++]}else{h=a.next();if(h.done)break;i=h.value}i=i;e(i)}};for(var f=Object.entries(c.FORMAT_PARAMETERS),h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;e(j)}}d.push(function(a){return b("FBRTCSdpUtils").clearFirefoxInactiveDataChannelBlock(a)})}c.ADD_FB_FEATURES!=null&&d.push(function(a){Array.isArray(c.ADD_FB_FEATURES)||g(0);return b("FBRTCSdpUtils").addFBFeatures.apply(b("FBRTCSdpUtils"),[a].concat(c.ADD_FB_FEATURES))});this.$1=d.reduce(function(a,b){return b(a)},a)};a.prototype.processServerMediaUpdate=function(a){var c=a.sourceKey,d=a.media,e=a.ssrcGroups,f=[],g=[];d.forEach(function(a){a.ssrcs.forEach(function(d){d={ssrc:d,cname:c,msid:{id:c,appdata:a.id},label:a.id,mslabel:c};b("FBRTCMediaType").AUDIO===a.type?f.push(d):b("FBRTCMediaType").VIDEO===a.type&&g.push(d)})});this.mediaDescriptions.forEach(function(a){a.getMediaType()===E?(a.addStreamsForEndpoint(c,f),a.addSsrcGroupsForEndpoint(c,e)):a.getMediaType()===F&&(a.addStreamsForEndpoint(c,g),a.addSsrcGroupsForEndpoint(c,e))})};a.prototype.toDesc=function(){return new i({type:this.type,sdp:this.toSdp()})};a.prototype.toSdp=function(){var a=this.$2;switch(a){case h.MULTIWAY:return[this.sessionDescription.toSdp(),this.mediaDescriptions.map(function(a){return a.toSdp()}).join(D),""].join(D);case h.CUSTOM:case h.P2P:default:return this.$1}};a.prototype.strongDiff=function(a){var b=this.toSdp();a=a.toSdp();return b!==a&&this.$5(b)!==this.$5(a)};a.prototype.$5=function(a){return this.$6(a).split("\r\n").filter(function(a){return!/^a=(candidate|setup):/.test(a)}).join("\r\n")};a.prototype.$6=function(a){return a.replace(/(o=\S+\s\S+)\s\S+\s/,"$1 - ")};e.exports=a}),null);
__d("FBRTCPeerConnection",["Promise","regeneratorRuntime","FBRTCConfig","FBRTCConsoleLogger","FBRTCExperiment","FBRTCSdpUtils","RTCIceCandidate","RTCPeerConnection","RTCSessionDescription","UserAgent"],(function(a,b,c,d,e,f){"use strict";__p&&__p();g.isGetSendersSupported=function(){return q("getSenders")};g.isReplaceTrackSupported=function(){return typeof window.RTCRtpSender==="function"&&typeof window.RTCRtpSender.prototype.replaceTrack==="function"};function g(a){__p&&__p();var b=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],c=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];this.$3=[];this.$4=[];this.$7=new Map();this.addEventListener=function(a,b){var c=this.$7.get(a);Array.isArray(c)||(c=[],this.$7.set(a,c));c.push(b);this.$5.addEventListener(a,b)};this.removeEventListener=function(a,b){var c=this.$7.get(a);Array.isArray(c)&&(c=c.filter(function(a){return a!==b}),c.length<1?this.$7["delete"](a):this.$7.set(a,c));this.$5.removeEventListener(a,b)};this.$9=function(a){a=a.candidate;a&&this.$4.push(a)}.bind(this);this.$10=function(a){a=a.channel;this.$11(a)}.bind(this);this.$6=a;this.$1=b;this.$2=c;this.$5=this.$8()}g.prototype.$8=function(){__p&&__p();var a=new(b("RTCPeerConnection"))(this.$1,this.$2);a.addEventListener("icecandidate",this.$9);a.addEventListener("datachannel",this.$10);for(var c=this.$7.entries(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];for(var f=f,h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;a.addEventListener(g,j)}}return a};g.prototype.removeAllListeners=function(){__p&&__p();for(var a=this.$7.entries(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;var e=d[0];d=d[1];for(var d=d,f=Array.isArray(d),g=0,d=f?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=d.length)break;h=d[g++]}else{g=d.next();if(g.done)break;h=g.value}h=h;this.$5.removeEventListener(e,h)}}this.$5.removeEventListener("datachannel",this.$10);this.$5.removeEventListener("icecandidate",this.$9)};g.prototype.reset=function(){__p&&__p();var a=this.$5;for(var c=this.$7.entries(),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=f[0];f=f[1];for(var f=f,h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;a.removeEventListener(g,j)}}a.removeEventListener("datachannel",this.$10);a.removeEventListener("icecandidate",this.$9);this.$3=[];this.$4=[];this.$5=this.$8();for(var j=a.getLocalStreams(),i=Array.isArray(j),h=0,j=i?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(i){if(h>=j.length)break;f=j[h++]}else{h=j.next();if(h.done)break;f=h.value}g=f;this.addStream(g)}return b("Promise").race([new(b("Promise"))(function(b){var c=this.$5,d=function d(e){e=e.target;e.iceConnectionState!=="checking"&&e.iceConnectionState!=="new"&&(b(),c.removeEventListener("iceconnectionstatechange",d),p(a))};c.addEventListener("iceconnectionstatechange",d)}.bind(this)),new(b("Promise"))(function(a){return setTimeout(a,5e3)})])["catch"](function(a){return b("Promise").resolve()}).then(function(){p(a)})};g.prototype.close=function(){p(this.$5)};g.prototype.getCreatedIceCandidates=function(){return this.$4};g.prototype.$11=function(a){a.addEventListener("close",function(){this.$3=this.$3.filter(function(b){return b!==a})}.bind(this)),this.$3.push(a)};g.prototype.onReceivedRemoteIceCandidate=function(a){var c=a.sdp,d=a.label;a=a.sdp_mid;d=new(b("RTCIceCandidate"))({sdpMLineIndex:d,candidate:b("FBRTCSdpUtils").fixMobileIceSdp(c),sdpMid:a});return b("Promise").resolve(this.$5.addIceCandidate(d))};g.prototype.getSignalingProtocol=function(){return this.$6};g.prototype.getLocalStreams=function(){return this.$5.getLocalStreams()};g.prototype.getRemoteStreams=function(){return this.$5.getRemoteStreams()};g.isFirefoxSupportAddTrack=function(){return b("UserAgent").isBrowser("Firefox")&&q("addTrack")&&g.isGetSendersSupported()};g.prototype.addStream=function(a,b){__p&&__p();var c=this;if(g.isFirefoxSupportAddTrack()){var d=this.getSenders(),e=function(e){var f=d.find(function(a){return a.track===e});f===undefined&&(f=c.$5.addTrack(e,a));b&&f&&b(f)};for(var f=a.getTracks(),h=Array.isArray(f),i=0,f=h?f:f[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=f.length)break;j=f[i++]}else{i=f.next();if(i.done)break;j=i.value}j=j;e(j)}}else this.$5.addStream(a)};g.prototype.removeStream=function(a){__p&&__p();var c=this;b("UserAgent").isBrowser("Firefox")&&q("removeTrack")&&g.isGetSendersSupported()?(function(){__p&&__p();var b=a.getTracks(),d=c.getSenders().filter(function(a){return b.includes(a.track)});for(var d=d,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.$5.removeTrack(g)}})():this.$5.removeStream(a)};g.prototype.createOffer=function(){var a=arguments.length<=0||arguments[0]===undefined?{}:arguments[0],c=arguments.length<=1||arguments[1]===undefined?{}:arguments[1],d=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",i(this.$5,a).then(function(b){return v(b,d,a)}).then(function(a){return new(b("RTCSessionDescription"))(this.$6,a,c)}.bind(this)));case 1:case"end":return e.stop()}},null,this)};g.prototype.createAnswer=function(){var a=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:return c.abrupt("return",j(this.$5).then(function(c){return new(b("RTCSessionDescription"))(this.$6,c,a)}.bind(this)));case 1:case"end":return c.stop()}},null,this)};g.prototype.setLocalDescription=function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:return b.abrupt("return",n(this.$5,a.toDesc()).then(function(){return a}));case 1:case"end":return b.stop()}},null,this)};g.prototype.setRemoteDescription=function(a){return b("regeneratorRuntime").async(function(b){while(1)switch(b.prev=b.next){case 0:return b.abrupt("return",o(this.$5,a.toDesc()).then(function(){return a}));case 1:case"end":return b.stop()}},null,this)};g.prototype.getLocalDescription=function(){return new(b("RTCSessionDescription"))(this.$6,this.$5.localDescription||{})};g.prototype.getRemoteDescription=function(){return new(b("RTCSessionDescription"))(this.$6,this.$5.remoteDescription||{})};g.prototype.getSignalingState=function(){return this.$5.signalingState};g.prototype.getIceGatheringState=function(){return this.$5.iceGatheringState};g.prototype.getIceConnectionState=function(){return this.$5.iceConnectionState};g.prototype.getSenders=function(){if(g.isGetSendersSupported()===!1)throw new Error("RTCPeerConnection.getSenders is not supported");return this.$5.getSenders()};g.prototype.getStats=function(a){__p&&__p();return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:if(!(a!=null)){c.next=2;break}return c.abrupt("return",b("Promise").reject(new Error("getStats() doesn't support selector (yet)")));case 2:if(!b("UserAgent").isBrowser("Edge")){c.next=4;break}return c.abrupt("return",b("Promise").resolve(new Map()));case 4:if(!b("UserAgent").isBrowser("Firefox")){c.next=6;break}return c.abrupt("return",b("Promise").resolve(this.$5.getStats()).then(function(a){return b("UserAgent").isBrowser("Firefox >= 48")?a:s(a)}).then(function(a){__p&&__p();if(b("UserAgent").isBrowser("Firefox >= 53"))return a;try{a.forEach(function(a){a.type=t(a.type)})}catch(b){if(b.name!=="TypeError")throw b;a.forEach(function(b,c){a.set(c,babelHelpers["extends"]({},b,{type:t(b.type)}))})}return a}));case 6:if(!(b("UserAgent").isBrowser("Chrome")||b("UserAgent").isBrowser("Opera"))){c.next=8;break}return c.abrupt("return",new(b("Promise"))(function(a,b){this.$5.getStats(a,b)}.bind(this)).then(function(a){__p&&__p();var b={};for(var a=a.result(),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;var f={id:e.id,timestamp:e.timestamp,type:t(e.type)};for(var g=e.names(),h=Array.isArray(g),i=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=g.length)break;j=g[i++]}else{i=g.next();if(i.done)break;j=i.value}j=j;f[j]=e.stat(j)}b[f.id]=f}return b}).then(s));case 8:return c.abrupt("return",b("Promise").reject(new Error("getStats() not supported")));case 9:case"end":return c.stop()}},null,this)};g.prototype.createDataChannel=function(a,b){if(this.$5.createDataChannel){a=this.$5.createDataChannel(a,b);this.$11(a);return a}return null};g.prototype.getDataChannelByLabel=function(a){return this.$3.find(function(b){return b.label===a})};var h=b("UserAgent").isBrowser("Chrome < 59")||b("UserAgent").isBrowser("Opera < 46")||b("UserAgent").isBrowser("Firefox < 37");function i(a,c){return h?new(b("Promise"))(function(b,d){return a.createOffer(b,d,l(c))}):b("Promise").resolve(a.createOffer(l(c)))}function j(a){return h?new(b("Promise"))(function(b,c){return a.createAnswer(b,c)}):b("Promise").resolve(a.createAnswer())}var k=b("UserAgent").isBrowser("Chrome < 38")||b("UserAgent").isBrowser("Opera < 26");function l(a){var b=a.offerToReceiveAudio;b=b===undefined?!0:b;var c=a.offerToReceiveVideo;c=c===undefined?!0:c;a=babelHelpers.objectWithoutProperties(a,["offerToReceiveAudio","offerToReceiveVideo"]);return k?Object.keys(a).length>0?{mandatory:{OfferToReceiveAudio:b,OfferToReceiveVideo:c},optional:babelHelpers["extends"]({},r(a))}:{mandatory:{OfferToReceiveAudio:b,OfferToReceiveVideo:c}}:babelHelpers["extends"]({offerToReceiveAudio:b,offerToReceiveVideo:c},a)}var m=b("UserAgent").isBrowser("Chrome < 51")||b("UserAgent").isBrowser("Opera < 38")||b("UserAgent").isBrowser("Firefox < 37");function n(a,c){return m?new(b("Promise"))(function(b,d){return a.setLocalDescription(c,b,d)}):b("Promise").resolve(a.setLocalDescription(c))}function o(a,c){return m?new(b("Promise"))(function(b,d){return a.setRemoteDescription(c,b,d)}):b("Promise").resolve(a.setRemoteDescription(c))}function p(a){a&&a.signalingState!=="closed"&&a.close()}function q(a){return typeof b("RTCPeerConnection").prototype[a]==="function"}function r(a){__p&&__p();var b={};for(var c=Object.keys(a),d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=c.length)break;f=c[e++]}else{e=c.next();if(e.done)break;f=e.value}f=f;var g=""+f.substr(0,1).toUpperCase()+f.substr(1);b[g]=a[f]}return b}function s(a){return new Map(Object.keys(a).map(function(b){return[b,a[b]]}))}function t(a){switch(a){case"inbound-rtp":return"inboundrtp";case"outbound-rtp":return"outboundrtp";case"candidate-pair":return"candidatepair";case"local-candidate":return"localcandidate";case"remote-candidate":return"remotecandidate";default:return a}}function u(a,c){if(b("FBRTCConfig").isVCEndpointCall())return!1;a=a.video&&a.video.match(/H264/);if(!a&&!c.preserveH264){a=b("FBRTCExperiment").gen("rtc_browser_use_h264");return a.getParam("allow_h264","no")!=="yes"}return!1}function v(a,c){var d=arguments.length<=2||arguments[2]===undefined?{}:arguments[2],e=c.audio,f=c.video,g=a.sdp,h=a.type;u(c,d)&&(g=b("FBRTCSdpUtils").removeH264(g));e&&(g=b("FBRTCSdpUtils").preferCodec(g,e,!1));f&&(g=b("FBRTCSdpUtils").preferCodec(g,f,!0));return b("Promise").resolve({sdp:g,type:h})}e.exports=g}),null);
__d("FBRTCMediaMetricParser",["FBRTCCallSummary","FBRTCChromeMediaStatsReport","FBRTCLogger","FBRTCMediaMetricsConst","FBRTCMozMediaStatsReport","FBRTCPeerConnection","RTCCallStore","RTCConferenceState","UserAgent"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={parseStats:function(a,c){__p&&__p();a.getStats().then(function(a){__p&&__p();var d=null;b("UserAgent").isBrowser("Chrome")?d=new(b("FBRTCChromeMediaStatsReport"))(a):b("UserAgent").isBrowser("Firefox")&&(d=new(b("FBRTCMozMediaStatsReport"))(a));if(d){a=c.getMediaMetricTracker();var e=d.getJitterBufferDelay(),f=d.getAudioJitter(),g=d.getAccelerateRate(),h=d.getExpandRate(),i=d.getPreemptiveExpandRate(),j=d.getDiscardRate(),k=d.getOutboundQpSum(),l=d.getFramesEncoded();d=d.getVideoBytesReceived();e&&a.addJitterBufferDelay(e);f&&a.addMetricStat(b("FBRTCMediaMetricsConst").JITTER,f);g&&a.addMetricStat(b("FBRTCMediaMetricsConst").ACCELERATE_RATE,g);j&&a.addMetricStat(b("FBRTCMediaMetricsConst").DISCARD_RATE,j);h&&a.addMetricStat(b("FBRTCMediaMetricsConst").EXPAND_RATE,h);i&&a.addMetricStat(b("FBRTCMediaMetricsConst").PREEMPTIVE_RATE,i);d&&a.setVideoMetric(b("FBRTCMediaMetricsConst").VIDEO_BYTES_RECEIVED,d);k&&l&&(a.setVideoMetric(b("FBRTCMediaMetricsConst").OUTBOUND_QP,k),a.setVideoMetric(b("FBRTCMediaMetricsConst").FRAMES_ENCODED,l))}})["catch"](function(a){b("FBRTCLogger").getInstance().logToConsole("error parsing RTCStatsReport")})},startCollectingMediaStats:function(){var a=b("RTCCallStore").getState().callInfo.conferenceState,c=b("RTCCallStore").getState().callSummary,d=b("RTCCallStore").getState().connections.first();a!==b("RTCConferenceState").TERMINATED&&(d&&g.parseStats(d,c),setTimeout(g.startCollectingMediaStats,5e3))}};e.exports=g}),null);