if (self.CavalryLogger) { CavalryLogger.start_js(["Alt3U"]); }

__d("FBRTCCapability",[],(function(a,b,c,d,e,f){e.exports={SUPPORT_AUDIO_DEPRECATED:0,SUPPORT_VIDEO_DEPRECATED:1,SUPPORT_EXPERIMENTS_IN_JOIN_RESPONSE:2,SUPPORT_NEW_PARTICIPANT_STATES:3,SUPPORT_SDP_RENEGOTIATION:4}}),null);
__d("FBRTCDeviceStatus",[],(function(a,b,c,d,e,f){e.exports={OK:0,NOT_SUPPORTED:1,IN_ANOTHER_CALL:10}}),null);
__d("FBRTCMessageType",[],(function(a,b,c,d,e,f){e.exports={JOIN:0,SERVER_MEDIA_UPDATE:1,HANGUP:2,ICE_CANDIDATE:3,RING:4,DISMISS:5,CONFERENCE_STATE:6,ADD_PARTICIPANTS:7,SUBSCRIPTION:8,CLIENT_MEDIA_UPDATE:9,DATA_MESSAGE:10,REMOVE_PARTICIPANTS:11,EXPERIMENT:12,CONNECT:16,APPROVAL:17}}),null);
__d("FBRTCVideoQuality",[],(function(a,b,c,d,e,f){e.exports={LOW:0,MEDIUM:1,HIGH:2,HD:3,NUM_QUALITIES:4}}),null);
__d("BonfireUserFetcherQuery.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{kind:"LocalArgument",name:"userId",type:"ID!",defaultValue:null}],b=[{kind:"Variable",name:"id",variableName:"userId",type:"ID!"}],c={kind:"ScalarField",alias:null,name:"id",args:null,storageKey:null},d={kind:"ScalarField",alias:null,name:"display_name",args:null,storageKey:null},e={kind:"ScalarField",alias:null,name:"username",args:null,storageKey:null},f={kind:"ScalarField",alias:null,name:"profile_picture_uri",args:null,storageKey:null};return{kind:"Request",operationKind:"query",name:"BonfireUserFetcherQuery",id:"1552602298128844",text:null,metadata:{},fragment:{kind:"Fragment",name:"BonfireUserFetcherQuery",type:"Query",metadata:null,argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"InlineFragment",type:"User",selections:[c,{kind:"LinkedField",alias:null,name:"bonfire_user",storageKey:null,args:null,concreteType:"BonfireUser",plural:!1,selections:[c,d,e,f,{kind:"FragmentSpread",name:"BonfireParticipantRow_participant",args:null}]}]}]}]},operation:{kind:"Operation",name:"BonfireUserFetcherQuery",argumentDefinitions:a,selections:[{kind:"LinkedField",alias:null,name:"node",storageKey:null,args:b,concreteType:null,plural:!1,selections:[{kind:"ScalarField",alias:null,name:"__typename",args:null,storageKey:null},c,{kind:"InlineFragment",type:"User",selections:[{kind:"LinkedField",alias:null,name:"bonfire_user",storageKey:null,args:null,concreteType:"BonfireUser",plural:!1,selections:[c,d,e,f,{kind:"ScalarField",alias:null,name:"account_id",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"is_viewer_friend",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"is_blocked_by_viewer",args:null,storageKey:null},{kind:"ScalarField",alias:null,name:"last_active_time",args:null,storageKey:null},{kind:"LinkedField",alias:null,name:"active_friend_request_with_viewer",storageKey:null,args:null,concreteType:"BonfireFriendRequest",plural:!1,selections:[c]}]}]}]}]}}}();e.exports=a}),null);
__d("RTCMediaDeniedPrompt.react",["cx","fbt","React","UserAgent","XUIContextualDialog.react","XUIContextualDialogBody.react","XUIContextualDialogTitle.react"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.$1=function(){"use strict";return b("UserAgent").isBrowser("Chrome")?"right":"left"};a.prototype.render=function(){"use strict";return b("React").createElement("span",{className:"_173p"},b("React").createElement("div",{className:"_3wrz",ref:"mpTarget"}),b("React").createElement(b("XUIContextualDialog.react"),{alignment:this.$1(),contextRef:function(){return this.refs.mpTarget}.bind(this),key:"popover",position:"below",shown:!0,width:b("XUIContextualDialog.react").WIDTH.NORMAL},b("React").createElement(b("XUIContextualDialogTitle.react"),null,h._("Click to Turn on Camera and Microphone")),b("React").createElement(b("XUIContextualDialogBody.react"),null,h._("To use video calling, you need to turn on your camera and microphone during the call."))))};function a(){"use strict";i.apply(this,arguments)}e.exports=a}),null);
__d("MessengerBannerOverlay.react",["cx","React","ReactCSSTransitionGroup"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=6e3,j={enter:"_3fa9",enterActive:"_3faa",leave:"_3fab",leaveActive:"_3fad"};c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={hide:!1},b}a.prototype.componentDidUpdate=function(){this.props.useTimeout&&!this.state.hide&&setTimeout(function(){this.setState({hide:!0})}.bind(this),i)};a.prototype.$1=function(){return!this.state.hide&&this.props.display&&this.props.children?b("React").createElement("div",{className:"_qxg"},b("React").createElement("h2",{className:"_qxh"},this.props.children)):null};a.prototype.render=function(){return b("React").createElement(b("ReactCSSTransitionGroup"),{component:"div",transitionName:j,transitionEnterTimeout:600,transitionLeaveTimeout:600},this.$1())};a.BANNER_TIMEOUT=i;e.exports=a}),null);
__d("BonfireUserFetcher",["regeneratorRuntime","Promise","immutable","LogHistory","RelayFBEnvironment","RelayModern","RTCUser","idx","nullthrows","BonfireUserFetcherQuery.graphql"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;b("immutable").Set;var h=b("immutable").List,i=b("immutable").Map;b("RelayModern").graphql;var j=b("RelayModern").fetchQuery;function k(a){__p&&__p();return b("regeneratorRuntime").async(function(c){__p&&__p();while(1)switch(c.prev=c.next){case 0:c.prev=0;c.next=3;return b("regeneratorRuntime").awrap(j(b("RelayFBEnvironment"),g||(g=function(){return b("BonfireUserFetcherQuery.graphql")}),{userId:a}));case 3:return c.abrupt("return",c.sent);case 6:c.prev=6;c.t0=c["catch"](0);b("LogHistory").getInstance("bonfire_fetcher").error("fetch_error",JSON.stringify(c.t0));throw c.t0;case 10:case"end":return c.stop()}},null,this,[[0,6]])}function l(a){__p&&__p();var c,d,e;a=a.node;c=(c=a)!=null?(c=c.bonfire_user)!=null?c.id:c:c;d=(d=a)!=null?d.id:d;if(!c||!d)return null;c=b("nullthrows")((c=a)!=null?(c=c.bonfire_user)!=null?c.display_name:c:c);e=b("nullthrows")((e=a)!=null?(e=e.bonfire_user)!=null?e.username:e:e);a=b("nullthrows")((a=a)!=null?(a=a.bonfire_user)!=null?a.profile_picture_uri:a:a);return new(b("RTCUser"))({FBID:d,profileUrl:null,profilePictureUrl:a,isMessengerUser:!1,userName:c,userShortName:e})}function m(a){__p&&__p();var c,d,e;a=a.node;c=(c=a)!=null?(c=c.bonfire_user)!=null?c.id:c:c;d=(d=a)!=null?d.id:d;if(!c||!d)return null;c=b("nullthrows")((c=a)!=null?(c=c.bonfire_user)!=null?c.display_name:c:c);e=b("nullthrows")((e=a)!=null?(e=e.bonfire_user)!=null?e.username:e:e);a=b("nullthrows")((a=a)!=null?(a=a.bonfire_user)!=null?a.profile_picture_uri:a:a);return{accepts_messenger_user_feedback:!1,big_image_src:a,employee:!1,fbid:d,gender:0,href:null,id:"fbid:"+d,image_src:a,is_business_enabled:null,is_employee_away:null,is_friend:null,is_messenger_user:null,is_messenger_platform_bot:null,is_parties_user:!0,is_verified:null,name:c,short_name:c,type:null,vanity:e,timezone:null,personal_id:null,work_id:null}}function n(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(k(a));case 2:c=d.sent;return d.abrupt("return",m(c));case 4:case"end":return d.stop()}},null,this)}function a(a){__p&&__p();var c,d,e,f;return b("regeneratorRuntime").async(function(g){__p&&__p();while(1)switch(g.prev=g.next){case 0:c=h(a);d=c.map(function(a){return n(a)}).toArray();g.next=4;return b("regeneratorRuntime").awrap(b("Promise").all(d));case 4:e=g.sent;f=i(c.zip(e));return g.abrupt("return",f.mapKeys(function(a,b){return b&&b.id||a}));case 7:case"end":return g.stop()}},null,this)}function c(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(n(a));case 2:c=d.sent;return d.abrupt("return",b("nullthrows")(c));case 4:case"end":return d.stop()}},null,this)}function d(a){var c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:d.next=2;return b("regeneratorRuntime").awrap(k(a));case 2:c=d.sent;return d.abrupt("return",l(c));case 4:case"end":return d.stop()}},null,this)}e.exports={fetchAllParticipants:a,fetchParticipant:c,fetchUser:d}}),null);
__d("FBRTCMultiwayMessage",["ChannelManager","CurrentUser","FBRTCMessageType","RTCAppData","RTCUtils"],(function(a,b,c,d,e,f){__p&&__p();b("ChannelManager").startChannelManager();function g(a){"use strict";this.$1=a}g.prototype.isRequest=function(){"use strict";return this.$1.jsonPayload.header.responseStatusCode==null};g.prototype.isType=function(a){"use strict";return this.type()==a};g.prototype.transactionId=function(){"use strict";return this.$1.jsonPayload.header.transactionId};g.prototype.conferenceName=function(){"use strict";return this.$1.jsonPayload.header.conferenceName};g.prototype.serverInfoData=function(){"use strict";return this.$1.jsonPayload.header.serverInfoData};g.prototype.message=function(){"use strict";return this.$1};g.prototype.type=function(){"use strict";return this.header().type};g.prototype.endpoint=function(){"use strict";return this.$1.endpoint};g.prototype.header=function(){"use strict";return this.$1.jsonPayload.header};g.prototype.body=function(){"use strict";return this.$1.jsonPayload.body};g.prototype.incrementRetryCount=function(){"use strict";this.$1.jsonPayload.header.retryCount++};g.prototype.ringRequest=function(){"use strict";return this.isRequest()&&this.isType(b("FBRTCMessageType").RING)?this.body().ringRequest:null};g.prototype.dismissRequest=function(){"use strict";return this.isRequest()&&this.isType(b("FBRTCMessageType").DISMISS)?this.body().dismissRequest:null};g.prototype.serverMediaUpdateRequest=function(){"use strict";return this.isRequest()&&this.isType(b("FBRTCMessageType").SERVER_MEDIA_UPDATE)?this.body().serverMediaUpdateRequest:null};g.prototype.conferenceStateRequest=function(){"use strict";return this.isRequest()&&this.isType(b("FBRTCMessageType").CONFERENCE_STATE)?this.body().conferenceStateRequest:null};g.prototype.createResponse=function(a,c){"use strict";var d=c.body;c=c.callID;a={endpoint:{appId:b("RTCAppData").getMWAppID(),deviceId:b("ChannelManager").getCompleteConfig().sessionID,userId:b("CurrentUser").getID()},jsonPayload:{header:b("RTCUtils").createResponseHeader(this.header(),a,c?c:""),body:d||{}}};return new g(a)};e.exports=g}),null);
__d("XGroupCallSendMessageController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/sendmessage/",{webrtc_fbtrace:{type:"Int"}})}),null);
__d("RTCMessageSender",["Promise","AsyncRequest","CurrentUser","Fbtrace","RTCAppData","SiteData","XGroupCallSendMessageController"],(function(a,b,c,d,e,f){__p&&__p();var g=6e3;function a(){"use strict"}a.prototype.send=function(a){"use strict";__p&&__p();return new(b("Promise"))(function(c,d){__p&&__p();var e=a.jsonPayload.header.conferenceName;e={conference_name:e,user_id:b("CurrentUser").getID(),message:a,app_id:b("RTCAppData").getAppID(),app_version:String(b("SiteData").client_revision||"dev"),op:"RTCMessageSender.send",policy:"WebRTC"};e=b("Fbtrace").requestReceive("browser",String(b("SiteData").client_revision||"dev"),e);var f=b("XGroupCallSendMessageController").getURIBuilder().setInt("webrtc_fbtrace",e.isOn()?1:0).getURI();b("Fbtrace").withDefaultNode(e,function(){var e=new(b("AsyncRequest"))(f).setMethod("POST").setData({message:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(a){c(a)}).setErrorHandler(function(a){a=a.getErrorDescription();a=Error(a!=null?a.toString():"AsyncRequest error");d(a)}).setTimeoutHandler(g,function(){d("Timeout")});e.send()})})};e.exports=a}),null);
__d("FBRTCTransactions",["Promise","FBRTCConsoleLogger","RTCMessageSender"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=6e4,h=Object.freeze({INIT:0,PROCESSING:1,COMPLETED:2,TERMINATED:3});function a(){this.$1=new Map()}a.prototype.findTransaction=function(a){return this.$1.get(a)};a.prototype.addTransaction=function(a){this.$1.set(a.id,a)};a.prototype.removeTransaction=function(a){this.$1["delete"](a.id)};a.prototype.getTransaction=function(a){return this.findTransaction(a.transactionId())||new i(this,a)};function i(a,c){this.id=c.transactionId(),this.$1=h.INIT,this.$2=c,this.$3=null,this.$4=a,this.$5=new Error("Unknown"),this.$6=null,this.$7=new(b("RTCMessageSender"))(),this.$8(),this.$4.addTransaction(this)}i.prototype.start=function(){__p&&__p();if(this.$1==h.INIT){this.$9(h.PROCESSING);return b("Promise").resolve(this.$2)}else if(this.$1==h.PROCESSING)return b("Promise").resolve(null);else if(this.$1==h.COMPLETED){this.$10();return b("Promise").resolve(null)}return b("Promise").reject(this.$5)};i.prototype.sendResponse=function(a){this.$3=a;this.$9(h.COMPLETED);return this.$7.send(a.message()).then(function(a){},function(a){this.$5=a,this.$9(h.TERMINATED)}.bind(this))};i.prototype.$10=function(){if(this.$3!=null){var a=this.$3;a.incrementRetryCount();this.sendResponse(a)}};i.prototype.$9=function(a){a!=this.$1&&(this.$1=a,this.$1!=h.TERMINATED&&this.$8(),this.$1==h.TERMINATED&&(this.$5=new Error("Terminated"),this.$4.removeTransaction(this)))};i.prototype.$8=function(){this.$6&&(clearTimeout(this.$6),this.$6=null),this.$6=setTimeout(function(){this.$9(h.TERMINATED)}.bind(this),g)};e.exports={FBRTCTransactionOwner:a,FBRTCServerTransaction:i}}),null);
__d("XGroupCallSendRequestController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/groupcall/sendrequest/",{webrtc_fbtrace:{type:"Int"}})}),null);
__d("MultiwayRequests",["Promise","AsyncRequest","FBRTCCapability","FBRTCMessageType","RTCUtils","XGroupCallSendRequestController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=15e3;function a(){}a.prototype.sendJoinRequest=function(a,c,d,e,f,g,h,i){__p&&__p();var j=h.callID,k=h.numParticipants;h=h.callTrigger;var l=i.userToEscalate,m=i.isEscalator;i=i.escP2PCallID;c=b("RTCUtils").createRequestHeader(b("FBRTCMessageType").JOIN,c,d,j,i);d={offer:{sdpString:e.toSdp()},deviceCapabilities:[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED]};j=b("RTCUtils").createClientContextMessage(k,h?h:"");d.appMessages=[j];f&&f.length>0&&!l&&(d.usersToCall=f);l&&m&&(d.userToEscalate=l);g&&(d.mediaStatus=g);i={endpoint:a,jsonPayload:{header:c,body:{joinRequest:d}}};return this.$1(i)};a.prototype.sendHangupRequest=function(a,c,d,e,f,g){c=b("RTCUtils").createRequestHeader(b("FBRTCMessageType").HANGUP,c,d,g);d={reason:e,detailedReasonString:f};g={endpoint:a,jsonPayload:{header:c,body:{hangupRequest:d}}};return this.$1(g)};a.prototype.sendAddParticipantsRequest=function(a,c,d,e,f){c=b("RTCUtils").createRequestHeader(b("FBRTCMessageType").ADD_PARTICIPANTS,c,d,f);d={usersToInvite:e};f={endpoint:a,jsonPayload:{header:c,body:{addParticipantsRequest:d}}};return this.$1(f)};a.prototype.sendSubscriptionRequest=function(a,c,d,e,f){return this.$1({endpoint:a,jsonPayload:{header:b("RTCUtils").createRequestHeader(b("FBRTCMessageType").SUBSCRIPTION,c,d,f),body:{subscriptionRequest:{subscriptions:e}}}})};a.prototype.sendClientMediaUpdateRequest=function(a,c,d,e,f,g,h){return this.$1({endpoint:a,jsonPayload:{header:b("RTCUtils").createRequestHeader(b("FBRTCMessageType").CLIENT_MEDIA_UPDATE,c,d,h),body:{clientMediaUpdateRequest:{fromVersion:e,toVersion:f,mediaUpdates:g}}}})};a.prototype.$1=function(a){return new(b("Promise"))(function(c,d){var e=b("XGroupCallSendRequestController").getURIBuilder().getURI();e=new(b("AsyncRequest"))(e).setMethod("POST").setData({request:JSON.stringify(a)}).setAllowCrossPageTransition(!0).setHandler(function(a){c(a.payload)}).setErrorHandler(function(a){a=a.getErrorDescription();a=Error(a!=null?a.toString():"AsyncRequest error");d(a)}).setTimeoutHandler(g,function(){d("Timeout")});e.send()})};e.exports=new a()}),null);
__d("RTCGroupCallAddUserWarningDialog.react",["fbt","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogTitle.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=function(a){var c=a.hasBlockedUser;a=a.hasNewUser;var d=null;c&&a?d=g._("You are trying to ring blocked users who will be able to view previous message."):c?d=g._("You are trying to ring blocked users."):a&&(d=g._("Added users will be able to view previous messages."));return b("React").createElement(b("MessengerDialogBody.react"),null,d)};a=function(a){var c=a.handleRing,d=a.hasBlockedUser,e=a.hasNewUser,f=a.onToggle,i=a.unMountParent;return b("React").createElement(b("MessengerDialog.react"),{onToggle:f},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,g._("Ring Members Warning"))),b("React").createElement(h,{hasBlockedUser:d,hasNewUser:e}),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogCancelButton.react"),null),b("React").createElement(b("MessengerDialogButton.react"),{label:g._("Ring"),onClick:function(){f(),i(),c()},type:"primary",use:"default"})))};e.exports=a}),null);
__d("RTCGroupCallIncomingBlockedUserWarningDialog.react",["fbt","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogTitle.react","React"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.leaveCall,d=a.onAddStream,e=a.onToggle;return b("React").createElement(b("MessengerDialog.react"),{onToggle:e},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,g._("Incoming Blocked User Warning"))),b("React").createElement(b("MessengerDialogBody.react"),null,g._("Blocked member is entering the call. Do you want to leave?")),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{label:g._("Leave Call"),onClick:function(){e(),c()},type:"primary",use:"default"}),b("React").createElement(b("MessengerDialogButton.react"),{label:g._("Stay"),onClick:function(){e(),d()},type:"primary",use:"default"})))};e.exports=a}),null);
__d("RTCGroupCallDialogController",["DOM","FBRTCGroupCallVideoEscalationDialog.react","React","ReactDOM","RTCGroupCallAddMembersDialog.react","RTCGroupCallAddUserWarningDialog.react","RTCGroupCallIncomingBlockedUserWarningDialog.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={_container:b("DOM").create("div"),_blockedContainer:b("DOM").create("div"),showAddGroupMembersDialog:function(a,c,d,e,f){b("ReactDOM").render(b("React").createElement(b("RTCGroupCallAddMembersDialog.react"),{isEscalatedCall:f,onUnmount:function(){return this._onUnmount()}.bind(this),participantStates:c,participants:a,thread:d,viewerID:e}),this._container)},showVideoEscalationDialog:function(a,c){b("ReactDOM").render(b("React").createElement(b("FBRTCGroupCallVideoEscalationDialog.react"),{onToggle:function(){this._onUnmount(),c()}.bind(this),userName:a}),this._container)},showBlockedUserWarningDialog:function(a,c,d,e){b("ReactDOM").render(b("React").createElement(b("RTCGroupCallAddUserWarningDialog.react"),{handleRing:a,hasBlockedUser:d,hasNewUser:e,onToggle:function(){this._onBlockedDialogUnmount()}.bind(this),unMountParent:c}),this._blockedContainer)},showIncomingBlockedUserWarningDialog:function(a,c,d,e){b("ReactDOM").render(b("React").createElement(b("RTCGroupCallIncomingBlockedUserWarningDialog.react"),{leaveCall:a,onAddStream:function(){c(d,e)},onToggle:function(){this._onUnmount()}.bind(this)}),this._container)},_onUnmount:function(){b("ReactDOM").unmountComponentAtNode(this._container)},_onBlockedDialogUnmount:function(){b("ReactDOM").unmountComponentAtNode(this._blockedContainer)}};e.exports=a}),null);
__d("RTCGroupCallActions",["RTCAppDispatcher","RTCCallActionTypes","RTCUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={setLayout:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").SET_LAYOUT,layout:a})},setDominantSpeaker:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").SET_DOMINANT_SPEAKER,dominantSpeakerFBID:a})},setPinnedSpeaker:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").SET_PINNED_SPEAKER,pinnedSpeakerFBID:a})},initThread:function(a,c){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").INIT_THREAD,thread:a,participants:c})},onParticipantLeft:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_PARTICIPANT_LEFT,participantFBID:a})},onParticipantsAdded:function(a,c){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_PARTICIPANTS_ADDED,participants:a,images:c})},addParticipantsToRing:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ADD_PARTICIPANTS_TO_RING,participantFBIDs:a})},toggleRemoteStream:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").TOGGLE_REMOTE_STREAM,mediaStatus:a})},handleDismissRequest:function(a,c){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").DISMISS,transaction:a,request:c,endCallReason:b("RTCUtils").endCallReasonFromDismissRequest(c.dismissRequest())})},handleConferenceStateRequest:function(a,c,d,e){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_CONFERENCE_STATE,transaction:a,request:c,conferenceStateVersion:d,resolve:e})},onJoinRequestSent:function(){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_JOIN_REQUEST_SENT})},onReceivedJoinResponse:function(){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_RECEIVED_JOIN_RESPONSE})},onJoinResponse:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_JOIN_RESPONSE,serverInfoData:a})},onProcessedJoinResponse:function(){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_PROCESSED_JOIN_RESPONSE})},onServerMediaUpdateSuccess:function(){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_SERVER_MEDIA_UPDATE_SUCCESS})},onClientMediaUpdateResponse:function(a,c){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").ON_CLIENT_MEDIA_UPDATE_RESPONSE,responseStatusCode:a,currentVersion:c})}};e.exports=a}),null);
__d("RTCMWSessionDescription",["Promise","FBRTCConsoleLogger","FBRTCConstants","FBRTCMediaType","RTCCallStore","RTCGroupCallActions","RTCGroupCallDialogController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").SignalingProtocol;a={_videoEnabled:{},serverMediaUpdate:function(a,c){__p&&__p();var d=a.fromVersion,e=a.toVersion,f=a.mediaUpdates,h=b("RTCCallStore").getConnection(g.MULTIWAY);if(!h)return;var i=h.getLocalDescription(),j=h.getRemoteDescription(),k=j.sessionDescription.getVersion();if(k!==d){c(k);return}var l=function(){__p&&__p();f.forEach(function(a){j.processServerMediaUpdate(a),a.media.forEach(function(c){var d=c.type;c=c.enabled;d===b("FBRTCMediaType").VIDEO&&(this._videoEnabled[a.sourceKey]=c)}.bind(this))}.bind(this)),j.sessionDescription.setVersion(e),b("Promise").all([h.setLocalDescription(i),h.setRemoteDescription(j)]).then(function(){var a;b("RTCGroupCallActions").toggleRemoteStream((a=[]).concat.apply(a,f.map(function(a){a=a.media;return a})).reduce(function(a,b){var c=b.id;b=b.enabled;a[c]=b;return a},{}));c(e)},function(){return c(k)})["catch"](function(a){})}.bind(this),m=f.find(function(a){var c=a.sourceKey;a=a.media;return!this._videoEnabled[c]&&a.some(function(a){var c=a.type;a=a.enabled;return c===b("FBRTCMediaType").VIDEO&&a})}.bind(this));!b("RTCCallStore").getState().localUser.hasVideo()&&m?(function(){var a=m.sourceKey.split(":"),c=a[0];a=b("RTCCallStore").getState().remoteUsers.find(function(a){return a.FBID===c});b("RTCGroupCallDialogController").showVideoEscalationDialog(a.userName,l)})():l()}};e.exports=a}),null);
__d("MultiwayParticipantFetcher",["Promise","regeneratorRuntime","BonfireUserFetcher","immutable","ImmutableObject","MercuryIDs","MercuryParticipantsConstants","MessengerParticipants.bs","RTCUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("immutable").Set;b("immutable").Map;function g(a,c){var d=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,e){try{b("MessengerParticipants.bs").getBigImageMulti(d.toArray(),function(c){a(b("immutable").fromJS(c))},c)}catch(a){e(a)}})}function h(a){var c=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});return new(b("Promise"))(function(a,d){try{b("MessengerParticipants.bs").getMulti(c.toArray(),function(c){a(b("immutable").fromJS(c))})}catch(a){d(a)}})}function i(a,c){__p&&__p();var d,e=this,f,d;return b("regeneratorRuntime").async(function(i){__p&&__p();while(1)switch(i.prev=i.next){case 0:i.next=2;return b("regeneratorRuntime").awrap(h(a));case 2:f=i.sent;if(!c.profileImageSize){i.next=9;break}i.next=6;return b("regeneratorRuntime").awrap(function(){__p&&__p();var d;return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:e.next=2;return b("regeneratorRuntime").awrap(g(a,c.profileImageSize));case 2:d=e.sent;return e.abrupt("return",{v:f.withMutations(function(a){d.forEach(function(c,d){var e=a.get(d);if(e){e=b("ImmutableObject").setProperty(e,"big_image_src",c);a.set(d,e)}})})});case 4:case"end":return e.stop()}},null,e)}());case 6:d=i.sent;if(!(typeof d==="object")){i.next=9;break}return i.abrupt("return",d.v);case 9:return i.abrupt("return",f);case 10:case"end":return i.stop()}},null,this)}function j(a){__p&&__p();var c,d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:c=b("immutable").Set([a]);d=b("MercuryIDs").getParticipantIDFromUserID(a);f.next=4;return b("regeneratorRuntime").awrap(i(c,{profileImageSize:b("MercuryParticipantsConstants").WWW_INCALL_THUMBNAIL_SIZE}));case 4:e=f.sent;return f.abrupt("return",e.get(d));case 6:case"end":return f.stop()}},null,this)}a={fetchParticipant:function(a,c){__p&&__p();return b("regeneratorRuntime").async(function(d){__p&&__p();while(1)switch(d.prev=d.next){case 0:if(!b("RTCUtils").isBonfireCall(a)){d.next=6;break}d.next=3;return b("regeneratorRuntime").awrap(b("BonfireUserFetcher").fetchParticipant(c));case 3:return d.abrupt("return",d.sent);case 6:d.next=8;return b("regeneratorRuntime").awrap(j(c));case 8:return d.abrupt("return",d.sent);case 9:case"end":return d.stop()}},null,this)},fetchAllParticipants:function(a,c){__p&&__p();var d=arguments.length<=2||arguments[2]===undefined?{}:arguments[2];return b("regeneratorRuntime").async(function(e){__p&&__p();while(1)switch(e.prev=e.next){case 0:if(!b("RTCUtils").isBonfireCall(a)){e.next=6;break}e.next=3;return b("regeneratorRuntime").awrap(b("BonfireUserFetcher").fetchAllParticipants(c));case 3:return e.abrupt("return",e.sent);case 6:e.next=8;return b("regeneratorRuntime").awrap(i(c,d));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}},null,this)}};e.exports=a}),null);
__d("RTCMultiwayMessageHandler",["Arbiter","ChannelConstants","CurrentUser","FBRTCCallSummary","FBRTCCapability","FBRTCDeviceStatus","FBRTCHangupReason","FBRTCMultiwayMessage","FBRTCRtcResponseStatusCode","FBRTCTransactions","immutable","MultiwayParticipantFetcher","RTCCallActions","RTCCallStore","RTCGroupCallActions","RTCMWProtocolHandler","RTCMWSessionDescription","RTCUtils","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCTransactions").FBRTCServerTransaction,h=b("FBRTCTransactions").FBRTCTransactionOwner;function i(){this.$3=-1,this.$5()}i.prototype.initialize=function(a,b){this.$1=a,this.$2=b};i.initHandler=function(a,b){new i().initialize(a,b)};i.close=function(){i.$4&&(b("Arbiter").unsubscribe(i.$4),i.$4=null)};i.prototype.$5=function(){i.$4=b("Arbiter").subscribe([b("ChannelConstants").getArbiterType("rtc_live_json"),b("ChannelConstants").getArbiterType("rtc_multi_json")],function(a,b){this.$6(b.obj)}.bind(this))};i.prototype.$6=function(a){var c=this,d=new(b("FBRTCMultiwayMessage"))(a);if(!d.isRequest())return;this.$1===d.conferenceName()?this.$7(d):d.ringRequest()&&(function(){var a=new g(new h(),d);b("promiseDone")(a.start(),function(c){var e=b("RTCUtils").generateRandomInt(),f=new(b("FBRTCCallSummary"))({peerID:"MW_PEER_ID",callID:e,isCaller:!1});b("promiseDone")(a.sendResponse(this.$8(c,e,f)),function(){return b("RTCMWProtocolHandler").otherUserInAnotherCall(d.conferenceName(),d.serverInfoData(),b("FBRTCHangupReason").IN_ANOTHER_CALL,"InAnotherCall")})}.bind(c))})()};i.prototype.$8=function(a,c,d){d=a.ringRequest();var e=a.serverInfoData();if(d==null||e==null)return a.createResponse(b("FBRTCRtcResponseStatusCode").BAD_REQUEST,{});d={deviceCapabilities:[b("FBRTCCapability").SUPPORT_AUDIO_DEPRECATED,b("FBRTCCapability").SUPPORT_VIDEO_DEPRECATED],deviceStatus:b("FBRTCDeviceStatus").OK};return a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{ringResponse:d},callID:c.toString()})};i.prototype.$7=function(a){__p&&__p();var c=new g(new h(),a);b("promiseDone")(c.start().then(function(a){__p&&__p();var d=this;a!=null&&(function(){__p&&__p();var e=b("RTCCallStore").getState(),f=e.callInfo;a.dismissRequest()!=null?a.serverInfoData()===f.serverInfoData&&(b("RTCGroupCallActions").handleDismissRequest(c,a),i.close(),e.connections.forEach(function(a){return a.close()}),b("RTCCallActions").removeAllLocalStreams(!0)):a.serverMediaUpdateRequest()!=null?b("RTCMWSessionDescription").serverMediaUpdate(a.serverMediaUpdateRequest(),function(d){b("RTCGroupCallActions").onServerMediaUpdateSuccess(),c.sendResponse(a.createResponse(b("FBRTCRtcResponseStatusCode").OK,{body:{serverMediaUpdateResponse:{currentVersion:d}},callID:f.callID}))}):a.conferenceStateRequest()!=null&&(function(){__p&&__p();var e=b("RTCCallStore").getState();e=e.remoteUsers;var f=e.map(function(a){return a.FBID});e=Object.keys(a.conferenceStateRequest().participantStates);e=e.filter(function(a){return a!==b("CurrentUser").getID()&&!f.has(a)});e.length>0?b("promiseDone")(b("MultiwayParticipantFetcher").fetchAllParticipants(d.$1,b("immutable").Set(e),{profileImageSize:100}),function(d){b("RTCGroupCallActions").onParticipantsAdded(d.toJS()),b("RTCGroupCallActions").handleConferenceStateRequest(c,a,this.$3,function(a){this.$3=a}.bind(this))}.bind(d)):b("RTCGroupCallActions").handleConferenceStateRequest(c,a,d.$3,function(a){this.$3=a}.bind(d))})()})()}.bind(this)))};e.exports=i}),null);
__d("RTCP2PConnectionStatus",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CONNECTED:"CONNECTED",CONNECTING:"CONNECTING",CONTACTING:"CONTACTING",DISCONNECTED:"DISCONNECTED",INIT:"INIT",RECONNECTING:"RECONNECTING",RINGING:"RINGING"})}),null);
__d("RTCP2PCallWindowHandler",["RTCCallStore","RTCP2PCallStore","RTCP2PConnectionStatus"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=void 0;a={init:function(a){this._isWindowOpened()&&this.close(),g=a,this.updateCallInProgressIndicator(),this._monitorOpenerForChanges()},updateCallInProgressIndicator:function(a){if(!this._isWindowOpened())return;var c=b("RTCCallStore").getState();c=c.remoteUsers;a=a?a:b("RTCP2PCallStore").getState().connectionStatus;!c.count()||a===b("RTCP2PConnectionStatus").DISCONNECTED?g.rtcCallInProgessWith=null:g.rtcCallInProgessWith=c.first().FBID.toString()},reload:function(){this._isWindowOpened()&&g.location.reload()},close:function(){this._isWindowOpened()&&g.close()},_monitorOpenerForChanges:function(){if(g.opener)try{g.opener.addEventListener("unload",function(event){this._passWindowToOpener()}.bind(this))}catch(a){}},_passWindowToOpener:function(){var a=arguments.length<=0||arguments[0]===undefined?10:arguments[0];setTimeout(function(){if(!this._isWindowOpened()||a<=1)return;g.opener&&!g.opener.closed?g.opener.rtcCallChildWindow=g:this._passWindowToOpener(a-1)}.bind(this),1e3)},_isWindowOpened:function(){return!!(g&&!g.closed)}};e.exports=a}),null);
__d("RTCScreenSharingWindowHandler",["RTCP2PCallActions","RTCUtils","XScreenSharingController","promiseDone"],(function(a,b,c,d,e,f){__p&&__p();var g=540,h=960,i=void 0;a={open:function(a,c){i=window.open("about:blank","Screen Sharing",this._getWindowFeatures()),b("promiseDone")(b("RTCUtils").getStreamVideoResolution(c)["catch"](function(b){this._setupScreenSharingWindow(a,c,null)}.bind(this)),function(b){this._setupScreenSharingWindow(a,c,b)}.bind(this))},_setupScreenSharingWindow:function(a,b,c){__p&&__p();var d=this;window.getRemoteMediaStream=function(){return b};window.closeScreenSharingWindow=this._onUnload;c&&(function(){var a=d._getConstrainedSize(c.width,c.height),b=a.width,e=a.height;i.resizeTo(b,e);setTimeout(function(){this._adjustScreenSize({width:b,height:e})}.bind(d),200)})();i.location=this._getUnsignedUri(a);window.focus&&this.isWindowOpened()&&i.focus()},_adjustScreenSize:function(a){if(!i)return;i.resizeTo(a.width,a.height+(a.height-i.innerHeight))},close:function(){if(i){var a=null;i.opener&&!i.opener.closed&&(a=i.opener);i.close();i=null;a&&a.postMessage({recipient:"SC_CONTENT_SCRIPT",type:"SC_RESET_PORT",text:"reset comm port"},"*")}},isWindowOpened:function(){return!!(i&&!i.closed)},_onUnload:function(){b("RTCP2PCallActions").togglePopOutScreenContent()},_getWindowFeatures:function(){var a=screen.availLeft,b=screen.availTop,c=this._getConstrainedSize(Math.min(h,screen.width-a),Math.min(g,screen.height-b)),d=c.width;c=c.height;c={height:"height="+c.toString(),width:"width="+d.toString(),top:"top="+b.toString(),left:"left="+a.toString()};return["menubar=no","location=no","scrollbars=no","status=no","personalbar=no",c.height,c.width,c.top,c.left].join(",")},_getConstrainedSize:function(a,b){var c;a>h&&(c=h/a,b*=c,a*=c);b>g&&(c=g/b,a*=c,b*=c);return{width:a,height:b}},_getUnsignedUri:function(a){return b("XScreenSharingController").getURIBuilder().setFBID("peer_id",a).setInt("version",2).getURI()}};e.exports=a}),null);
__d("RTCP2PCallActions",["RTCAppDispatcher","RTCP2PCallActionTypes","RTCP2PCallWindowHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={reload:function(){b("RTCP2PCallWindowHandler").reload()},setCallType:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").SET_CALL_TYPE,callType:a})},setConnectionStatus:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").SET_CONNECTION_STATUS,connectionStatus:a})},setMultiwayEscalationSupport:function(a,c){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").SET_MULTIWAY_ESCALATION_SUPPORT,offerEscalationSupport:a,escalationConferenceName:c})},setRemoteSignalingExperiments:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").SET_REMOTE_SIGNALING_EXPERIMENTS,remoteSignalingExperiments:a})},togglePopOutScreenContent:function(a){b("RTCAppDispatcher").dispatch({type:a?b("RTCP2PCallActionTypes").POP_OUT_SCREEN_CONTENT:b("RTCP2PCallActionTypes").POP_IN_SCREEN_CONTENT,stream:a})},processMessage:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_PROCESS_MESSAGE,message:a})},setIsCaller:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_SET_IS_CALLER,isCaller:a})},starRatingDone:function(){var a=arguments.length<=0||arguments[0]===undefined?!0:arguments[0];b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_STAR_RATING_DONE,done:a})},setVideoQuality:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").SET_VIDEO_QUALITY,videoQuality:a})},toggleChatWindow:function(){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").TOGGLE_CHAT_WINDOW})}};e.exports=a}),null);
__d("FBRTCClientMediaUpdateReducer",["FBRTCConstants","FBRTCRtcResponseStatusCode","RTCCallStore","RTCCallActionTypes","RTCMWProtocolHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={configureAudio:function(a,c){switch(c.type){case b("RTCCallActionTypes").AUDIO_MUTED:return g(a,"audio",!1);case b("RTCCallActionTypes").AUDIO_UNMUTED:return g(a,"audio",!0)}return a},configureVideo:function(a,c){switch(c.type){case b("RTCCallActionTypes").VIDEO_MUTED:return g(a,"video",!1);case b("RTCCallActionTypes").VIDEO_UNMUTED:return g(a,"video",!0)}return a},onClientMediaUpdateResponse:function(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").ON_CLIENT_MEDIA_UPDATE_RESPONSE:if(c.responseStatusCode!==b("FBRTCRtcResponseStatusCode").OK)return a;a=a.setIn(["clientMediaUpdateInfo","lastSyncedClientVersion"],c.currentVersion);if(a.clientMediaUpdateInfo.pendingResponse){a=a.setIn(["clientMediaUpdateInfo","pendingResponse"],!1);if(a.clientMediaUpdateInfo.pendingUpdate)return h(a.setIn(["clientMediaUpdateInfo","pendingUpdate"],!1))}return a}return a}};function g(a,c,d){var e=b("RTCCallStore").getConnection(b("FBRTCConstants").SignalingProtocol.MULTIWAY);if(!e)return a;e=e.getLocalStreams()[0].getTracks().reduce(function(a,b){a[b.id]=b.kind===c?d:b.enabled;return a},{});return h(a.setIn(["clientMediaUpdateInfo","localMediaUpdates"],a.clientMediaUpdateInfo.localMediaUpdates.push({mediaStatus:e})))}function h(a){if(a.clientMediaUpdateInfo.pendingResponse)return a.setIn(["clientMediaUpdateInfo","pendingUpdate"],!0);var c=a.clientMediaUpdateInfo.localMediaUpdates.reduce(function(b,c,d){d>=a.clientMediaUpdateInfo.lastSyncedClientVersion&&b.push(c);return b},[]);if(c.length===0)return a;b("RTCMWProtocolHandler").clientMediaUpdate(b("RTCCallStore").getState().callInfo.conferenceName,b("RTCCallStore").getState().callInfo.serverInfoData,a.clientMediaUpdateInfo.lastSyncedClientVersion,a.clientMediaUpdateInfo.localMediaUpdates.size,c);return a.setIn(["clientMediaUpdateInfo","pendingResponse"],!0)}e.exports=a}),null);
__d("FBRTCGroupCallParticipantsReducer",["immutable","MercuryIDs","RTCCallStore","RTCCallActionTypes","RTCMWProtocolHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={_participantsToRing:new Set(),initThread:function(a,c){switch(c.type){case b("RTCCallActionTypes").INIT_THREAD:return a.merge({participants:c.participants,thread:c.thread})}return a},onParticipantsChanged:function(a,c){switch(c.type){case b("RTCCallActionTypes").ON_PARTICIPANT_LEFT:return a.set("participants",a.participants["delete"](b("MercuryIDs").getParticipantIDFromUserID(c.participantFBID)));case b("RTCCallActionTypes").ON_PARTICIPANTS_ADDED:var d=Object.keys(c.participants).map(function(a){return c.participants[a].fbid}).filter(function(a){return g._participantsToRing.has(a)});d.length!==0&&(d.forEach(function(a){return g._participantsToRing["delete"](a)}),b("RTCMWProtocolHandler").addParticipants(b("RTCCallStore").getState().callInfo.conferenceName,b("RTCCallStore").getState().callInfo.serverInfoData,d));return a.set("participants",a.participants.merge(b("immutable").Map(c.participants)))}return a},addParticipantsToRing:function(a,c){switch(c.type){case b("RTCCallActionTypes").ADD_PARTICIPANTS_TO_RING:c.participantFBIDs.forEach(function(a){return g._participantsToRing.add(a)});return a}return a}};e.exports=g}),null);
__d("FBRTCGroupCallReducer",["FBRTCConstants","FBRTCParticipantCallState","RTCCallStore","RTCEndCallReason","RTCCallActionTypes","RTCMWProtocolHandler"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").SignalingProtocol;a={setDominantSpeaker:function(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").SET_DOMINANT_SPEAKER:return a.set("dominantSpeakerFBID",c.dominantSpeakerFBID);case b("RTCCallActionTypes").SET_PINNED_SPEAKER:var d=b("RTCCallStore").getState();d=d.callInfo;var e=b("RTCCallStore").getConnection(g.MULTIWAY);if(!e)return a;b("RTCMWProtocolHandler").subscription(d.conferenceName,d.serverInfoData,e.getRemoteStreams(),a.layout,c.pinnedSpeakerFBID);return a.set("pinnedSpeakerFBID",c.pinnedSpeakerFBID);case b("RTCCallActionTypes").ON_CONFERENCE_STATE:d=c.request.conferenceStateRequest();e=d.participantStates;c=e[a.pinnedSpeakerFBID];return c&&c.state!==b("FBRTCParticipantCallState").CONNECTED?a.set("pinnedSpeakerFBID",null):a}return a},setLayout:function(a,c){switch(c.type){case b("RTCCallActionTypes").SET_LAYOUT:var d=b("RTCCallStore").getState();d=d.callInfo;var e=b("RTCCallStore").getConnection(g.MULTIWAY);e&&b("RTCMWProtocolHandler").subscription(d.conferenceName,d.serverInfoData,e.getRemoteStreams(),c.layout,a.pinnedSpeakerFBID);return a.set("layout",c.layout)}return a},processEndCallReason:function(a,c){switch(c.type){case b("RTCCallActionTypes").CALL_ERROR:case b("RTCCallActionTypes").HANGUP:case b("RTCCallActionTypes").END_CALL:case b("RTCCallActionTypes").DISMISS:return a.set("endCallReason",a.endCallReason||new(b("RTCEndCallReason"))(c.endCallReason))}return a}};e.exports=a}),null);
__d("RTCGroupCallEscalationStoreReducer",["FBRTCParticipantCallState","FunnelLogger","immutable","RTCCallActionTypes","RTCCallStore","RTCGroupCallEscalationActionTypes","RTCGroupCallEscalationStore","RTCMWProtocolHandler","RTCP2PCallStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=new Set([b("FBRTCParticipantCallState").UNKNOWN,b("FBRTCParticipantCallState").DISCONNECTED,b("FBRTCParticipantCallState").NO_ANSWER,b("FBRTCParticipantCallState").REJECTED,b("FBRTCParticipantCallState").UNREACHABLE,b("FBRTCParticipantCallState").CONNECTION_DROPPED,b("FBRTCParticipantCallState").PARTICIPANT_LIMIT_REACHED,b("FBRTCParticipantCallState").IN_ANOTHER_CALL,b("FBRTCParticipantCallState").RING_TYPE_UNSUPPORTED]);function a(a,c){switch(c.type){case b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_CANCEL:b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","aborted_escalation");return a.withMutations(function(a){a.set("aborted",!0).set("inProgress",!1).set("toRing",!1).set("readyToTransition",!1).set("usersToRing",null)})}return a}function c(a,c){switch(c.type){case b("RTCCallActionTypes").HANGUP:case b("RTCCallActionTypes").END_CALL:case b("RTCCallActionTypes").HANGUP_ERROR:case b("RTCCallActionTypes").HANGUP_SUCCESS:a.inProgress&&!a.readyToTransition&&b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","call_ended_during_escalation");return a.withMutations(function(a){a.set("aborted",!1).set("inProgress",!1).set("toRing",!1).set("usersToRing",null)})}return a}function d(a,c){switch(c.type){case b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_SET_P2P_CALLSUMMARY:var d=c.p2pCallSummary;if(d)return a.withMutations(function(a){a.set("p2pCallSummary",d)})}return a}function f(a,c){switch(c.type){case b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_START:return a.set("inProgress",!0)}return a}function h(a,c){if(!a.readyToTransition&&a.inProgress)switch(c.type){case b("RTCCallActionTypes").ON_JOIN_REQUEST_SENT:b("RTCGroupCallEscalationStore").logToP2PCallSummary(function(a){return a.setEscalationConnectingToMultiway()});break;case b("RTCCallActionTypes").ON_JOIN_RESPONSE:b("RTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationConnectedToMultiway(),c.serverInfoData&&a.setServerInfoData(c.serverInfoData)});break}return a}function i(a,c){__p&&__p();if(!a.readyToTransition&&a.inProgress)switch(c.type){case b("RTCCallActionTypes").ON_CONFERENCE_STATE:var d=c.request.conferenceStateRequest();if(d){c=function(){__p&&__p();var c=d.participantStates,e=a.toRing,f=!1,h=Object.keys(c).every(function(a){return c[a].state===b("FBRTCParticipantCallState").CONNECTED});if(h){b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","transition_to_group_call");b("RTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationPeerConnectedToMultiway(),a.setEscalationConnectedToMultiway(),a.setReadyToEscalate()});var i=b("RTCP2PCallStore").getState();i=i.protocolHandler;i.shutDownP2PListenersForMultiwayEscalation();if(a.usersToRing&&e){i=a.usersToRing.valueSeq().map(function(a){return a.fbid}).filter(Boolean).toArray();b("RTCMWProtocolHandler").addParticipants(b("RTCCallStore").getState().callInfo.conferenceName,b("RTCCallStore").getState().callInfo.serverInfoData,i);e=!1}}else f=Object.keys(c).some(function(a){return g.has(c[a].state)}),f&&(b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","entered_bad_escalation_state_and_aborted"),b("RTCGroupCallEscalationStore").logToP2PCallSummary(function(a){return a.setInvalidP2PEscalationState()}));return{v:a.set("aborted",f).set("readyToTransition",h).set("toRing",e)}}();if(typeof c==="object")return c.v}}return a}function j(a,c){switch(c.type){case b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_SET_USERS_TO_RING:if(c.usersToRing)return a.set("usersToRing",c.usersToRing).set("toRing",!0)}return a}e.exports={abortEscalation:a,callStart:f,clearStore:c,onMultiwayConnectionSignaling:h,onParticipantsConnected:i,setP2PCallSummary:d,setUsersToRing:j}}),null);
__d("RTCCallType",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({AUDIO_ONLY:"AUDIO_ONLY",VIDEO_ONLY:"VIDEO_ONLY",AUDIO_VIDEO:"AUDIO_VIDEO",NO_AUDIO_VIDEO:"NO_AUDIO_VIDEO"});e.exports=a}),null);
__d("RTCP2PCallEscalationStoreReducers",["FBRTCVideoEscalationStore","RTCCallType","RTCP2PCallActionTypes","RTCP2PCallEscalationActionTypes","RTCP2PCallEscalator","RTCP2PCallStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCVideoEscalationStore").CallType;a=function(a,c){__p&&__p();switch(c.type){case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_START:if(a.inProgress)return a;return a.escalated||!b("RTCP2PCallStore").isAudioOnly()?a:a.withMutations(function(a){a.set("awaitingACK",!0).set("initiatedEscalation",!0).set("failureReason",null).set("inProgress",!0).set("token",b("RTCP2PCallStore").getState().protocolHandler.generateEscalationRequestToken(!0))});case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SUCCESS:if(!a.inProgress)return a;else if("token"in c&&c.token!==a.token)return a;return a.withMutations(function(a){a.set("awaitingACK",!1).set("callType",g.escalated).set("escalated",!0).set("inProgress",!1).set("request",null).set("response",!0).set("token",null)});case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE:if(!a.inProgress)return a;else if("token"in c&&c.token!==a.token)return a;if(c.reason==="denied")return a.withMutations(function(a){a.set("awaitingACK",!1).set("initiatedEscalation",!1).set("callType",g.escalation_declined).set("escalated",!1).set("failureReason",c.reason||null).set("inProgress",!1).set("request",null).set("response",c.response||null).set("token",null)});b("RTCP2PCallStore").getState().protocolHandler.generateEscalationRequestToken(!1);return a.withMutations(function(a){a.set("awaitingACK",!1).set("inProgress",!1).set("initiatedEscalation",!1).set("callType",g.escalation_declined).set("escalated",!1).set("failureReason",c.reason).set("token",null)});default:return a}};c=function(a,c){__p&&__p();switch(c.type){case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_REQUEST:var d=c.request;if(d==null)return a;return!b("RTCP2PCallEscalator").requestVideoOn(d.msg)?a.withMutations(function(a){a.set("awaitingACK",!1).set("inProgress",!1).set("request",null).set("response",null).set("token",null)}):a.withMutations(function(a){a.set("inProgress",!0).set("request",c.request).set("response",null).set("token",null)});case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_RESPONSE:if(c.response==null)return a;else if(a.request==null)return a;return a.withMutations(function(a){a.set("awaitingACK",!0).set("callType",c.response?g.escalated:g.escalation_declined).set("response",c.response).set("token",b("RTCP2PCallStore").getState().protocolHandler.generateEscalationResponseToken(a.request,c.response))});case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_ACK:if(c.token==null)return a;return a.response==null||a.request==null||c.token!==a.token||!a.awaitingACK?a:a.withMutations(function(a){a.set("awaitingACK",!1).set("callType",a.response?g.escalated:g.escalation_declined).set("escalated",a.response).set("inProgress",!1).set("request",null).set("response",null).set("token",null)});default:return a}};d=function(a,c){__p&&__p();switch(c.type){case b("RTCP2PCallActionTypes").SET_CALL_TYPE:switch(c.callType){case b("RTCCallType").AUDIO_VIDEO:case b("RTCCallType").VIDEO_ONLY:return a.set("callType",g.direct_video)}return a;case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_ACK:if(c.token==null)return a;if(!a.awaitingACK)return a;else if(c.token!==a.token)return a;return a.set("awaitingACK",!1);default:return a}};e.exports={Alice:a,Bob:c,common:d}}),null);
__d("RTCP2PCallReducer",["FBRTCConsoleLogger","RTCAppDispatcher","RTCCallActionTypes","RTCCallStore","RTCCallType","RTCP2PCallActionTypes","RTCP2PCallEscalationActionTypes","RTCP2PCallEscalationStore","RTCP2PCallWindowHandler","RTCP2PConnectionStatus","RTCP2PProtocolHandler","RTCScreenSharingWindowHandler","RTCSignalingExperiments"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").RESET:b("RTCAppDispatcher").waitFor([b("RTCCallStore").getDispatchToken()]);var d=b("RTCCallStore").getState().remoteUsers.first();if(d==null)return a;a.protocolHandler.destroy();var e=new(b("RTCP2PProtocolHandler"))();e.init(d.FBID,Number(c.conferenceName));return a.set("connectionStatus",b("RTCP2PConnectionStatus").INIT).set("endCallReason",null).set("protocolHandler",e).set("signalingExperiments",new(b("RTCSignalingExperiments"))());default:return a}}function c(a,c){switch(c.type){case b("RTCCallActionTypes").HANGUP:case b("RTCCallActionTypes").DISMISS:case b("RTCCallActionTypes").HANGUP_ERROR:case b("RTCCallActionTypes").HANGUP_SUCCESS:case b("RTCCallActionTypes").END_CALL:case b("RTCCallActionTypes").REMOVE_REMOTE_SCREEN_STREAM:case b("RTCCallActionTypes").RESET:b("RTCScreenSharingWindowHandler").close();return a.set("isScreenContentPoppedOut",b("RTCScreenSharingWindowHandler").isWindowOpened());default:return a}}function d(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_CALL_TYPE:return a.set("callType",c.callType);case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_RESPONSE:b("RTCAppDispatcher").waitFor([b("RTCP2PCallEscalationStore").getDispatchToken()]);return a.set("callType",c.response?b("RTCCallType").AUDIO_VIDEO:b("RTCCallType").AUDIO_ONLY);case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE:return a.set("callType",b("RTCCallType").AUDIO_ONLY);case b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SUCCESS:b("RTCAppDispatcher").waitFor([b("RTCP2PCallEscalationStore").getDispatchToken()]);return b("RTCP2PCallEscalationStore").isEscalated()?a.set("callType",b("RTCCallType").AUDIO_VIDEO):a;default:return a}}function f(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_CONNECTION_STATUS:if(a.connectionStatus!==c.connectionStatus){b("RTCP2PCallWindowHandler").updateCallInProgressIndicator(c.connectionStatus);return a.set("connectionStatus",c.connectionStatus)}default:return a}}function g(a,c){switch(c.type){case b("RTCCallActionTypes").SET_END_CALL_REASON:return a.set("endCallReason",c.endCallReason);default:return a}}function h(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_MULTIWAY_ESCALATION_SUPPORT:a=a.set("offerEscalationSupport",c.offerEscalationSupport);c.escalationConferenceName&&(a=a.set("escalationConferenceName",c.escalationConferenceName));return a;default:return a}}function i(a,c){switch(c.type){case b("RTCP2PCallActionTypes").POP_IN_SCREEN_CONTENT:b("RTCScreenSharingWindowHandler").close();return a.set("isScreenContentPoppedOut",b("RTCScreenSharingWindowHandler").isWindowOpened());case b("RTCP2PCallActionTypes").POP_OUT_SCREEN_CONTENT:var d=b("RTCCallStore").getState().remoteUsers.first().FBID;b("RTCScreenSharingWindowHandler").open(d,c.stream);return a.set("isScreenContentPoppedOut",b("RTCScreenSharingWindowHandler").isWindowOpened());default:return a}}function j(a,c){switch(c.type){case b("RTCP2PCallActionTypes").TOGGLE_CHAT_WINDOW:return a.set("chatWindowVisible",!a.chatWindowVisible);default:return a}}function k(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_REMOTE_SIGNALING_EXPERIMENTS:return a.set("signalingExperiments",a.signalingExperiments.setRemote(c.remoteSignalingExperiments));default:return a}}function l(a,c){switch(c.type){case b("RTCP2PCallActionTypes").P2P_PROCESS_MESSAGE:return a.set("isRemoteVideoSupported",c.message.isRemoteVideoSupported()).set("isPeerOnMobile",c.message.isFromMobile());default:return a}}function m(a,c){switch(c.type){case b("RTCP2PCallActionTypes").P2P_SET_IS_CALLER:return a.set("isCaller",c.isCaller);default:return a}}function n(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_CONNECTION_STATUS:return c.connectionStatus===b("RTCP2PConnectionStatus").CONNECTED?a.set("wasConnected",!0):a;case b("RTCCallActionTypes").RESET:return a.set("wasConnected",!1);default:return a}}function o(a,c){switch(c.type){case b("RTCP2PCallActionTypes").P2P_STAR_RATING_DONE:return a.set("wasStarRatingDone",c.done);case b("RTCCallActionTypes").RESET:return a.set("wasStarRatingDone",!1);default:return a}}function p(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_VIDEO_QUALITY:return a.set("videoQuality",c.videoQuality);default:return a}}e.exports={callInit:a,callEnd:c,processCallType:d,processChatWindowToggle:j,processConnectionStatus:f,processEndCallReason:g,processIsCaller:m,processMessage:l,processMultiwayEscalationSupport:h,processPoppedOutScreenContent:i,processSignalingExperiments:k,processVideoQuality:p,processWasConnected:n,processWasStarRatingDone:o}}),null);
__d("RTCStreamDurationTracker",["performanceNow"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){var a=arguments.length<=0||arguments[0]===undefined?"mixed":arguments[0];this.$3=0;this.$4=0;this.$5=!1;this.update=function(){if(!this.$5)return;this.$6()?this.$4===0&&(this.$4=b("performanceNow")()):this.pause(this.$2)}.bind(this);this.$1=a}a.prototype.isStarted=function(){return this.$5};a.prototype.track=function(a){__p&&__p();if(a===this.$2){this.update();return}if(this.$2&&this.$5){var b=this.$2;b.removeEventListener("addtrack",this.update);b.removeEventListener("removetrack",this.update)}a?(this.$5&&this.$6()&&(this.$3=this.getDuration()),this.$2=a,this.$5&&this.start()):this.stop()};a.prototype.$6=function(){return!this.$2?!1:this.$7().some(function(a){return a.enabled})};a.prototype.$7=function(){if(!this.$2)return[];switch(this.$1){case"audio":return this.$2.getAudioTracks();case"video":return this.$2.getVideoTracks();case"screen":return this.$2.getVideoTracks();default:return this.$2.getTracks()}};a.prototype.pause=function(a){if(!this.$5)return;if(this.$2!==a)return;this.$3=this.getDuration();this.$4=0};a.prototype.getDuration=function(){return this.$4===0?this.$3:this.$3+b("performanceNow")()-this.$4};a.prototype.start=function(){this.$5=!0;this.$6()&&(this.$4=b("performanceNow")());if(this.$2){var a=this.$2;a.addEventListener("addtrack",this.update);a.addEventListener("removetrack",this.update)}};a.prototype.stop=function(){__p&&__p();if(!this.$5)return;this.$3=this.getDuration();this.$5=!1;this.$4=0;if(this.$2){var a=this.$2;a.removeEventListener("addtrack",this.update);a.removeEventListener("removetrack",this.update)}};e.exports=a}),null);
__d("FBRTCGroupCallStoreState",["immutable","RTCStreamDurationTracker"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;d={localVideoDurationTracker:new(b("RTCStreamDurationTracker"))("video"),remoteVideoDurationTracker:new(b("RTCStreamDurationTracker"))("video"),localScreenDurationTracker:new(b("RTCStreamDurationTracker"))("screen")};g=babelHelpers.inherits(a,b("immutable").Record(d));g&&g.prototype;function a(){g.apply(this,arguments)}f={dominantSpeakerFBID:null,endCallReason:null,layout:null,participants:null,pinnedSpeakerFBID:null,thread:null,videoDurationTrackerInfo:new a()};h=babelHelpers.inherits(c,b("immutable").Record(f));h&&h.prototype;function c(){h.apply(this,arguments)}e.exports=c}),null);
__d("FBRTCVideoDurationTrackerReducer",["FBRTCCallSummaryStore","RTCCallStore","RTCCallActionTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={track:function(a,c){__p&&__p();var d=a.videoDurationTrackerInfo,e=d.localVideoDurationTracker,f=d.remoteVideoDurationTracker;d=d.localScreenDurationTracker;switch(c.type){case b("RTCCallActionTypes").ADD_LOCAL_SCREEN_STREAM:d.track(c.stream),d.isStarted()||d.start();case b("RTCCallActionTypes").ADD_LOCAL_STREAM:e.track(c.stream);e.isStarted()||e.start();return a;case b("RTCCallActionTypes").REMOVE_LOCAL_SCREEN_STREAM:d.pause(c.stream);return a;case b("RTCCallActionTypes").REPLACE_LOCAL_SCREEN_STREAM:d.track(c.newStream);e.track(c.newStream);return a;case b("RTCCallActionTypes").ADD_REMOTE_STREAM:case b("RTCCallActionTypes").TOGGLE_REMOTE_STREAM:d=b("RTCCallStore").getState();e=d.remoteUsers;c=e.find(function(a){return!a.isVideoMuted()});f.stop();f.start();f.track(c&&c.streams.first());return a}return a},update:function(a,c){switch(c.type){case b("RTCCallActionTypes").VIDEO_MUTED:case b("RTCCallActionTypes").VIDEO_UNMUTED:a.videoDurationTrackerInfo.localVideoDurationTracker.update()}return a},stop:function(a,c){__p&&__p();switch(c.type){case b("RTCCallActionTypes").DISMISS:case b("RTCCallActionTypes").END_CALL:case b("RTCCallActionTypes").HANGUP:c=a.videoDurationTrackerInfo;var d=b("RTCCallStore").getState();d=d.callSummary;c.localVideoDurationTracker.stop();c.remoteVideoDurationTracker.stop();c.localScreenDurationTracker.stop();d.setVideoDurations(c.localVideoDurationTracker.getDuration(),c.remoteVideoDurationTracker.getDuration());d.setScreenDuration(c.localScreenDurationTracker.getDuration());d.save(b("FBRTCCallSummaryStore").getInstance());return a}return a}};e.exports=a}),null);
__d("FBRTCGroupCallStore",["FBRTCGroupCallParticipantsReducer","FBRTCGroupCallReducer","FBRTCGroupCallStoreState","FBRTCVideoDurationTrackerReducer","FluxReduceStore","RTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("FBRTCGroupCallParticipantsReducer").addParticipantsToRing,b("FBRTCGroupCallParticipantsReducer").initThread,b("FBRTCGroupCallParticipantsReducer").onParticipantsChanged,b("FBRTCGroupCallReducer").processEndCallReason,b("FBRTCGroupCallReducer").setDominantSpeaker,b("FBRTCGroupCallReducer").setLayout,b("FBRTCVideoDurationTrackerReducer").track,b("FBRTCVideoDurationTrackerReducer").update,b("FBRTCVideoDurationTrackerReducer").stop];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("FBRTCGroupCallStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("FBRTCMWProtocolStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h;d={pendingResponse:!1,pendingUpdate:!1,lastSyncedClientVersion:2,localMediaUpdates:b("immutable").List([{mediaStatus:{}},{mediaStatus:{}}])};g=babelHelpers.inherits(a,b("immutable").Record(d));g&&g.prototype;function a(){g.apply(this,arguments)}f={clientMediaUpdateInfo:new a()};h=babelHelpers.inherits(c,b("immutable").Record(f));h&&h.prototype;function c(){h.apply(this,arguments)}e.exports=c}),null);
__d("FBRTCMWProtocolStore",["FBRTCClientMediaUpdateReducer","FBRTCMWProtocolStoreState","FluxReduceStore","RTCAppDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("FBRTCClientMediaUpdateReducer").configureAudio,b("FBRTCClientMediaUpdateReducer").configureVideo,b("FBRTCClientMediaUpdateReducer").onClientMediaUpdateResponse];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("FBRTCMWProtocolStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("RTCGroupCallEscalationStoreState",["FBRTCCallSummary","immutable"],(function(a,b,c,d,e,f){var g;g=babelHelpers.inherits(a,b("immutable").Record({aborted:!1,inProgress:!1,toRing:!1,p2pCallSummary:null,readyToTransition:!1,usersToRing:null}));g&&g.prototype;function a(){"use strict";g.apply(this,arguments)}e.exports=a}),null);
__d("RTCGroupCallEscalationStore",["FBRTCCallSummaryStore","FluxReduceStore","FunnelLogger","RTCAppDispatcher","RTCGroupCallEscalationStoreReducer","RTCGroupCallEscalationStoreState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("RTCGroupCallEscalationStoreReducer").abortEscalation,b("RTCGroupCallEscalationStoreReducer").callStart,b("RTCGroupCallEscalationStoreReducer").clearStore,b("RTCGroupCallEscalationStoreReducer").onMultiwayConnectionSignaling,b("RTCGroupCallEscalationStoreReducer").onParticipantsConnected,b("RTCGroupCallEscalationStoreReducer").setP2PCallSummary,b("RTCGroupCallEscalationStoreReducer").setUsersToRing];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("RTCGroupCallEscalationStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.prototype.isInProgress=function(){return this.getState().inProgress};a.prototype.isEscalated=function(){return this.getState().readyToTransition};a.prototype.logToP2PCallSummary=function(a){var c=this.getState();c=c.p2pCallSummary;c?(a(c),c.save(b("FBRTCCallSummaryStore").getInstance())):b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","p2pCallSummary_not_found")};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("RTCP2PCallEscalationStore",["FBRTCConfig","FluxReduceStore","MessengerRTCFunnelLogger","RTCAppDispatcher","RTCP2PCallEscalationStoreReducers","RTCP2PCallEscalationStoreState","RTCP2PCallStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("RTCP2PCallEscalationStoreReducers").Alice,b("RTCP2PCallEscalationStoreReducers").Bob,b("RTCP2PCallEscalationStoreReducers").common,b("MessengerRTCFunnelLogger").logRTCCallEscalationAction];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("RTCP2PCallEscalationStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.prototype.didCurrentUserInitiate=function(){return this.getState().initiatedEscalation};a.prototype.isInProgress=function(){return this.getState().inProgress};a.prototype.isEscalated=function(){return this.getState().escalated};a.prototype.isNegotiationAllowed=function(){var a=this.getState();return b("RTCP2PCallStore").getState().isPeerOnMobile||!b("FBRTCConfig").canPeerUseV2()||!a.request};a.prototype.isStarted=function(){var a=this.getState();return a.inProgress&&a.token!==null};a.prototype.getToken=function(){return this.getState().token};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("RTCP2PCallAdminMessageReducers",["FBRTCAdminMessage","FBRTCCallConstants","RTCAppDispatcher","RTCCallStore","RTCCallType","RTCCallActionTypes","RTCP2PCallActionTypes","RTCP2PConnectionStatus"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCCallConstants").FBRTCCallType;function a(a,c){switch(c.type){case b("RTCCallActionTypes").SET_CALL_SUMMARY:b("RTCAppDispatcher").waitFor([b("RTCCallStore").getDispatchToken()]);c=b("RTCCallStore").getState();c=c.callSummary;return a.set("adminMessage",new(b("FBRTCAdminMessage"))(c.peerID,c.callID));default:return a}}function c(a,c){switch(c.type){case b("RTCP2PCallActionTypes").SET_CONNECTION_STATUS:var d=a.adminMessage;d&&c.connectionStatus===b("RTCP2PConnectionStatus").CONNECTED&&d.onCallConnected();return a;default:return a}}function d(a,c){switch(c.type){case b("RTCCallActionTypes").SET_END_CALL_REASON:var d=a.adminMessage;d&&(d.onCallEnded(),a.isCaller&&d.submit(a.callType===b("RTCCallType").AUDIO_ONLY?g.VOICE_CALL:g.VIDEO_CALL,c.endCallReason.getReasonID()));return a;default:return a}}e.exports={processCallInit:a,processCallStart:c,processCallEnd:d}}),null);
__d("RTCP2PCallStore",["FluxReduceStore","RTCAppDispatcher","RTCCallType","RTCP2PCallAdminMessageReducers","RTCP2PCallReducer","RTCP2PCallStoreState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("RTCP2PCallReducer").callEnd,b("RTCP2PCallReducer").callInit,b("RTCP2PCallReducer").processCallType,b("RTCP2PCallReducer").processChatWindowToggle,b("RTCP2PCallReducer").processConnectionStatus,b("RTCP2PCallReducer").processEndCallReason,b("RTCP2PCallReducer").processPoppedOutScreenContent,b("RTCP2PCallReducer").processMultiwayEscalationSupport,b("RTCP2PCallReducer").processSignalingExperiments,b("RTCP2PCallReducer").processMessage,b("RTCP2PCallReducer").processIsCaller,b("RTCP2PCallReducer").processVideoQuality,b("RTCP2PCallReducer").processWasConnected,b("RTCP2PCallReducer").processWasStarRatingDone,b("RTCP2PCallAdminMessageReducers").processCallInit,b("RTCP2PCallAdminMessageReducers").processCallStart,b("RTCP2PCallAdminMessageReducers").processCallEnd];g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return new(b("RTCP2PCallStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.prototype.isAudioOnly=function(){return this.getState().callType===b("RTCCallType").AUDIO_ONLY};a.prototype.isCaller=function(){return this.getState().isCaller};a.prototype.isChatWindowVisible=function(){return this.getState().chatWindowVisible};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("RTCP2PCallStoreState",["immutable","RTCCallType","RTCP2PConnectionStatus","RTCP2PProtocolHandler","RTCSignalingExperiments"],(function(a,b,c,d,e,f){"use strict";var g;c={adminMessage:null,callType:b("RTCCallType").AUDIO_ONLY,chatWindowVisible:!1,connectionStatus:b("RTCP2PConnectionStatus").INIT,endCallReason:null,escalationConferenceName:null,isCaller:!1,isPeerOnMobile:!1,isRemoteVideoSupported:!0,isScreenContentPoppedOut:!1,offerEscalationSupport:!1,protocolHandler:new(b("RTCP2PProtocolHandler"))(),signalingExperiments:new(b("RTCSignalingExperiments"))(),videoQuality:b("RTCP2PProtocolHandler").getDefaultVideoQuality(),wasConnected:!1,wasStarRatingDone:!1};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("RTCGroupCallEscalationActions",["immutable","RTCAppDispatcher","RTCGroupCallEscalationActionTypes"],(function(a,b,c,d,e,f){"use strict";a={start:function(){b("RTCAppDispatcher").dispatch({type:b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_START})},cancel:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_CANCEL,p2pCallSummary:a})},approve:function(){b("RTCAppDispatcher").dispatch({type:b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_SUCCESS})},setUsersToRing:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_SET_USERS_TO_RING,usersToRing:a})},setP2PCallSummary:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCGroupCallEscalationActionTypes").GROUP_ESCALATION_SET_P2P_CALLSUMMARY,p2pCallSummary:a})}};e.exports=a}),null);
__d("RTCGroupCallEscalator",["CurrentUser","FBRTCConsoleLogger","FBRTCConstants","FBRTCGroupCallStore","FBRTCMWProtocolStore","FBRTCScreenSharingUtils","FunnelLogger","immutable","MercuryIDs","MessengerParticipants.bs","RTCAppDispatcher","RTCCallStore","RTCGroupCallActions","RTCGroupCallEscalationActions","RTCGroupCallEscalationStore","RTCMWProtocolHandler","RTCUtils"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").GroupVideoViewLayout,h=45e3;function a(a,c,d,e){this.$11=null,this.$4=a,this.$5=c,this.$9=d,this.$1=String(e),b("RTCGroupCallEscalationActions").setP2PCallSummary(b("RTCCallStore").getState().callSummary),this.$10=[d],this.$13=null,b("FunnelLogger").addFunnelTag("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL",c?"video":"audio")}a.prototype.getParticipants=function(){return this.$13};a.prototype.$14=function(){return setTimeout(function(){b("RTCGroupCallEscalationStore").getState().readyToTransition||(i("Group Escalation timed out"),b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","escalation_timed_out"),b("RTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setEscalationTimedOut(),b("RTCGroupCallEscalationActions").cancel(a)}))},h)};a.prototype.startEscalationToMultiway=function(){__p&&__p();i("Escalating P2P call to Multiway call %o",this.$4);b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","starting_escalation_process");var a=b("RTCGroupCallEscalationStore").getState().inProgress;if(a)return;b("RTCGroupCallEscalationActions").start();this.$3=this.$14();this.$12=new(b("RTCMWProtocolHandler"))();b("RTCAppDispatcher").explicitlyRegisterStores([b("FBRTCGroupCallStore"),b("FBRTCMWProtocolStore")]);b("RTCGroupCallActions").setLayout(g.GRID);var c=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());b("MessengerParticipants.bs").get(c,function(a){var d={};d[c]=a;a=b("immutable").Map(d);this.$13=a;b("RTCGroupCallActions").initThread(null,a);this.$15()}.bind(this))};a.prototype.$15=function(){var a=b("RTCCallStore").getState().localUser.getStream(),c=b("RTCCallStore").getState().localUser.getScreenStream(),d=a;c&&b("FBRTCScreenSharingUtils").isGroupCallScreenSharingSupported()&&(a&&b("RTCUtils").transferAudioTracks(c,a),d=c);d&&this.$12.onStreamReady(d,this.$10,this.$4,!0,{callTrigger:"multiway_escalation",p2pCallID:this.$1})};a.ESCALATION_TIMEOUT=h;function i(){}e.exports=a}),null);
__d("RTCP2PCallEscalationActions",["RTCAppDispatcher","RTCCallActionTypes","RTCP2PCallEscalationActionTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={start:function(){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_START})},setRequest:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_REQUEST,request:a})},cancel:function(){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE,reason:"cancelled"})},timeout:function(){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE,reason:"timeout"})},handleACK:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_ACK,token:a})},approve:function(){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SUCCESS})},decline:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE,reason:"denied",token:a,response:!1})},setResponse:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SET_RESPONSE,response:a})},parseResponse:function(a,c){a?b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_SUCCESS,token:c}):b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallEscalationActionTypes").P2P_CALL_ESCALATION_FAILURE,reason:"denied",token:c,response:!1})},muteRemoteVideo:function(){b("RTCAppDispatcher").dispatch({type:b("RTCCallActionTypes").REMOTE_VIDEO_MUTED})}};e.exports=a}),null);
__d("RTCP2PCallEscalator",["FBRTCCallSummaryStore","FBRTCConsoleLogger","FBRTCConstants","RTCCallStore","RTCP2PCallEscalationActions","RTCP2PCallEscalationStore","dangerouslyBypassDispatchError"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=b("FBRTCConstants").PayloadType,h=25e3;i.isEscalated=function(){return b("RTCP2PCallEscalationStore").isEscalated()};i.isNegotiationAllowed=function(){return b("RTCP2PCallEscalationStore").isNegotiationAllowed()};function i(a,b,c){this.$3=a,this.$1=b,this.$2=c,this.$6()}i.prototype.$6=function(){__p&&__p();var a=b("RTCP2PCallEscalationStore").getState();this.$4=b("RTCP2PCallEscalationStore").addListener(function(){__p&&__p();var c=b("RTCP2PCallEscalationStore").getState();if(c===a)return;!c.awaitingACK&&c.awaitingACK!==a.awaitingACK&&!c.inProgress&&clearTimeout(this.$5);if(c.callType!==a.callType){var d=b("RTCCallStore").getState();d=d.callSummary;d.setCallType(c.callType);d.save(b("FBRTCCallSummaryStore").getInstance())}a=c}.bind(this))};i.prototype.destroy=function(){j("P2P Escalator %o","destroy"),this.$4.remove(),clearTimeout(this.$5)};i.prototype.generateRequestToken=function(a){__p&&__p();var c=b("RTCP2PCallEscalationStore").getState();c=c.token;if(c!=null&&a){j("P2P Escalator %o","request token","reuse");return c}j("P2P Escalator %o","request token");c=this.$2.sendVideoEscalationRequest(this.$3,this.$1,a);clearTimeout(this.$5);this.$5=this.$7();return c.msg_id.toString()};i.prototype.generateResponseToken=function(a,c){__p&&__p();var d=b("RTCP2PCallEscalationStore").getState();d=d.token;if(d!=null){j("P2P Escalator %o","response token","reuse");return d}j("P2P Escalator %o %o %o","response token",c,a);d=a.peerID;var e=a.callID;a=a.msgID;d=this.$2.sendVideoRequestResponse(d,e,a,c);clearTimeout(this.$5);var f=d.msg_id.toString();!c?b("dangerouslyBypassDispatchError")(function(){return b("RTCP2PCallEscalationActions").decline(f)}):this.$5=this.$7();return f};i.prototype.$7=function(){return setTimeout(b("RTCP2PCallEscalationActions").timeout,h)};i.prototype.parseMessage=function(a){j("P2P Escalator %o","parse message",this.$3,a.msgType);switch(a.msgType){case g.VIDEO_REQUEST:a.ackID?this.$8(a):this.$9(a);break;case g.ACK:a.msg.ack_type===g.VIDEO_REQUEST&&b("RTCP2PCallEscalationActions").handleACK(a.ackID.toString());break}};i.prototype.$8=function(a){j("P2P Escalator %o","parse response",a);var c=a.ackID.toString();b("RTCP2PCallEscalationStore").getToken()===c&&this.$10(a);b("RTCP2PCallEscalationActions").parseResponse(i.requestVideoOn(a.msg),c);clearTimeout(this.$5)};i.prototype.$9=function(a){__p&&__p();j("P2P Escalator %o","parse request",a);if(b("RTCP2PCallEscalationStore").isInProgress()&&!i.requestVideoOn(a.msg)){b("RTCP2PCallEscalationStore").didCurrentUserInitiate()?b("RTCP2PCallEscalationActions").cancel():(this.$10(a),b("RTCP2PCallEscalationActions").setRequest(a));return}if(b("RTCP2PCallEscalationStore").isInProgress()&&b("RTCP2PCallEscalationStore").didCurrentUserInitiate()){j("P2P Escalator %o","auto-approve","mutual consent");b("RTCP2PCallEscalationActions").approve();this.$10(a);this.generateResponseToken(a,!0);return}if(b("RTCP2PCallEscalationStore").isEscalated()){i.requestVideoOn(a.msg)?(j("P2P Escalator %o","auto-approve"),this.$10(a),this.generateResponseToken(a,!0),clearTimeout(this.$5)):(j("P2P Escalator %o","mute remote video"),b("RTCP2PCallEscalationActions").muteRemoteVideo());return}j("P2P Escalator %o %o","request",a);this.$10(a);b("RTCP2PCallEscalationActions").setRequest(a)};i.prototype.$10=function(a){var b=a.peerID,c=a.callID;a=a.msg;j("P2P Escalator %o","ACK","sent");this.$2.sendAck(b,c,a)};i.requestVideoOn=function(a){var b=a.reqVideoOn;a=a.videoon;return Boolean(b||a)};i.ACK_TIMEOUT=h;function j(){}e.exports=i}),null);
__d("FBRTCGroupCallVideoEscalationDialog.react",["fbt","FBRTCConstants","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","React","RTCGroupCallActions","RTCMWProtocolHandler"],(function(a,b,c,d,e,f,g){"use strict";b("FBRTCConstants").CallType;a=function(a){var c=a.userName,d=a.onToggle;return b("React").createElement(b("MessengerDialog.react"),{onToggle:d},b("React").createElement(b("MessengerDialogBody.react"),null,g._("{name} added video chat. Would you like to share your video?",[g._param("name",c)])),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogCancelButton.react"),null),b("React").createElement(b("MessengerDialogButton.react"),{label:g._("Share Video"),onClick:function(){b("RTCMWProtocolHandler").videoEscalation(),d()},type:"primary"})))};e.exports=a}),null);
__d("RTCGroupCallAdminModelErrorDialogController",["cx","fbt","DOM","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogFooter.react","React","ReactDOM"],(function(a,b,c,d,e,f,g,h){"use strict";var i=300;a={_container:b("DOM").create("div"),showAdminModelErrorDialog:function(){b("ReactDOM").render(b("React").createElement(b("MessengerDialog.react"),{onToggle:function(){return this._onUnmount()}.bind(this),type:"default",width:i},b("React").createElement(b("MessengerDialogBody.react"),{className:"_233q"},h._("Only the admin can add people to the call who are not in this group")),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogButton.react"),{className:"_30vt _233r",label:h._("Ok"),onClick:function(){return this._onUnmount()}.bind(this),type:"primary",use:"default"}))),this._container)},_onUnmount:function(){b("ReactDOM").unmountComponentAtNode(this._container)}};e.exports=a}),null);
__d("RTCGroupCallAddMembersDialog.react",["cx","fbt","FluxContainer","FunnelLogger","immutable","MercuryIDs","MercuryLogMessageType","MercuryMessageActions","MercuryMessageObject","MercuryTriodeSourceUtil","MessengerAdminGroupUtils","MessengerApprovalModeTypes","MessengerDialog.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogHeader.react","MessengerDialogTitle.react","MessengerGraphQLTokenizer.react","MessengerParticipants.bs","MessengerRTCGroupCallContactList.react","MessengerRTCGroupCallThreadRow.react","React","RTCAppDispatcher","RTCCallStore","RTCConferenceState","RTCGroupCallActions","RTCGroupCallAdminModelErrorDialogController","RTCGroupCallDialogController","RTCGroupCallEscalationActions","RTCMWProtocolHandler","RTCP2PCallStore","VideoCallWebDriverIDs","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PureComponent;var j=460;d=babelHelpers.inherits(a,c);i=d&&d.prototype;a.getStores=function(){return[b("RTCCallStore")]};a.calculateState=function(){return{conferenceState:b("RTCCallStore").getState().callInfo.conferenceState,remoteUsers:b("RTCCallStore").getState().remoteUsers}};function a(a){__p&&__p();i.constructor.call(this,a),this.state={conferenceState:b("RTCConferenceState").NEW,isParticipantSelected:this.props.participants.mapEntries(function(a){var b=a[0];a[1];return[this.$1(b),!1]}.bind(this)),newParticipants:b("immutable").List(),remoteUsers:b("immutable").Set()},this.$2=function(a){this.setState({isParticipantSelected:this.state.isParticipantSelected.set(a,!this.state.isParticipantSelected.get(a))})}.bind(this),this.$11=function(){__p&&__p();var a=this.props,c=a.onUnmount,d=a.thread;a=a.viewerID;c();c=this.state.newParticipants.toArray().map(function(a){return a.getUniqueID()});var e=this.$3().map(function(a){a=a.fbid;return a||""});if(this.props.isEscalatedCall){b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","participant_picker_click_ring");var f=[].concat(c,e).map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.bs").getMulti(f,function(a){b("RTCGroupCallEscalationActions").setUsersToRing(b("immutable").Map(a));a=b("RTCP2PCallStore").getState();a=a.protocolHandler;a.escalateToMultiway()});return}d?c.length>0&&d.approval_mode===b("MessengerApprovalModeTypes").APPROVALS&&d.admin_ids&&d.admin_ids.indexOf(a)===-1?b("RTCGroupCallAdminModelErrorDialogController").showAdminModelErrorDialog():(b("RTCGroupCallActions").addParticipantsToRing(c),this.$8(d),e.length>0&&b("RTCMWProtocolHandler").addParticipants(b("RTCCallStore").getState().callInfo.conferenceName,b("RTCCallStore").getState().callInfo.serverInfoData,e)):b("RTCMWProtocolHandler").addParticipants(b("RTCCallStore").getState().callInfo.conferenceName,b("RTCCallStore").getState().callInfo.serverInfoData,[].concat(c,e))}.bind(this),this.$4=function(){__p&&__p();var a=this.state.newParticipants.toArray().map(function(a){return a.getUniqueID()}),c=this.$3().map(function(a){a=a.fbid;return a||""});c=[].concat(a,c).map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.bs").getMulti(c,function(c){c=this.$12(b("immutable").Map(c).valueSeq().toArray());var d=a.length>0;b("gkx")("AT4uLl1AB6JLlOysf-A2hpwt4KJLHV_bjB3XyRsO-BgTRrIBrw0NJXG9gSXonEK94SJbVDuoLSgqS0Dkh4vrerSG")&&c||b("gkx")("AT6c8BUV0FlnNMHF4dTuPa731A4LhQjSJAqfyTYk-MXPLzHY50LC9NwsoS7y-tDTDPUT7Szoe62iHMZL9uPPz8SI")&&d?b("RTCGroupCallDialogController").showBlockedUserWarningDialog(this.$11,this.props.onUnmount,b("gkx")("AT4uLl1AB6JLlOysf-A2hpwt4KJLHV_bjB3XyRsO-BgTRrIBrw0NJXG9gSXonEK94SJbVDuoLSgqS0Dkh4vrerSG")&&c,b("gkx")("AT6c8BUV0FlnNMHF4dTuPa731A4LhQjSJAqfyTYk-MXPLzHY50LC9NwsoS7y-tDTDPUT7Szoe62iHMZL9uPPz8SI")&&d):this.$11()}.bind(this))}.bind(this),this.$5=function(a){this.setState({newParticipants:this.state.newParticipants.push(a)})}.bind(this),this.$7=function(a){var b=a.getUniqueID();a=this.state.newParticipants;var c=a.findIndex(function(a){return a.getUniqueID()===b});c!==-1&&this.setState({newParticipants:a["delete"](c)})}.bind(this),this.$6=function(){this.setState({newParticipants:b("immutable").List()})}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCCallStore")]),b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","render_participant_picker")}a.prototype.render=function(){__p&&__p();var a=this.props,c=a.participants,d=a.thread;a=a.viewerID;var e=this.state.conferenceState;if(e===b("RTCConferenceState").TERMINATED||e===b("RTCConferenceState").TERMINATING)return null;e=b("React").createElement("div",{className:"_2t45"},b("React").createElement("div",{className:"_225b"},h._("Group Members")),b("React").createElement(b("MessengerRTCGroupCallContactList.react"),{isParticipantSelected:this.state.isParticipantSelected,onClick:this.$2,participantStates:b("immutable").Map(this.state.remoteUsers.map(function(a){return[a.FBID,a.participantState]})),remoteUsers:this.state.remoteUsers.toArray().sort(function(a,b){return a.userName.localeCompare(b.userName)})}));return b("React").createElement(b("MessengerDialog.react"),{onToggle:this.props.onUnmount,type:"default",width:j},b("React").createElement("div",{className:"_5zad"},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogCancelButton.react"),{dataTestID:b("VideoCallWebDriverIDs").RTC_PICKER_DIALOG_CANCEL_BUTTON}),b("React").createElement(b("MessengerDialogTitle.react"),null,h._("Add Group Members")),b("React").createElement(b("MessengerDialogButton.react"),{dataTestID:b("VideoCallWebDriverIDs").RTC_PICKER_DIALOG_RING_BUTTON,disabled:this.$3().length+this.state.newParticipants.size===0,label:h._("Ring"),onClick:this.$4,type:"primary"})),this.props.isEscalatedCall?null:b("React").createElement(b("MessengerRTCGroupCallThreadRow.react"),{displayAddMemberWarning:!0,participants:c,thread:d,viewerID:a}),b("React").createElement(b("MessengerGraphQLTokenizer.react"),{autoFocus:!!this.props.isEscalatedCall,className:"_2el3",context:null,defaultEntries:e,enableMessageSearch:!1,entries:this.state.newParticipants,excludeGroups:!0,excludePages:!0,forGroup:!0,forceHideClearButton:!0,hasHoverState:!1,hideViewWithEntries:!1,onAddEntryAttempt:this.$5,onClear:this.$6,onRemoveEntryAttempt:this.$7,originalEntryIDs:b("immutable").Set(this.props.participants.keySeq().toArray().map(function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)||a})),placeholder:h._("Add to group:"),scrollableViewClassName:"_2el2",shouldQueryInternalBot:!1,shouldQueryVCEndpoint:!1,showDefaultEntries:!0,useLayer:!1,viewer:this.props.viewerID,width:j})))};a.prototype.$8=function(a){if(this.state.newParticipants.size)if(b("MessengerAdminGroupUtils").isJoinableThread(a))this.state.newParticipants.forEach(function(c){c=b("MercuryIDs").getThreadIDFromUserID(c.getUniqueID());this.$9().send(this.$10().constructUserGeneratedMessageObject(a.joinable_mode.link,b("MercuryTriodeSourceUtil").getMercuryTriodeSource(),c))}.bind(this));else{var c="thread:"+(a.thread_fbid||a.thread_id.split(".")[1]);this.$9().send(this.$10().constructLogMessageObject(b("MercuryTriodeSourceUtil").getMercuryTriodeSource(),c,b("MercuryLogMessageType").SUBSCRIBE,{added_participants:this.state.newParticipants.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.getUniqueID())}).toArray()}))}};a.prototype.$9=function(){return b("MercuryMessageActions").getForFBID(this.props.viewerID)};a.prototype.$10=function(){return b("MercuryMessageObject").getForFBID(this.props.viewerID)};a.prototype.$12=function(a){return a.some(function(a){return a.is_messenger_blocked||a.is_facebook_blocked})};a.prototype.$3=function(){return this.props.participants.filter(function(a,b){return this.state.isParticipantSelected.get(this.$1(b))}.bind(this)).toArray()};a.prototype.$1=function(a){return b("MercuryIDs").getUserIDFromParticipantID(a)||""};e.exports=b("FluxContainer").create(a)}),null);
__d("RTCMWProtocolHandler",["invariant","Promise","regeneratorRuntime","ChannelManager","CurrentUser","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConstants","FBRTCGroupCallStore","FBRTCHangupReason","FBRTCLogger","FBRTCPeerConnection","FBRTCRtcResponseStatusCode","FBRTCSdpUtils","FBRTCVideoQuality","FunnelLogger","MercuryIDs","MultiwayParticipantFetcher","MultiwayRequests","RTCAppData","RTCCallActions","RTCCallStore","RTCGroupCallActions","RTCGroupCallDialogController","RTCGroupCallEscalationStore","RTCMultiwayMessageHandler","RTCSessionDescription","RTCUserMediaConstraints","RTCUtils","emptyFunction","gkx","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").CallEndReason,i=b("FBRTCConstants").GroupVideoViewLayout,j=b("FBRTCConstants").IceConnectionState,k=b("FBRTCConstants").SignalingProtocol,l=b("FBRTCConstants").VideoQuality,m=18e4,n={appId:b("RTCAppData").getMWAppID(),deviceId:b("ChannelManager").getCompleteConfig().sessionID,userId:b("CurrentUser").getID()};b("ChannelManager").startChannelManager();function o(a){__p&&__p();this.$5=!1,this.$6=!1,this.$7=b("FBRTCLogger").getInstance(),this.$10=function(a){__p&&__p();a=a.target;b("RTCCallActions").emit("onIceConnectionStateChange",a.iceConnectionState);switch(a.iceConnectionState){case j.CONNECTED:a=b("RTCCallStore").getState();a=a.callSummary;a&&b("gkx")("AT5-ilhz2Zk92PzchYxBHGqoisb5ux7QmaEBEJm2aKeVNmdUsAWWKWhG8p6BLcmhJ0gE1S7cCgFDgPSw8BNz-AY8ykEB300_SDpJTp693IJpgg")&&(a.onNetworkReady(),a.save(b("FBRTCCallSummaryStore").getInstance()));break;case j.DISCONNECTED:case j.FAILED:this.$3||(this.$3=setTimeout(function(){b("RTCCallActions").endCall(h.CONNECTION_DROPPED,"ConnectionDropped"),this.$14()}.bind(this),m));break;default:clearTimeout(this.$3),this.$3=null}}.bind(this),this.$1=a?a:b("RTCUtils").generateRandomInt(),this.$2="MW_PEER_ID"}o.prototype.setKeepLocalStreamsOnClose=function(a){this.$6=a};o.prototype.startCall=function(a,c,d,e){__p&&__p();var f=e.addStreamCallback;f=f===undefined?b("emptyFunction"):f;var g=e.callTrigger,h=e.formatParameters;h=h===undefined?{}:h;var i=e.preferredCodecs;i=i===undefined?{}:i;var j=e.serverInfoData,l=e.shouldSetDescriptions;l=l===undefined?!0:l;var m=e.isEscalatedCall;m=m===undefined?!1:m;var n=e.connectedOnJoin;n=n===undefined?!1:n;e=e.escP2PCallID;e=e===undefined?"":e;b("RTCCallActions").initialize(k.MULTIWAY,d,j,this.$1.toString(),g);var o=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$2,this.$1,!1);g&&o.onCallStarted(g);o.setJoinWithSID(j!=null);o.setActiveConnection("mws");o.setCallType("mws");o.onPopupOpened();o.setConferenceName(d);o.setServerInfoData(j);if(m){var p=b("RTCCallStore").getState().callSummary;o.setEscalationP2PCallID(p.callID)}o.save(b("FBRTCCallSummaryStore").getInstance());b("RTCCallActions").setCallSummary(o);p={mandatory:{},optional:[{DtlsSrtpKeyAgreement:!1},{googNumUnsignalledRecvStreams:10},{googHighBitrate:!0},{googVeryHighBitrate:!0},{RtpDataChannels:!0}]};p=new(b("FBRTCPeerConnection"))(k.MULTIWAY,{iceServers:[]},p);var q=p.createDataChannel("data");q&&(q.onmessage=function(a){a=a.data;try{a=JSON.parse(a);a=a.body;this.$8(a)}catch(a){this.$7.logError(this.$2,this.$1,a)}}.bind(this));p.addEventListener("addstream",function(event){this.$9(d,event.stream)}.bind(this));p.addEventListener("removestream",function(event){b("RTCCallActions").removeRemoteStream(event.stream)});p.addEventListener("iceconnectionstatechange",this.$10);this.$11(p,c,d,j,a,f,h,i,l,m,n,e,g?g:o.getCallTrigger());!j?b("RTCCallActions").call(a,p):b("RTCCallActions").join(p);return p};o.prototype.$9=function(a,c){__p&&__p();c.onaddtrack=function(a){var c=a.target;a=a.track;b("RTCCallActions").addRemoteTrack(c,a)};c.onremovetrack=function(a){var c=a.target;a=a.track;b("RTCCallActions").removeRemoteTrack(c,a)};var d=c.id.split(":")[0];d!==b("CurrentUser").getID()&&b("promiseDone")(b("MultiwayParticipantFetcher").fetchParticipant(a,d),function(a){var d=a&&(a.is_messenger_blocked||a.is_facebook_blocked);b("gkx")("AT4uLl1AB6JLlOysf-A2hpwt4KJLHV_bjB3XyRsO-BgTRrIBrw0NJXG9gSXonEK94SJbVDuoLSgqS0Dkh4vrerSG")&&d?b("RTCGroupCallDialogController").showIncomingBlockedUserWarningDialog(function(){return o.endCall(b("RTCCallStore").getState().callInfo.conferenceName,b("RTCCallStore").getState().callInfo.serverInfoData,b("FBRTCHangupReason").HANGUP_CALL)},function(b,a){return this.$12(b,a)}.bind(this),a,c):this.$12(a,c)}.bind(this))};o.prototype.$12=function(a,c){__p&&__p();var d=c.id.split(":")[0],e={};d=b("MercuryIDs").getParticipantIDFromUserID(d);e[d]=a;b("RTCGroupCallActions").onParticipantsAdded(e);b("RTCCallActions").addRemoteStream(c);b("RTCGroupCallEscalationStore").getState().inProgress&&b("RTCCallActions").setPreferredRemoteStream(c);d=b("RTCCallStore").getState();a=d.callInfo;e=b("FBRTCGroupCallStore").getState();c=e.layout;d=e.pinnedSpeakerFBID;e=b("RTCCallStore").getConnection(k.MULTIWAY);e&&o.subscription(a.conferenceName,a.serverInfoData,e.getRemoteStreams(),c,d)};o.prototype.$8=function(a){if(a.dominantSpeakerNotification){a=a.dominantSpeakerNotification.userId;b("RTCGroupCallActions").setDominantSpeaker(a)}};o.prototype.setDescriptions=function(){this.$5=!0;var a=b("RTCCallStore").getConnection(k.MULTIWAY);this.$4&&a&&a.setRemoteDescription(this.$4)};o.videoEscalation=function(){__p&&__p();return o.initStream(!0).then(function(a){__p&&__p();var c=b("RTCCallStore").getState(),d=c.callInfo,e=d.conferenceName;d=d.serverInfoData;var f=c.localUser;c=b("RTCCallStore").getConnection(k.MULTIWAY);if(!c)return;a.getTracks().forEach(function(a){a.kind==="audio"&&(a.enabled=!f.isAudioMuted())});var g=f.streams.first();c.removeStream(g);return p(c,[a],e,d,[]).then(function(){b("RTCCallActions").removeLocalStream(g),b("RTCCallActions").addLocalStream(a)})})};o.prototype.onStreamReady=function(a,c,d,e,f){var g={};e||b("RTCCallActions").addLocalStream(a);g.isEscalatedCall=e;f.p2pCallID&&(g.escP2PCallID=f.p2pCallID);f.serverInfoData&&(g.serverInfoData=f.serverInfoData);f.callTrigger&&(g.callTrigger=f.callTrigger);this.startCall(c,[a],d,g)};o.initStream=function(a,c){var d=arguments.length<=2||arguments[2]===undefined?!0:arguments[2];return b("RTCUtils").getUserMedia({audio:d&&b("RTCUserMediaConstraints").audio(),video:a?babelHelpers["extends"]({},q(b("RTCUserMediaConstraints").video(c?c:l.HD_VIDEO,""))):!1},{optionalConstraintsOnly:!0,supportFilteredStreams:!0})};o.startScreenStream=function(a){__p&&__p();var c=b("RTCCallStore").getState(),d=c.callInfo,e=d.conferenceName;d=d.serverInfoData;var f=c.localUser;c=b("RTCCallStore").getConnection(k.MULTIWAY);if(!c)return;for(var g=f.screenStreams,h=Array.isArray(g),i=0,g=h?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var j;if(h){if(i>=g.length)break;j=g[i++]}else{i=g.next();if(i.done)break;j=i.value}j=j;j!==a&&b("RTCUtils").transferAudioTracks(a,j)}for(var j=f.streams,i=Array.isArray(j),h=0,j=i?j:j[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(i){if(h>=j.length)break;g=j[h++]}else{h=j.next();if(h.done)break;g=h.value}g=g;b("RTCUtils").transferAudioTracks(a,g)}b("promiseDone")(p(c,[a],e,d,[]),function(){__p&&__p();for(var c=f.screenStreams,d=Array.isArray(c),e=0,c=d?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(d){if(e>=c.length)break;g=c[e++]}else{e=c.next();if(e.done)break;g=e.value}g=g;g!==a&&(b("RTCCallActions").removeLocalScreenStream(g),b("RTCUtils").stopMediaStream(g))}b("RTCCallActions").addLocalScreenStream(a)})};o.updateScreenStream=function(a,b){o.startScreenStream(b)};o.stopScreenStream=function(a){__p&&__p();var c=b("RTCCallStore").getState(),d=c.callInfo,e=d.conferenceName,f=d.serverInfoData;d=c.localUser;var g=b("RTCCallStore").getConnection(k.MULTIWAY);if(!g)return;c=d.getStream();d=void 0;c?d=b("Promise").resolve(c):d=o.initStream(!0,undefined,!1).then(function(a){b("RTCCallActions").addLocalStream(a);return a});b("promiseDone")(d,function(c){b("RTCUtils").transferAudioTracks(c,a),b("promiseDone")(p(g,[c],e,f,[]),function(){b("RTCUtils").stopMediaStream(a),b("RTCCallActions").removeLocalScreenStream(a)})})};o.endCall=function(a,c,d){var e=arguments.length<=3||arguments[3]===undefined?"":arguments[3];b("promiseDone")(o.genEndCall(a,d,{serverInfoData:c,detailedReasonString:e,keepLocalStream:!1}))};o.genEndCall=function(a,c,d){b("RTCMultiwayMessageHandler").close();d.keepLocalStream||b("RTCCallActions").removeAllLocalStreams(!0);var e=d.detailedReasonString||"Hangup by user";b("RTCCallActions").hangup(c,e);return b("MultiwayRequests").sendHangupRequest(n,a,d.serverInfoData,c,e,b("RTCCallStore").getState().callInfo.callID).then(function(){b("RTCCallActions").hangupSuccess()})["catch"](function(a){b("RTCCallActions").hangupError();throw a})};o.otherUserInAnotherCall=function(a,c,d){var e=arguments.length<=3||arguments[3]===undefined?"":arguments[3];b("promiseDone")(b("MultiwayRequests").sendHangupRequest(n,a,c,d,e||"User receiving this call is in another call",b("RTCCallStore").getState().callInfo.callID))};o.prototype.iceRestart=function(a,c){var d=b("RTCCallStore").getConnection(k.MULTIWAY);d&&p(d,[],a,c,[],{iceRestart:!0})};o.addParticipants=function(a,c,d){b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","send_ring_to_added_participants"),b("MultiwayRequests").sendAddParticipantsRequest(n,a,c,d,b("RTCCallStore").getState().callInfo.callID)};o.subscription=function(a,c,d,e,f){var g=e===i.DOMINANT_SPEAKER?b("FBRTCVideoQuality").LOW:e===i.GRID?b("FBRTCVideoQuality").MEDIUM:b("FBRTCVideoQuality").HIGH;d=d.map(function(a){a=a.id;return{cname:a,options:{videoQuality:e===i.DOMINANT_SPEAKER&&f===a.split(":")[0]?b("FBRTCVideoQuality").HIGH:g}}});e===i.DOMINANT_SPEAKER&&!f&&d.push({cname:""});b("MultiwayRequests").sendSubscriptionRequest(n,a,c,d,b("RTCCallStore").getState().callInfo.callID)};o.clientMediaUpdate=function(a,c,d,e,f){b("MultiwayRequests").sendClientMediaUpdateRequest(n,a,c,d,e,f,b("RTCCallStore").getState().callInfo.callID).then(function(a){var c=a.header.responseStatusCode;a=a.body.clientMediaUpdateResponse.currentVersion;return b("RTCGroupCallActions").onClientMediaUpdateResponse(c,a)})["catch"](function(a){b("FBRTCLogger").getInstance().logError(null,b("RTCCallStore").getState().callInfo.callID,a)})};o.prototype.$11=function(a,c,d,e,f,g,h,i,j,k,l,m,n){this.$13(d,e),b("promiseDone")(p(a,c,d,e,f,{},g,h,i,j,k,m,n),function(a){this.$4=a,this.$5&&this.setDescriptions(),b("RTCCallActions").callSuccess(l)}.bind(this),function(a){b("RTCCallActions").callError(a),this.$14()}.bind(this))};o.prototype.$14=function(){var a=b("RTCCallStore").getConnection(k.MULTIWAY);b("RTCMultiwayMessageHandler").close();a&&a.close();this.$6||b("RTCCallActions").removeAllLocalStreams(!0)};o.prototype.$13=function(a,c){b("RTCMultiwayMessageHandler").initHandler(a,c)};function p(a,c,d,e,f){__p&&__p();var g=arguments.length<=5||arguments[5]===undefined?{}:arguments[5],h=arguments.length<=6||arguments[6]===undefined?b("emptyFunction"):arguments[6],i=arguments.length<=7||arguments[7]===undefined?{}:arguments[7],j=arguments.length<=8||arguments[8]===undefined?{}:arguments[8],l=arguments.length<=9||arguments[9]===undefined?!0:arguments[9],m=arguments.length<=10||arguments[10]===undefined?!1:arguments[10],o=arguments.length<=11||arguments[11]===undefined?"":arguments[11],p=arguments.length<=12||arguments[12]===undefined?"":arguments[12],q,r,s,t,u,v,w,x,y,z,A;return b("regeneratorRuntime").async(function(B){__p&&__p();while(1)switch(B.prev=B.next){case 0:q={},r=[],(s=a.getLocalStreams()||[],t=Array.isArray(s),u=0,s=t?s:s[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]());case 3:if(!t){B.next=9;break}if(!(u>=s.length)){B.next=6;break}return B.abrupt("break",17);case 6:v=s[u++];B.next=13;break;case 9:u=s.next();if(!u.done){B.next=12;break}return B.abrupt("break",17);case 12:v=u.value;case 13:w=v,a.removeStream(w);case 15:B.next=3;break;case 17:c.forEach(function(b){r=r.concat(b.getTracks()),a.addStream(b,h)});r.forEach(function(a){q[a.id]=a.enabled});B.next=21;return b("regeneratorRuntime").awrap(a.createOffer(babelHelpers["extends"]({preserveH264:b("RTCUtils").isBonfireCall(d)},g),{FORMAT_PARAMETERS:i},j));case 21:x=B.sent;if(b("FBRTCSdpUtils").validateOfferSdp(d,x.toSdp())){B.next=24;break}throw b("FBRTCRtcResponseStatusCode").BAD_REQUEST;case 24:B.next=26;return b("regeneratorRuntime").awrap(a.setLocalDescription(x));case 26:b("RTCGroupCallActions").onJoinRequestSent();B.next=29;return b("regeneratorRuntime").awrap(b("MultiwayRequests").sendJoinRequest(n,d,e,x,f.length>0?f:null,r.length>0?q:null,{callID:b("RTCCallStore").getState().callInfo.callID,callTrigger:p,numParticipants:b("RTCCallStore").getState().remoteUsers.size},{userToEscalate:m&&f.length>0?f[0]:null,isEscalator:b("RTCGroupCallEscalationStore").getState().toRing,escP2PCallID:o}));case 29:y=B.sent;b("RTCGroupCallActions").onReceivedJoinResponse();m&&b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","sent_join_request");z=y.header.responseStatusCode;if(!(z!==b("FBRTCRtcResponseStatusCode").OK)){B.next=35;break}return B.abrupt("return",new(b("Promise"))(function(a,b){b(z)}));case 35:b("RTCGroupCallActions").onJoinResponse(y.header.serverInfoData);A=new(b("RTCSessionDescription"))(k.MULTIWAY,{type:"answer",sdp:y.body.joinResponse.answer.sdpString},{FORMAT_PARAMETERS:i});if(!l){B.next=40;break}B.next=40;return b("regeneratorRuntime").awrap(a.setRemoteDescription(A));case 40:b("RTCGroupCallActions").toggleRemoteStream(y.body.joinResponse.mediaStatus);b("RTCGroupCallActions").onProcessedJoinResponse();return B.abrupt("return",A);case 43:case"end":return B.stop()}},null,this)}function q(a){a instanceof Object||g(0);return a}e.exports=o}),null);
__d("XRTCCallNUXController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/rtc/call/nuxstatus/",{})}),null);
__d("RTCP2PCallNUXActions",["FBRTCLogger","FBRTCUtils","RTCAppDispatcher","RTCP2PCallActionTypes","XRTCCallNUXController","dangerouslyBypassDispatchError"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={refreshNUXState:function(){b("FBRTCUtils").sendServerRequest(b("XRTCCallNUXController").getURIBuilder().getURI(),function(a){a=a.payload;b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_INIT_NUX_STATE,payload:a})},function(){})},markNUXViewed:function(a){try{b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_MARK_NUX_VIEWED,nuxID:a})}catch(c){b("dangerouslyBypassDispatchError")(function(){return b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_MARK_NUX_VIEWED,nuxID:a})})}},dismissNUX:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCP2PCallActionTypes").P2P_DISMISS_NUX,nuxID:a})}};e.exports=a}),null);
__d("RTCPeerConnectionQueue",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.$1=[],this.$2=[]}a.prototype.push=function(a,b){switch(a){case"add":this.$1.push(b);break;case"remove":this.$2.push(b);break}};a.prototype.drain=function(){this.$3(this.$2),this.clear("remove"),this.$3(this.$1),this.clear("add")};a.prototype.$3=function(a){__p&&__p();if(a.length<1)return;for(var a=a,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;try{d()}catch(a){}}};a.prototype.clear=function(a){switch(a){case"add":this.$1=[];break;case"remove":this.$2=[];break;default:this.$1=[],this.$2=[]}};e.exports=a}),null);
__d("RTCP2PProtocolHandler",["invariant","Promise","Bootloader","ChannelManager","CollabCallMessengerBrowserEventEnum","CurrentUser","ErrorUtils","FBLogger","FBRTCCallControlActions","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCConsoleLogger","FBRTCConstants","FBRTCExperiment","FBRTCIceCache","FBRTCLocalMessageQueue","FBRTCLogger","FBRTCMessage","FBRTCMessageDedup","FBRTCMessageListener","FBRTCMessageSender","FBRTCPCConfig","FBRTCPeerConnection","FBRTCRetriableMessage","FBRTCSdpUtils","FBRTCSupport","FBRTCTurnDiscovery","FBRTCUrlManager","FBRTCUserSettings","FBRTCUtils","FBRTCVideoEscalationStore","FunnelLogger","MessengerRTCFunnelLogger","RTCCallActions","RTCCallStore","RTCCallType","RTCConferenceState","RTCConfig","RTCEndCallReason","RTCGroupCallEscalationStore","RTCGroupCallEscalator","RTCP2PCallActions","RTCP2PCallEscalationActions","RTCP2PCallEscalationStore","RTCP2PCallEscalator","RTCP2PCallNUXActions","RTCP2PCallStore","RTCP2PCallWindowHandler","RTCP2PConnectionStatus","RTCPeerConnectionQueue","RTCSessionDescription","RTCStreamDurationTracker","RTCUserMediaConstraints","RTCUtils","UserAgent","debounce","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").CallEndReason,i=b("FBRTCConstants").SignalingProtocol,j=b("FBRTCConstants").VideoQuality,k=6e4,l=3e4;function m(){__p&&__p();this.$4={streams:{}},this.$5=b("FBRTCLogger").getInstance(),this.$7=!1,this.$8=!0,this.$9=!1,this.$10="passive",this.$16=new(b("FBRTCIceCache"))(),this.$17=!1,this.$20=null,this.$21=null,this.$23=new(b("RTCStreamDurationTracker"))("video"),this.$24=new(b("RTCStreamDurationTracker"))("video"),this.$25=new(b("RTCStreamDurationTracker"))("screen"),this.$26=!1,this.$57=function(a){this.$32(h.WEBRTC_ERROR,!1,!0,!1,a.message),q(a)}.bind(this),this.$42=function(a){a=a.candidate;a&&this.$58(a)}.bind(this),this.$43=function(a){__p&&__p();a=a.target;a=a.iceConnectionState;p("P2P:PC iceconnectionstatechange %o",a);(this.$21==="disconnected"||this.$21==="failed")&&a==="connected"&&this.$29(b("CollabCallMessengerBrowserEventEnum").CONNECTION_RECOVERY,this.$21);this.$29(b("CollabCallMessengerBrowserEventEnum").ICE_CONNECTION_STATE_CHANGE,a);clearTimeout(this.$20);switch(a){case"checking":this.$9=!0;break;case"connected":case"completed":this.$59();this.$60();break;case"failed":this.$20=setTimeout(function(){if(b("RTCConfig").CollaborationBrowserConfig.ICE_recovery&&b("FBRTCConfig").isVCEndpointCall()){this.$61("ICE failure");return}this.$57(new Error("ICE failed"));b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").DISCONNECTED)}.bind(this),b("RTCConfig").CollaborationBrowserConfig.ICE_failed_timeout);break;case"disconnected":this.$20=setTimeout(function(){this.$32(h.CONNECTION_DROPPED,!1,!0,!1)}.bind(this),b("RTCConfig").CollaborationBrowserConfig.ICE_disconnected_timeout);break;case"closed":break}}.bind(this),this.$65=function(){var a=this.$3.getCreatedIceCandidates();for(var b=0;b<a.length;b++)this.$58(a[b])}.bind(this),this.$44=function(a){a=a.target;a=a.iceGatheringState;p("P2P:PC icegatheringstatechange %o",a);this.$29(b("CollabCallMessengerBrowserEventEnum").ICE_GATHERING_STATE_CHANGE,a)}.bind(this),this.$45=function(a){var c=a.errorCode,d=a.errorText,e=a.hostCandidate;a=a.url;p("P2P:PC icecandidateerror %o: %s %o %o",c,d);this.$29(b("CollabCallMessengerBrowserEventEnum").ICE_CANDIDATE_ERROR,{errorCode:c,errorText:d,hostCandidate:e,url:a})}.bind(this),this.$66=function(){var a;void 0;this.$22?a=h.UNSUPPORTED_VERSION:a=h.OTHER_NOT_CAPABLE;this.$32(a,!1,!0,!1,"TimedOut")}.bind(this),this.$48=b("debounce")(function(a){__p&&__p();var c=a.target;if(c.iceConnectionState==="closed"){p("P2P:PC negotiationneeded pc is %o",c.iceConnectionState);return}else if(!this.$8){this.$29(b("CollabCallMessengerBrowserEventEnum").RENEGOTIATION,"ignore");p("P2P:PC negotiationneeded %o","ignore");return}else if(!b("RTCP2PCallEscalator").isNegotiationAllowed()){this.$29(b("CollabCallMessengerBrowserEventEnum").RENEGOTIATION,"not allowed - escalating");p("P2P:PC negotiationneeded %o","not allowed","escalating");return}else if(this.$7){this.$29(b("CollabCallMessengerBrowserEventEnum").RENEGOTIATION,"retry");p("P2P:PC SDP lock %o, will retry in a bit","on");setTimeout(function(){return this.$48(a)}.bind(this),100);return}else p("P2P:PC SDP lock %o","off");this.$8=!1;var d=[];p("P2P:PC negotiationneeded @ signalingState %o",c.signalingState);if(c.signalingState==="stable"){if(this.$9){c=b("RTCP2PCallStore").getState();c=c.signalingExperiments;if(!c.support("sdp_update"))this.$62(),d.push("new offer");else{c=m.supportMultipleStreams();d.push("SDP update",c?"plan B":null)}this.$10="passive"}this.$29(b("CollabCallMessengerBrowserEventEnum").RENEGOTIATION,"create offer");this.$63().then(function(a){if(a.strongDiff(this.$3.getLocalDescription())){p("P2P SDP difference %o - set offer","strong");this.$29(b("CollabCallMessengerBrowserEventEnum").RENEGOTIATION,d);return a}p("P2P SDP difference %o - noop","weak");return null}.bind(this)).then(function(a){a&&(this.$9&&b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").RECONNECTING),this.$64(a)),this.$10="active"}.bind(this))["catch"](this.$57)}}.bind(this),50),this.$49=function(a){__p&&__p();if(this.$26){this.$27.push("add",function(){return this.$49(a)}.bind(this));return}var c=a.stream,d=this.$56(c),e=this.$1;d===b("FBRTCConstants").StreamType.SCREEN_CONTENT?(b("RTCCallActions").addRemoteScreenStream(c,e),!m.supportMultipleStreams()&&c.getAudioTracks().length>0&&this.$24.track(c)):(b("FBRTCUserSettings").updateForRemoteStream(c),b("RTCCallActions").addRemoteStream(c,e),this.$24.track(c),b("RTCP2PCallStore").addListener(b("debounce")(function(){b("RTCP2PCallStore").getState().callType!==b("RTCCallType").AUDIO_ONLY&&this.$59()}.bind(this),50)));this.$29(b("CollabCallMessengerBrowserEventEnum").REMOTE_STREAM_ADDED,c);p("P2P:PC remote %o stream %o %o %o",d,"added",c,", tracks: ",c.getTracks())}.bind(this),this.$51=function(a){__p&&__p();if(this.$26){this.$27.push("remove",function(){return this.$51(a)}.bind(this));return}var c=a.stream,d=this.$56(c),e=this.$1;if(d===b("FBRTCConstants").StreamType.SCREEN_CONTENT){b("RTCCallActions").removeRemoteScreenStream(c,e);var f=b("RTCCallStore").getState().remoteUsers.first();if(f){f=f.streams.first();f&&this.$24.track(f)}}else b("RTCCallActions").removeRemoteStream(c,e);this.$29(b("CollabCallMessengerBrowserEventEnum").REMOTE_STREAM_REMOVED,c);p("P2P:PC remote %o stream %o %o %o",d,"removed",c,", tracks: ",c.getTracks())}.bind(this),this.$30=function(a){this.$5.logInfo(this.$1,this.$2,"Received Turn Creds"),this.$29(b("CollabCallMessengerBrowserEventEnum").TURN_CREDENTIALS_RECEIVED,a),b("FBRTCPCConfig").setTurnCredentials(a)}.bind(this),this.$31=function(){this.$5.logError(this.$1,this.$2,"Failed to get turn creds"),this.$32(h.CLIENT_ERROR,!1,!b("RTCP2PCallStore").isCaller(),!1,"NoTurnCreds")}.bind(this),this.$38=function(a,b){this.$32(a,!1,!1,!1,b)}.bind(this),this.$37=function(a,c){__p&&__p();var d=c.call_id;if(this.$76()){this.$5.logError(this.$1,this.$2,"Message sent after call ended: "+c.type);return}if(this.$1!==a||this.$2!==d)return;r(function(a){return a.onMessageSent(c)});this.$29(b("CollabCallMessengerBrowserEventEnum").MESSAGE_SENT,c)}.bind(this),this.$40=function(a){__p&&__p();var c=void 0;try{c=new(b("FBRTCMessage"))(a)}catch(b){this.$5.logError(this.$1,this.$2,"Unknown data: "+JSON.stringify(a));return}this.$5.logReceivedMessage(c.peerID,c.callID,c.msg);this.$29(b("CollabCallMessengerBrowserEventEnum").MESSAGE_RECEIVED,c.msg);if(this.$76()){this.$5.logInfo(this.$1,this.$2,"Ignoring message (call ended): "+c.msgID);return}if(!b("FBRTCMessageDedup").check(c.peerID,c.callID,c.msgID)){this.$5.logInfo(this.$1,this.$2,"Ignoring message (duplicate): "+c.msgID);return}if(b("RTCCallStore").getState().callInfo.conferenceState===b("RTCConferenceState").AWAITING_USER_START){this.$5.logInfo(this.$1,this.$2,"Ignoring message (awaiting user start): "+c.msgID);return}if(this.$1&&this.$1!==c.peerID){c.isOffer()&&this.$77(c);this.$5.logInfo(this.$1,this.$2,"Ignoring message (different peer): "+c.msgID);return}if(!c.isForCall(this.$2,this.$15)){this.$5.logInfo(this.$1,this.$2,"Ignoring message (different call): "+c.msgID+"(callID: "+c.callID+")");return}p("P2P msg.get type:%o callID:%o %o",c.msgType,c.callID,c);this.$2&&this.$2===c.callID&&r(function(a){return a.onFullMessageReceived(c)});b("RTCP2PCallActions").setRemoteSignalingExperiments(c.getSignalingExperiments());a=b("RTCGroupCallEscalationStore").getState().inProgress;switch(c.msgType){case b("FBRTCConstants").PayloadType.ICERESTART_OFFER:case b("FBRTCConstants").PayloadType.PCRESTART_OFFER:this.$62();this.$78(c);break;case b("FBRTCConstants").PayloadType.OFFER:this.$78(c);break;case b("FBRTCConstants").PayloadType.ANSWER:case b("FBRTCConstants").PayloadType.ICERESTART_ANSWER:case b("FBRTCConstants").PayloadType.PCRESTART_ANSWER:this.$79(c);break;case b("FBRTCConstants").PayloadType.SDP_UPDATE:this.$80(c);break;case b("FBRTCConstants").PayloadType.ICE_CANDIDATE:this.$81(c);break;case b("FBRTCConstants").PayloadType.HANGUP:this.$82(c);break;case b("FBRTCConstants").PayloadType.OFFER_ACK:this.$83(c);break;case b("FBRTCConstants").PayloadType.OFFER_NACK:this.$22=!0;break;case b("FBRTCConstants").PayloadType.ANSWER_ACK:this.$84();break;case b("FBRTCConstants").PayloadType.MSG_ACK:this.$85(c);break;case b("FBRTCConstants").PayloadType.SET_VIDEO:b("RTCP2PCallStore").getState().isRemoteVideoSupported&&!b("RTCP2PCallStore").isAudioOnly()&&this.$74(c.msg);break;case b("FBRTCConstants").PayloadType.SWITCH_TO_MULTIWAY:!a?this.handleSwitchToMultiway():p("P2P Received %o while escalation is in progress %o",c.msgType,c);break;case b("FBRTCConstants").PayloadType.VIDEO_REQUEST:case b("FBRTCConstants").PayloadType.ACK:case b("FBRTCConstants").PayloadType.OK:case b("FBRTCConstants").PayloadType.PING:case b("FBRTCConstants").PayloadType.PING_ACK:case b("FBRTCConstants").PayloadType.OTHER_DISMISS:case b("FBRTCConstants").PayloadType.PRANSWER:break;default:break}this.$28.parseMessage(c);b("FBRTCCallControlActions").receivedSignalingMessage(c)}.bind(this),this.$39=function(a){a=a.message+"; "+a.stackFrames[0].identifier;this.$5.logError(this.$1,this.$2,"JSError: "+a)}.bind(this),b("ChannelManager").startChannelManager(),this.$29(b("CollabCallMessengerBrowserEventEnum").CALL_CONTROLLER_INIT)}m.prototype.init=function(a,c){this.$1=a;this.$2=c;this.$5.logInfo(this.$1,this.$2,"init call");this.$6=new(b("FBRTCLocalMessageQueue"))();a=this.$6.getOffer(this.$1);if(a){c=new(b("FBRTCMessage"))(a);b("RTCP2PCallActions").processMessage(c)}};m.prototype.fetchTURNCredentials=function(){if(b("FBRTCConfig").isVCEndpointCall()){this.$5.logInfo(this.$1,this.$2,"Skipping the TURN discovery");return b("Promise").resolve()}this.$29(b("CollabCallMessengerBrowserEventEnum").CALL_START_TRY,"not ready");return b("FBRTCTurnDiscovery").requestTurnCreds(this.$2.toString(),this.$1).then(this.$30,this.$31)};m.prototype.endCall=function(){var a=arguments.length<=0||arguments[0]===undefined?h.HANGUP_CALL:arguments[0],c=arguments.length<=1||arguments[1]===undefined?"":arguments[1],d=arguments.length<=2||arguments[2]===undefined?!1:arguments[2];b("RTCCallActions").hangup(a,c);this.$32(a,!1,!0,d,c)};m.prototype.startCall=function(a){__p&&__p();this.$29(b("CollabCallMessengerBrowserEventEnum").CALL_PROCESS_STARTED,{userCallType:this.$33()});this.$3=this.$34();this.$35();this.$27=new(b("RTCPeerConnectionQueue"))();var c=this.$6.getOffer(this.$1),d=null;c?(this.$18=new(b("FBRTCMessage"))(c),b("FBRTCMessageDedup").check(this.$1,this.$18.callID,this.$18.msgID),d=!1):(d=!0,b("RTCP2PCallActions").setIsCaller(d));this.$8=d;this.$18 instanceof b("FBRTCMessage")&&b("RTCP2PCallActions").processMessage(this.$18);this.$36(a,d);b("FBRTCUrlManager").init(this.$1);this.$11=new(b("FBRTCMessageSender"))();this.$11.onMessageSent=this.$37;this.$11.onSendFailure=this.$38;this.$28=new(b("RTCP2PCallEscalator"))(this.$1,this.$2,this.$11);b("ErrorUtils").addListener(this.$39,!0);b("FBRTCMessageListener").setMessageHandler(this.$40,this);this.$41();b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").CONTACTING);b("RTCCallActions").call([this.$1],this.$3)};m.prototype.$36=function(a,c){c=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$1,this.$2,c,this.$18&&this.$18.msg,a);c.setCallType(b("RTCP2PCallStore").getState().callType===b("RTCCallType").AUDIO_ONLY?b("FBRTCVideoEscalationStore").CallType.voip:b("FBRTCVideoEscalationStore").CallType.direct_video);this.initV2CallSummary(c);b("RTCCallActions").setCallSummary(c)};m.prototype.startScreenStream=function(a){if(!m.supportMultipleStreams()){var c=b("RTCCallStore").getState();c=c.localUser;c=c.streams.first();b("RTCUtils").transferAudioTracks(a,c)}b("RTCCallActions").addLocalScreenStream(a)};m.prototype.stopScreenStream=function(a){__p&&__p();var c=b("RTCCallStore").getState();c=c.localUser;if(!c.screenStreams.includes(a))return;if(!m.supportMultipleStreams()){c=c.streams.first();b("RTCUtils").transferAudioTracks(c,a)}b("RTCCallActions").removeLocalScreenStream(a);b("RTCUtils").stopMediaStream(a)};m.prototype.updateScreenStream=function(a,c){b("RTCUtils").transferAudioTracks(c,a),b("RTCCallActions").replaceLocalScreenStream(a,c),b("RTCUtils").stopMediaStream(a)};m.prototype.$34=function(){__p&&__p();var a=b("RTCP2PCallStore").getState();a=a.isPeerOnMobile;a=new(b("FBRTCPeerConnection"))(i.P2P,b("FBRTCPCConfig").getConfig(),b("FBRTCPCConfig").getConstraints(a));var c=void 0,d=void 0,e=void 0,f=void 0;b("RTCCallStore").addListener(b("debounce")(function(){__p&&__p();var a=b("RTCCallStore").getState();a=a.localUser;if(!a||a===c)return;c=a;var g=a.isVideoMuted();d!==g&&(this.$11&&d!=null&&(!a.hasScreenStream()||m.supportMultipleStreams())&&this.$11.sendMuteStateUpdate(this.$1,this.$2,!g),d=g);g=a.streams;a=a.screenStreams;g!==e||a!==f?(e=g,f=a,this.$35()):this.$23.update()}.bind(this),50));b("FBRTCConfig").isVCEndpointCall()&&a.createDataChannel("noop");a.addEventListener("icecandidate",this.$42);a.addEventListener("iceconnectionstatechange",this.$43);a.addEventListener("icegatheringstatechange",this.$44);a.addEventListener("icecandidateerror",this.$45);a.addEventListener("connectionstatechange",this.$46);a.addEventListener("signalingstatechange",this.$47);a.addEventListener("negotiationneeded",this.$48);a.addEventListener("addstream",this.$49);a.addEventListener("track",this.$50);a.addEventListener("removestream",this.$51);a.addEventListener("datachannel",this.$52);this.$53(a);return a};m.supportMultipleStreams=function(){var a=b("RTCP2PCallStore").getState();a=a.signalingExperiments;return a.support("multiple_streams_plan_b")};m.prototype.$35=function(){__p&&__p();if(this.$3.getSignalingState()==="closed")return;var a=b("RTCCallStore").getState();a=a.localUser;if(!a)return;var c=this.$3.getLocalStreams(),d=a.getStream();a=a.getScreenStream();if(m.supportMultipleStreams()){a?(this.$54(a),this.$25.track(a)):this.$25.update();d?(this.$54(d),this.$23.track(d)):this.$23.update();for(var e=c,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;!(a&&h===a)&&!(d&&h===d)&&this.$55(h)}}else{h=null;a?(this.$54(a),this.$25.track(a),h=a):(this.$25.update(),d&&(this.$54(d),h=d));h&&this.$23.track(h);for(var g=c,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;a=g[e++]}else{e=g.next();if(e.done)break;a=e.value}d=a;h&&h===d||this.$55(d)}}};m.prototype.updateAddedTracksForFirefoxVideoEscalation=function(a){b("FBRTCPeerConnection").isFirefoxSupportAddTrack()||b("FBLogger")("rtc_www").mustfix("This function must be called within Firefox context"),this.$8=!0,this.$3.addStream(a),m.replaceLocalStream(a)};m.prototype.$54=function(a){var b=this.$3.getLocalStreams();if(b.includes(a))return;p("P2P:PC local %o stream %o %o %o",this.$56(a),"added",a,", tracks: ",a.getTracks());this.$8=!0;this.$3.addStream(a)};m.prototype.$55=function(a){var b=this.$3.getLocalStreams();if(!b.includes(a))return;p("P2P:PC local %o stream %o %o %o",this.$56(a),"removed",a,", tracks: ",a.getTracks());this.$8=!0;this.$3.removeStream(a)};m.prototype.$61=function(a){this.$7=!0,this.$8=!1,this.$10="passive",this.$62(),p("P2P:PC recovering from %o",a),this.$29(b("CollabCallMessengerBrowserEventEnum").CONNECTION_RECOVERY,a),this.$63().then(function(a){b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").RECONNECTING),this.$64(a),this.$10="active"}.bind(this))["catch"](this.$57)};m.prototype.$63=function(){return this.$3.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!b("RTCP2PCallStore").isAudioOnly()},{ADD_FB_FEATURES:["video"]})};m.prototype.$58=function(a){this.$11.sendIceCandidate(this.$1,this.$2,a)};m.prototype.$46=function(a){a=a.target;p("P2P:PC connectionstatechange %o",a.connectionState)};m.prototype.$47=function(a){a=a.target;p("P2P:PC signalingstatechange %o",a.signalingState)};m.prototype.$62=function(){__p&&__p();this.$8=!1;var a=this.$1,c=b("RTCCallStore").getState().remoteUsers.first(),d=c.streams,e=c.screenStreams;this.$26=!0;this.$27.clear("add");this.$27.push("remove",function(){__p&&__p();for(var c=d,f=Array.isArray(c),g=0,c=f?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=c.length)break;h=c[g++]}else{g=c.next();if(g.done)break;h=g.value}h=h;b("RTCCallActions").removeRemoteStream(h,a)}for(var h=e,g=Array.isArray(h),f=0,h=g?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(g){if(f>=h.length)break;c=h[f++]}else{f=h.next();if(f.done)break;c=f.value}c=c;b("RTCCallActions").removeRemoteScreenStream(c,a)}});this.$3.reset().then(function(){this.$26=!1,this.$27.drain()}.bind(this))["catch"](q);b("FBRTCConfig").isVCEndpointCall()&&this.$3.createDataChannel("noop")};m.prototype.$50=function(a){a=b("RTCCallStore").getState().remoteUsers.first();a&&!a.isVideoMuted()&&b("RTCCallActions").toggleMuteRemoteVideo(!1,a.FBID)};m.prototype.$56=function(a){var c=b("FBRTCConstants").StreamType;try{switch(this.$4.streams[a.id].type){case c.SCREEN_CONTENT:return c.SCREEN_CONTENT;case c.AUDIO_VIDEO:return c.AUDIO_VIDEO;case c.AUDIO_ONLY:return c.AUDIO_ONLY;default:throw Error("no known stream type found, detecting")}}catch(b){return a.getVideoTracks().length>0?c.AUDIO_VIDEO:c.AUDIO_ONLY}};m.prototype.$59=function(){this.$23.isStarted()?this.$23.update():this.$23.start();var a=b("RTCP2PCallStore").getState();a=a.callType;a!==b("RTCCallType").AUDIO_ONLY&&(this.$24.isStarted()?this.$24.update():this.$24.start());this.$25.isStarted()?this.$25.update():this.$25.start()};m.prototype.$60=function(){b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").CONNECTED),r(function(a){a.onCallConnected(),a.onNetworkReady()})};m.prototype.$52=function(a){a=a.channel;p("P2P:PC datachannel %o",a)};m.prototype.startLocalVideoTracker=function(a){this.$23.track(a)};m.prototype.updateLocalVideoTracker=function(){this.$23.update()};m.initStream=function(a,c,d){__p&&__p();var e=b("RTCP2PCallStore").getState();e=e.isPeerOnMobile;var f=b("FBRTCExperiment").gen("rtc_www_p2p_video_quality");f=f.getBool("use_sd",!1);e&&!f&&b("RTCP2PCallActions").setVideoQuality(j.LQ_VIDEO);var g=a?babelHelpers["extends"]({aspectRatio:{ideal:Number((16/9).toFixed(10))}},o(b("RTCUserMediaConstraints").video(b("RTCP2PCallStore").getState().videoQuality,d||""))):!1;return b("RTCUtils").getUserMediaWithAudioFallback({audio:b("RTCUserMediaConstraints").audio(c||""),video:g},{optionalConstraintsOnly:f,supportFilteredStreams:!0}).then(function(c){__p&&__p();var d=b("RTCCallStore").getState();d=d.callSummary;if(a&&d){try{var e=c.getVideoTracks();e=e[0];e||(d.onFellbackToAudio(),n(function(a){return a.log(b("CollabCallMessengerBrowserEventEnum").AUDIO_FALLBACK,{eventDetails:{videoConstraints:g}})}))}catch(a){n(function(c){return c.log(b("CollabCallMessengerBrowserEventEnum").INIT_STREAM_ERROR,{eventDetails:{error:a.name,message:a.message,videoConstraints:g}})})}d.save(b("FBRTCCallSummaryStore").getInstance())}return c})};m.replaceLocalStream=function(a){var c=arguments.length<=1||arguments[1]===undefined?!1:arguments[1],d=b("RTCCallStore").getState().localUser.streams.first();b("RTCCallActions").replaceLocalStream(d,a);c&&b("RTCUtils").stopMediaStream(d)};m.prototype.escalateToMultiway=function(){var a=b("RTCP2PCallStore").getState(),c=a.callType,d=a.offerEscalationSupport;a=a.escalationConferenceName;if(d&&a){r(function(a){return a.setEscalationInitiated()});d=c!==b("RTCCallType").AUDIO_ONLY&&(b("RTCCallStore").hasRemoteVideo()||b("RTCCallStore").hasLocalVideo());c=new(b("RTCGroupCallEscalator"))(a,d,this.$1,this.$2);c.startEscalationToMultiway()}};m.prototype.handleSwitchToMultiway=function(){__p&&__p();var a=b("RTCP2PCallStore").getState(),c=a.callType,d=a.offerEscalationSupport;a=a.escalationConferenceName;this.$7=!1;b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","received_switch_to_multiway");if(d&&a){r(function(a){return a.setReceivedEscalationRequest()});d=c!==b("RTCCallType").AUDIO_ONLY&&(b("RTCCallStore").hasRemoteVideo()||b("RTCCallStore").hasLocalVideo());c=new(b("RTCGroupCallEscalator"))(a,d,this.$1,this.$2);c.startEscalationToMultiway()}};m.prototype.$67=function(a,c){var d=b("gkx")("AT5cptvyk3v4q-mPX6FvPR1r8kJdnP0MgzuDdVra8DpZXuiu89qXhkgPD7OKcZn2j9_1ar1-0wqcgyg_FLY_IdusNDUe63z-hD6N3VThwJfBrw"),e=a&&d&&b("FBRTCSupport").isGroupCallWebtrcSupported();this.$14=e;this.$15=c;b("RTCP2PCallActions").setMultiwayEscalationSupport(e,c);r(function(a){a.setConferenceName(c),e&&a.setEscalationAvailable()})};m.prototype.$41=function(){__p&&__p();b("FBRTCUrlManager").onCallStarted();p("P2P start call offer %o",this.$18);if(this.$18){this.$7=!0;this.$8=!1;var a=this.$18.msg,c=a.sdp,d=a.attributes,e=a.offer_escalation_support;a=a.escalation_conference_name;b("RTCP2PCallActions").setRemoteSignalingExperiments(this.$18.getSignalingExperiments());this.$67(!!e,a);this.$68(c,"offer",d);this.$6.removeOffer(this.$1);this.$18=null}this.$29(b("CollabCallMessengerBrowserEventEnum").CALL_START_TRY)};m.prototype.$64=function(a){__p&&__p();p("P2P SDP %o created %o",a.type,a);this.$7=!0;return this.$3.setLocalDescription(a).then(function(a){return a.toDesc()}).then(function(a){__p&&__p();var c=a.sdp;a=a.type;p("P2P SDP %o set %o",a,{sdp:c});switch(a){case"offer":b("RTCP2PCallStore").getState().signalingExperiments.support("sdp_update")&&b("RTCCallStore").getState().callInfo.conferenceState===b("RTCConferenceState").CONNECTED?this.$69(c):this.$70(c);this.$17=!1;break;case"answer":this.$71(c);break;default:break}}.bind(this))["catch"](this.$57)};m.prototype.$72=function(){return{streams:this.$73()}};m.prototype.$73=function(){__p&&__p();var a={},c=b("RTCCallStore").getState();c=c.localUser.screenStreams;for(var d=this.$3.getLocalStreams(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;var h=c.includes(g)?b("FBRTCConstants").StreamType.SCREEN_CONTENT:g.getVideoTracks().length?b("FBRTCConstants").StreamType.AUDIO_VIDEO:b("FBRTCConstants").StreamType.AUDIO_ONLY;a[g.id]={type:h}}return a};m.prototype.$69=function(a){var c=b("RTCCallStore").getState();c=c.localUser;this.$11.sendSdpUpdate(this.$1,this.$2,a,!b("RTCP2PCallStore").isAudioOnly()&&!c.isVideoMuted(),this.$72())};m.prototype.$70=function(a){__p&&__p();var c=this.$9?b("FBRTCConstants").PayloadType.PCRESTART_OFFER:b("FBRTCConstants").PayloadType.OFFER;p("P2P offer type %o",c);var d=b("RTCCallStore").getState();d=d.callSummary;d=d?d.getCallTrigger():"";this.$12=new(b("FBRTCRetriableMessage"))(this.$11);this.$12.addListener("sendingRetry",this.$65);this.$12.addListener("timeoutFailure",this.$66);this.$12.sendMessage(c,this.$1,this.$2,a,!b("RTCP2PCallStore").isAudioOnly(),this.$72(),null,d);this.$19=setTimeout(function(){this.$32(h.NO_ANSWER_TIMEOUT,!1,!0,!1,"NoAnswerTimeout")}.bind(this),k)};m.prototype.$74=function(a){__p&&__p();if(!Object.prototype.hasOwnProperty.call(a,"videoon"))return;a=!a.videoon;b("RTCCallActions").toggleMuteRemoteVideo(a,this.$1);for(var a=this.$3.getRemoteStreams(),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(e.getAudioTracks().length>0){this.$29(b("CollabCallMessengerBrowserEventEnum").REMOTE_STREAM_MUTE_TOGGLED,e);return}}this.$24.update()};m.prototype.$71=function(a){this.$13=new(b("FBRTCRetriableMessage"))(this.$11);this.$13.addListener("sendingRetry",this.$65);var c={escalationConferenceName:this.$15,negotiatedEscalationSupport:this.$14};this.$13.sendMessage(b("FBRTCConstants").PayloadType.ANSWER,this.$1,this.$2,a,!b("RTCP2PCallStore").isAudioOnly(),this.$72(),c)};m.prototype.$75=function(a){this.$32(h.WEBRTC_ERROR,!1,!0,!1,a.endCallSubreason),this.$5.logError(this.$1,this.$2,"webrtc error: "+JSON.stringify(a.details)),this.$29(b("CollabCallMessengerBrowserEventEnum").RTC_ERROR,a.details)};m.prototype.$77=function(a){__p&&__p();var c=a.peerID,d=a.callID,e=a.msg,f=new(b("FBRTCCallSummary"))({peerID:c,callID:d,isCaller:!1});this.initV2CallSummary(f);f.onFullMessageReceived(a);f.setCallType(b("FBRTCSdpUtils").isVideoSupported(e.sdp)?b("FBRTCVideoEscalationStore").CallType.direct_video:b("FBRTCVideoEscalationStore").CallType.voip);this.$11.sendOfferAck(c,d,e);f.onOfferAckSent(e);a=new(b("RTCEndCallReason"))(h.IN_ANOTHER_CALL);this.$86(c,d,a,!1);f.onCallEnded(a.getReasonID(),!1);f.save(b("FBRTCCallSummaryStore").getInstance())};m.prototype.$78=function(a){__p&&__p();p("P2P handle %o","offer");var b=this.$3.getSignalingState();if(b!=="stable"){p("P2P ignore %o; wrong signaling state: %o","offer",b);return}b=a.msg;if(b.calltype){this.$11.sendOfferNack(this.$1,b.call_id,b);return}this.$11.sendOfferAck(this.$1,b.call_id,b);this.$11.sendOtherDismiss(b.call_id);this.$87(b)?this.$88(a):this.$89(a)};m.prototype.$88=function(a){__p&&__p();var c=this,d=a.msg;this.$74(d);this.$90();this.$91();this.$92();this.$2!==d.call_id?(function(){__p&&__p();var e=new(b("RTCEndCallReason"))(h.OTHER_INSTANCE_HANDLED);c.$86(c.$1,c.$2,e,!1);r(function(a){a.onCallEnded(e.getReasonID(),!1)});var f=new(b("FBRTCCallSummary"))({peerID:c.$1,callID:d.call_id,isCaller:!1});b("RTCCallActions").setCallSummary(f);c.initV2CallSummary(f);r(function(c){c.onFullMessageReceived(a),c.onOfferAckSent(d),c.setCallType(b("FBRTCSdpUtils").isVideoSupported(d.sdp)?b("FBRTCVideoEscalationStore").CallType.direct_video:b("FBRTCVideoEscalationStore").CallType.voip)});c.$5.logEvent(c.$1,c.$2,"Handling offer collision")})():this.$5.logEvent(this.$1,this.$2,"Handling offer refresh");this.$17=!1;this.$18=a;b("RTCP2PCallActions").processMessage(a);this.$41();this.$29(b("CollabCallMessengerBrowserEventEnum").OFFER_ACCEPTED,a.msgID)};m.prototype.$89=function(a){p("P2P:PC ignoring offer %o",a),this.$5.logEvent(this.$1,this.$2,"Ignoring offer"),this.$29(b("CollabCallMessengerBrowserEventEnum").OFFER_IGNORED,a.msgID)};m.prototype.$80=function(a){__p&&__p();var c=a.msg;b("RTCP2PCallActions").processMessage(a);this.$74(c);switch(this.$3.getSignalingState()){case"stable":this.$68(this.$93("offer",a),"offer",c.attributes);break;case"have-local-offer":this.$68(this.$93("answer",a),"answer",c.attributes).then(function(){return this.$94()}.bind(this))["catch"](this.$57);break;case"have-remote-offer":setTimeout(function(){return this.$80(a)}.bind(this),1e3);break;case"have-local-pranswer":case"have-remote-pranswer":p("P2P SDP update unexpected signalingState %o",this.$3.getSignalingState());break;case"closed":break}this.$29(b("CollabCallMessengerBrowserEventEnum").SDP_UPDATE,[c.sdp,c.attributes])};m.prototype.$93=function(a,c){c=c.msg;var d=b("RTCP2PCallStore").getState();d=d.isPeerOnMobile;var e=b("RTCP2PCallStore").isCaller();return a==="offer"?!d&&e&&b("UserAgent").isBrowser("Firefox")?b("FBRTCSdpUtils").setDtlsRole(c.sdp,this.$10):c.sdp:b("FBRTCSdpUtils").setDtlsRole(c.sdp,d&&!e?"passive":this.$10)};m.prototype.$94=function(){this.$7=!1};m.prototype.$95=function(){if(b("RTCCallStore").hasLocalVideo()){var a=b("FBRTCExperiment").gen("rtc_www_limit_p2p_framerate");a=a.getBool("use_low_fps",!1);if(a){a=b("RTCCallStore").getState().localUser.streams.first();b("RTCUtils").limitFrameRate(a)}}};m.prototype.$68=function(a,c,d){__p&&__p();p("P2P SDP %o update %o %o",c,{sdp:a},d);this.$96(d);d=b("RTCP2PCallStore").getState();d=d.isPeerOnMobile;var e=b("FBRTCExperiment").gen("rtc_www_p2p_video_quality");e=e.getBool("use_sd",!1);(d||e)&&(this.$95(),a=b("FBRTCSdpUtils").setVideoBitrateConstraint(a));return this.$3.setRemoteDescription(new(b("RTCSessionDescription"))(i.P2P,{type:c,sdp:a})).then(function(){p("P2P drain remote ICE"),this.$17=!0,this.$16.drainCandidates(this.$1,this.$2,function(a){return this.$3.onReceivedRemoteIceCandidate(a)}.bind(this))}.bind(this)).then(function(){this.$60();return c!=="offer"?undefined:this.$3.createAnswer({ADD_FB_FEATURES:["video"]}).then(function(a){this.$64(a),this.$29(b("CollabCallMessengerBrowserEventEnum").SDP_UPDATE,{answer:a.toSdp()})}.bind(this))}.bind(this))["catch"](function(a){this.$57(a);throw a}.bind(this))};m.prototype.$96=function(a){__p&&__p();var c=this;a&&(function(){var d=a.streams;c.$4=babelHelpers["extends"]({},c.$4,a,{streams:babelHelpers["extends"]({},c.$4.streams,d)});Object.keys(d).some(function(a){if(d[a].type===b("FBRTCConstants").StreamType.SCREEN_CONTENT){b("RTCCallActions").removeAllLocalScreenStreams(!0);return!0}return!1})})()};m.prototype.$87=function(a){return a.call_id===this.$2?!0:Boolean((this.$19||!this.$18)&&(!this.$2||a.call_id!==this.$2)&&b("RTCP2PCallStore").isCaller()&&(!a.handlescollision||a.call_id<this.$2))};m.prototype.$79=function(a){__p&&__p();p("P2P handle %o","answer");var c=this.$3.getSignalingState();if(c!=="have-local-offer"){p("P2P ignore %o; wrong signaling state: %o","answer",c);return}c=a.msg;this.$67(!!c.negotiated_escalation_support,c.escalation_conference_name);this.$90();this.$91();this.$11.sendAnswerAck(this.$1,this.$2,c);b("RTCP2PCallActions").processMessage(a);b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").CONNECTING);this.$68(c.sdp,"answer",c.attributes).then(function(){this.$94(),b("RTCCallActions").callSuccess(!0)}.bind(this))["catch"](this.$57);this.$74(c)};m.prototype.$85=function(a){var b=a.msg;this.$12&&this.$12.isAckMsg(b)?(r(function(b){b.onMsgAckReceived(a,!0)}),this.$83(a)):this.$13&&this.$13.isAckMsg(b)&&(r(function(b){b.onMsgAckReceived(a,!1)}),this.$84())};m.prototype.$83=function(a){b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").RINGING),r(function(c){c.setUploadLogLevel(b("FBRTCUtils").getUploadLogLevel(b("FBRTCConstants").convertToUploadLogLevel(a.msg.ull)))}),this.$90()};m.prototype.$84=function(){this.$92(),this.$94(),b("RTCCallActions").incomingCallSuccess()};m.prototype.$81=function(a){var b=a.msg;b.call_id===this.$2&&this.$17?this.$3.onReceivedRemoteIceCandidate(b)["catch"](function(a){this.$97(b)}.bind(this)):this.$97(b)};m.prototype.$97=function(a){this.$16.cacheCandidate(this.$1,a.call_id,a)};m.prototype.$82=function(a){a=a.msg;var c=a.call_id,d=a.reason;a=a.subreason;c===this.$2?this.$32(d,!0,!1,!1,a):(this.$5.logError(this.$1,this.$2,"Receiving hangup for a different call: "+c.toString()),this.$29(b("CollabCallMessengerBrowserEventEnum").HANGUP_CALL_ID_MISSMATCH,c.toString()))};m.prototype.$32=function(a,c,d,e,f){__p&&__p();var g=new(b("RTCEndCallReason"))(a).setSubreason(f).setRemoteEnded(c);b("RTCCallActions").setEndCallReason(g);b("RTCP2PCallNUXActions").refreshNUXState();a=b("RTCP2PCallEscalationStore").getState().inProgress;a&&b("RTCP2PCallEscalationActions").cancel();this.$90();this.$91();this.$92();if(this.$76()){this.$5.logError(this.$1,this.$2,"Ending an already-ended call");return}this.$5.logCallAction(this.$1,this.$2,b("FBRTCLogger").CallAction.END_CALL,g.toStrName());this.$29(b("CollabCallMessengerBrowserEventEnum").CALL_ENDED,{reason:g.toStrName(),reasonID:g.getReasonID(),subReason:g.getSubreason(),isRemoteEnded:c,userCallType:this.$33()});d&&this.$86(this.$1,this.$2,g,e);this.$23.stop();this.$24.stop();this.$25.stop();this.$3&&this.$3.close();b("RTCCallActions").hangupSuccess();b("RTCCallActions").removeAllLocalStreams(!0);b("RTCCallActions").removeAllLocalScreenStreams(!0);b("RTCCallActions").removeAllRemoteStreams(this.$1);b("RTCP2PCallActions").setConnectionStatus(b("RTCP2PConnectionStatus").DISCONNECTED);r(function(a){a.setCallType(b("RTCP2PCallEscalationStore").getState().callType),a.setVideoDurations(this.$23.getDuration(),this.$24.getDuration()),a.setScreenDuration(this.$25.getDuration()),a.onCallEnded(g.getReasonID(),c,null,g.getSubreason())}.bind(this));b("MessengerRTCFunnelLogger").endFunnel("call_ended");g.getReasonID()===h.HANGUP_CALL&&g.getSubreason()==="CallReset"&&c&&b("RTCP2PCallWindowHandler").close()};m.prototype.$33=function(){var a=b("RTCCallStore").getState();a=a.localUser;return a.isVideoMuted()&&a.isAudioMuted()?b("RTCCallType").NO_AUDIO_VIDEO:a.isVideoMuted()&&!a.isAudioMuted()?b("RTCCallType").AUDIO_ONLY:b("RTCCallType").AUDIO_VIDEO};m.prototype.shutDownP2PListenersForMultiwayEscalation=function(){this.$90(),this.$91(),this.$92(),this.$23.stop(),this.$24.stop(),this.$3&&this.$3.removeAllListeners(),setTimeout(function(){b("RTCGroupCallEscalationStore").logToP2PCallSummary(function(a){a.setCallType(b("RTCP2PCallEscalationStore").getState().callType),a.setVideoDurations(this.$23.getDuration(),this.$24.getDuration()),a.setScreenDuration(this.$25.getDuration()),a.onCallEnded(h.HANGUP_CALL,!1,!1,"multiway escalation"),b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","log_endcallreason_in_summary")}.bind(this)),b("RTCCallActions").completeTransitionToMultiway()}.bind(this),100),this.destroy(),b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","destroy_p2p_handler")};m.prototype.$86=function(a,b,c,d){if(!this.$11)return;this.$11.sendHangup(a,b,c.getReasonID(),d,c.getSubreason());this.$11.sendOtherDismiss(b)};m.prototype.$90=function(){this.$12&&this.$12.stopRetrying()};m.prototype.$92=function(){this.$13&&this.$13.stopRetrying()};m.prototype.$91=function(){this.$19&&clearTimeout(this.$19),this.$19=null};m.prototype.$76=function(){return b("RTCCallStore").getState().callInfo.conferenceState===b("RTCConferenceState").TERMINATED};m.prototype.$53=function(a){__p&&__p();n(function(c){__p&&__p();c=c.logConnectionStats(function(){var c=a.getSignalingState();return c!=="closed"?a.getStats():b("Promise").reject("peer connection closed")},this.$1,this.$2);var d=c.start,e=c.stop,f=function(c){c=c.target;c=c.iceConnectionState;(c==="completed"||c==="connected")&&(p("P2P collab stats %o","start"),this.$5.logInfo(this.$1,this.$2,"Call Connected"),this.$29(b("CollabCallMessengerBrowserEventEnum").CALL_CONNECTED),d(),a.removeEventListener("iceconnectionstatechange",f),a.addEventListener("iceconnectionstatechange",g))}.bind(this),g=function b(c){c=c.target;c=c.iceConnectionState;c==="closed"&&(p("P2P collab stats %o","stop"),e(),a.removeEventListener("iceconnectionstatechange",b))};a.addEventListener("iceconnectionstatechange",f)}.bind(this))};m.prototype.$29=function(event,a){n(function(b){return b.log(event,{peerID:this.$1,callID:this.$2,eventDetails:a})}.bind(this))};m.prototype.destroy=function(){p("P2P %o","destroy()"),this.$27.clear(),b("FBRTCMessageListener").removeMessageHandler(),(this.$11.onMessageSent=null,this.$11.onSendFailure=null)};m.prototype.generateEscalationRequestToken=function(a){return this.$28.generateRequestToken(a)};m.prototype.generateEscalationResponseToken=function(a,b){return this.$28.generateResponseToken(a,b)};m.getDefaultVideoQuality=function(){if(b("FBRTCConfig").isVCEndpointCall())return j.HD_VIDEO;var a=b("FBRTCExperiment").gen("rtc_www_p2p_video_quality");a=a.getBool("use_sd",!1);return b("CurrentUser").isWorkUser()||a?j.SD_VIDEO:j.LQ_VIDEO};m.prototype.initV2CallSummary=function(a){a.setClientVersion("2.0"),a.setActiveConnection("p2p")};m.showRedialButton=function(){var a=b("RTCP2PCallStore").getState();a=a.endCallReason;var c=b("RTCCallStore").getState();c=c.callSummary;return a!=null&&(a.getReasonID()===h.IGNORE_CALL||a.getReasonID()===h.NO_ANSWER_TIMEOUT)||c.getCallDuration()<=l};function n(a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["CollabMessengerLogger"],a,"RTCP2PProtocolHandler")}function o(a){a instanceof Object||g(0);return a}function p(){}function q(){}function r(a){var c=b("RTCCallStore").getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())}e.exports=m}),null);
__d("RTCDialogProvider.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PureComponent;d=b("React").PropTypes;f=babelHelpers.inherits(a,c);g=f&&f.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={dialog:null},this.$1=function(a){this.setState({dialog:a})}.bind(this),this.$2=function(){var a=arguments.length<=0||arguments[0]===undefined?!1:arguments[0];a||this.setState({dialog:null})}.bind(this),b}a.prototype.getChildContext=function(){return{dialogShow:this.$1,dialogHide:this.$2}};a.prototype.render=function(){return b("React").createElement("div",this.props,this.props.children,this.state.dialog)};a.childContextTypes={dialogShow:d.func,dialogHide:d.func};e.exports=a}),null);
__d("WorkchatAppRTCBridge",["RTCCallActions"],(function(a,b,c,d,e,f){"use strict";a={toggleMuteAudio:function(){b("RTCCallActions").toggleMuteAudio(!1)},toggleMuteVideo:function(){b("RTCCallActions").toggleMuteVideo(!1)}};e.exports=a}),null);
__d("RTCAppView.react",["cx","React","RTCDialogProvider.react","WorkchatAppRTCBridge"],(function(a,b,c,d,e,f,g){"use strict";b("WorkchatAppRTCBridge");a=function(a){var c=a.children,d=a.isAudioCall;d=d===undefined?!1:d;a=babelHelpers.objectWithoutProperties(a,["children","isAudioCall"]);return b("React").createElement(b("RTCDialogProvider.react"),babelHelpers["extends"]({className:"_32ut"+(d?" _32uu":"")},a),c)};e.exports=a}),null);
__d("MediaAccessErrorParser",["FBRTCLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={printUserMediaRequestError:function(a){__p&&__p();if(a==null)return"Unknown Error";switch(a.name){case"AbortError":return"Hardware Access aborted.";case"NotAllowedError":return"Access to Media Devices has been denied.";case"NotFoundError":return"Devices matching requirements were not found or were not accessible.";case"NotReadableError":return"Hardware Access Error.";case"OverconstrainedError":return"Media Constraints not met.";case"SecurityError":return"User media support is disabled.";case"TypeError":return"Media Constraints corrupted.";default:b("FBRTCLogger").getInstance().logErrorWithoutID(a);return a.message?a.message:"Unknown Error"}}};e.exports=a}),null);
__d("RTCSVGIcon.react",["React"],(function(a,b,c,d,e,f){"use strict";var g=b("React").Children;a=function(a){var c=a.children;a=babelHelpers.objectWithoutProperties(a,["children"]);return b("React").cloneElement(g.only(c),babelHelpers["extends"]({preserveAspectRatio:"xMidYMid meet"},a))};e.exports=a}),null);
__d("RTCSVGIconCatalog",["React"],(function(a,b,c,d,e,f){"use strict";a={noCameraIcon:b("React").createElement("svg",{viewBox:"0 0 48 48"},b("React").createElement("path",{d:"M36 29h1V19h-1v10zm-6-2.727L35 29V19l-5 2.727v4.546zM19.344 17H26c1.126 0 2 .938 2 2v10c0 .54-.225 1.047-.595 1.415L19.345 17zm-3.5 0H15c-1.126 0-2 .938-2 2v10c0 1.062.874 2 2 2h9.257l-8.413-14zm11.408 17.044l.857-.516-12.362-20.572-.857.516 12.362 20.572z",fillRule:"evenodd"})),noMicIcon:b("React").createElement("svg",{viewBox:"0 0 48 48"},b("React").createElement("path",{d:"M25 31c.7-.1 1.3-.3 1.9-.6l-.5-.9c-.6.3-1.2.5-1.9.5-2.5 0-4.5-2.2-4.5-5v-5h-1v5.2c0 3.1 2.2 5.6 5 5.8v3h-3v1h7v-1h-3v-3zm-.5-2c.5 0 1-.1 1.4-.3L21 20.6v4.9c0 1.9 1.6 3.5 3.5 3.5zm-5.8-16l-.9.5L30.3 34l.9-.5L18.7 13zM30 25.2V20h-1v5c0 .8-.2 1.6-.5 2.2l.6 1c.6-.8.9-1.9.9-3zm-2 .3v-9c0-1.9-1.6-3.5-3.5-3.5-1.5 0-2.7.9-3.2 2.2L28 26.3v-.8z"}))};e.exports=a}),null);
__d("RTCUserMediaRequestState",["keyMirror"],(function(a,b,c,d,e,f){"use strict";a=b("keyMirror")({FULFILLED:null,PENDING:null,REJECTED:null});e.exports=a}),null);
__d("RTCGrantUserMediaAccessView.react",["cx","fbt","FBRTCConfig","Link.react","MediaAccessErrorParser","React","RTCSVGIcon.react","RTCSVGIconCatalog","RTCUserMediaRequestState","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){a.children;var c=a.className,d=a.isAudioCall;d=d===undefined?!1:d;var e=a.userMediaRequest;a=babelHelpers.objectWithoutProperties(a,["children","className","isAudioCall","userMediaRequest"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")(c,"_5ajm"+(d?" _4w_w":""))},a),b("React").createElement(i,{isAudioCall:d,userMediaRequest:e}),b("React").createElement("p",{className:"_5b2y"},d?h._("To make a call on Facebook, you need to turn your microphone on. This will let people hear you during the call."):h._("To make a call on Facebook, you need to turn your camera and microphone on. This will let people see and hear you during the call.")),b("React").createElement("p",{className:"_5b2y"},d?h._("You can turn this off later."):h._("You can turn these off later.")," ",b("React").createElement(b("Link.react"),{href:b("FBRTCConfig").userMediaPermissionErrorUrl(),target:"_blank"},h._("Learn more"))))};var i=function(a){var c=a.isAudioCall;a=a.userMediaRequest;return b("React").createElement("header",{className:"_5ajs"},b("React").createElement("div",{className:"_5b02"},c?null:b("React").createElement(b("RTCSVGIcon.react"),{className:"_5b34"+(a.state===b("RTCUserMediaRequestState").REJECTED?" _4w_y":"")},b("RTCSVGIconCatalog").noCameraIcon),b("React").createElement(b("RTCSVGIcon.react"),{className:"_5b34"+(a.state===b("RTCUserMediaRequestState").REJECTED?" _4w_y":"")},b("RTCSVGIconCatalog").noMicIcon)),b("React").createElement(j,{isAudioCall:c,userMediaRequest:a}))},j=function(a){var c=a.isAudioCall;a=a.userMediaRequest;return a.state===b("RTCUserMediaRequestState").REJECTED?b("React").createElement(b("React").Fragment,null,b("React").createElement("h1",{className:"_5b03"},c?h._("An Error occured when trying to get access to Microphone:"):h._("An Error occured when trying to get access to Camera and\/or Microphone:")),b("React").createElement("p",{className:"_4x0t"},b("MediaAccessErrorParser").printUserMediaRequestError(a.error))):b("React").createElement("h1",{className:"_5b03"},c?h._("Please Allow Microphone Access"):h._("Please Allow Camera and Microphone Access"))};e.exports=a}),null);
__d("FBRTCGroupCallFluidGridView.react",["cx","immutable","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={landscape:!0},this.$1=function(){this.setState({landscape:window.innerHeight<=window.innerWidth})}.bind(this),b}a.prototype.componentDidMount=function(){this.$1(),window.addEventListener("resize",this.$1)};a.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.$1)};a.prototype.render=function(){return b("React").createElement("div",{className:"_2rid"+(this.state.landscape?"":" column")+(this.props.hidden?" hide":"")},b("React").createElement(i,{landscape:this.state.landscape,remoteUsers:this.props.remoteUsers,renderUser:this.props.renderUser}))};var i=function a(c){var d=c.remoteUsers,e=c.landscape,f=c.renderUser;return d.size===1?f(d.first()):j(d).map(function(c,d){return b("React").createElement("div",{className:"_2rip"+(e?" column":"")+(c.size===3?" big":""),key:d},b("React").createElement(a,{landscape:!e,remoteUsers:c,renderUser:f}))})};function j(a){if(a.size===2)return a.map(function(a){return b("immutable").List([a])});else if(a.size<7||a.size%2==0)return b("immutable").Range(0,a.size,2).map(function(b){return a.slice(b,b+2)}).toList();else return b("immutable").Range(0,a.size-3,2).map(function(b){return a.slice(b,b+2)}).toList().push(a.takeLast(3))}e.exports=a}),null);
__d("RTCAudio.react",["cx","FBRTCUtils","MediaStream","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;h=babelHelpers.inherits(a,c);h&&h.prototype;a.prototype.render=function(){return b("React").createElement("audio",{autoPlay:!0,className:b("joinClasses")(this.props.className,"_8md"),controls:!1,muted:this.props.muted,ref:function(a){return this.$1=a}.bind(this)})};a.prototype.componentDidMount=function(){this.$2(),this.$3()};a.prototype.$2=function(){__p&&__p();if(!this.$1)return;var a=this.props.mediaStream;if(a&&a.getVideoTracks().length>0){var c=new(b("MediaStream"))();for(var d=a.getAudioTracks(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.addTrack(g)}b("FBRTCUtils").attachMediaStream(this.$1,c)}else b("FBRTCUtils").attachMediaStream(this.$1,a)};a.prototype.$3=function(){if(!this.$1)return;var a=this.props.audioSinkID;a&&this.$1.setSinkId&&this.$1.setSinkId(a)};a.prototype.componentDidUpdate=function(a){var b=a.audioSinkID;a=a.mediaStream;a!==this.props.mediaStream&&this.$2();b!==this.props.audioSinkID&&this.$3()};function a(){h.apply(this,arguments)}a.defaultProps={muted:!1};e.exports=a}),null);
__d("RTCIncallAudio.react",["React","RTCAudio.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PureComponent;g=babelHelpers.inherits(a,c);g&&g.prototype;a.prototype.render=function(){var a=this.props,c=a.audioSinkID;a.className;var d=a.mediaStream;a=babelHelpers.objectWithoutProperties(a,["audioSinkID","className","mediaStream"]);return b("React").createElement("div",a,b("React").createElement(b("RTCAudio.react"),{audioSinkID:c,mediaStream:d}))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("RTCMediaStreamReadyContainer.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={active:!1},this.$2=function(){__p&&__p();var a=this.props.mediaStream;if(!a)return;if("active"in a){var b=a.active;this.setState({active:b});b||(this.$1=setTimeout(this.$2,100))}else{b=a.getVideoTracks();if(b.some(function(a){return a.readyState==="live"}))this.setState({active:!0});else for(var a=b,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.addEventListener("started",this.$3)}}}.bind(this),this.$3=function(){__p&&__p();var a=this.props.mediaStream;if(!a)return;this.setState({active:!0});for(var a=a.getVideoTracks(),b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}d=d;d.removeEventListener("started",this.$3)}}.bind(this),b}a.prototype.render=function(){return this.props.children(this.state.active)};a.prototype.componentDidMount=function(){this.$2()};a.prototype.componentDidUpdate=function(a,b){this.props.mediaStream!==a.mediaStream&&(this.setState({active:!1}),clearTimeout(this.$1),this.$2())};a.prototype.componentWillUnmount=function(){this.setState({active:!1}),clearTimeout(this.$1)};e.exports=a}),null);
__d("RTCIncallVideo.react",["cx","FBRTCVideo.react","React","RTCMediaStreamReadyContainer.react","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=null,this.state={mounted:!1},this.$2=function(a){var c=this.props,d=c.audioSinkID,e=c.className,f=c.mediaStream,g=c.muted;c=babelHelpers.objectWithoutProperties(c,["audioSinkID","className","mediaStream","muted"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")(e,"_chh"+(a&&!g&&this.state.mounted?" active":""))},c),b("React").createElement(b("FBRTCVideo.react"),babelHelpers["extends"]({"data-testid":b("VideoCallWebDriverIDs").RTC_INCALL_VIDEO},{audioSinkID:d,mediaStream:f})),this.props.children)}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("RTCMediaStreamReadyContainer.react"),{mediaStream:this.props.mediaStream},this.$2)};a.prototype.componentWillUnmount=function(){clearTimeout(this.$1)};a.prototype.componentDidMount=function(){this.$1=setTimeout(function(){return this.setState({mounted:!0})}.bind(this))};a.defaultProps={muted:!1};e.exports=a}),null);
__d("FBRTCGroupCallIncallVideo.react",["cx","fbt","Image.react","React","RTCIncallAudio.react","RTCIncallVideo.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){var c=a.displayNone;c=c===undefined?!1:c;var d=a.isAudioCall;d=d===undefined?!1:d;a=a.user;var e=a.getMainStream();return e&&!a.areAllTracksMuted(e.getVideoTracks())?b("React").createElement(b("RTCIncallVideo.react"),{className:"_5k9_"+(c?" none":""),mediaStream:e}):b("React").createElement("div",{className:"_5k9_"+(c?" none":"")+(d?" hidden":"")},b("React").createElement("div",{className:"_2_gq"},b("React").createElement(b("Image.react"),{className:"_2_gr",src:a.profilePictureUrl}),b("React").createElement(b("Image.react"),{className:"_2_gs",src:a.profilePictureUrl,alt:h._("Profile Picture")}),b("React").createElement("p",{className:"_5ka3"},h._("{name}'s camera is off",[h._param("name",a.userShortName)])),b("React").createElement(b("RTCIncallAudio.react"),{mediaStream:e})))};e.exports=a}),null);
__d("XFacebookMessengerInboxController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messages/t/{?thread_key}/",{thread_key:{type:"String"},mid:{type:"String"},ref:{type:"String"},ds:{type:"Int"},sender:{type:"Bool",defaultValue:!1},hide_header:{type:"Bool",defaultValue:!1}})}),null);
__d("FBRTCGroupCallUserPopoverMenu.react",["cx","fbt","MessengerMenu.react","MessengerPopoverMenu.react","React","XFacebookMessengerInboxController","XMessengerDotComMainController","URI","isMessengerDotComURI"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("MessengerMenu.react").Item,j=b("MessengerMenu.react").Separator;a=function(a){var c=a.children,d=a.user;a=b("React").createElement(b("MessengerMenu.react"),{className:"_2vmq"},b("React").createElement(i,{label:d.userName,disabled:!0}),b("React").createElement(j,null),b("React").createElement(i,{label:h._("Message"),onclick:function(){return k(d.FBID)}}),b("React").createElement(i,{label:h._("View Profile"),onclick:function(){return l(d.profileUrl)}}));return b("React").createElement(b("MessengerPopoverMenu.react"),{menu:a},c)};function k(a){var c=b("isMessengerDotComURI")(b("URI").getRequestURI())?b("XMessengerDotComMainController"):b("XFacebookMessengerInboxController");window.open(c.getURIBuilder().setString("thread_key",a).getURI())}function l(a){a&&window.open(a)}e.exports=a}),null);
__d("RTCRemoteViewPopoverMenuButton.react",["cx","FBRTCGroupCallUserPopoverMenu.react","React","RTCSVGIcon.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){a=a.user;return b("React").createElement(b("FBRTCGroupCallUserPopoverMenu.react"),{user:a},b("React").createElement("div",{className:"_1b12",onClick:h,role:"presentation"},b("React").createElement(b("RTCSVGIcon.react"),null,b("React").createElement("svg",{viewBox:"-10 -6 24 24"},b("React").createElement("path",{d:"M2.157 11.057c-1.013 0-1.843.83-1.843 1.843 0 1.014.83 1.843 1.843 1.843C3.17 14.743 4 13.913 4 12.9c0-1.014-.83-1.843-1.843-1.843zm0-1.843C3.17 9.214 4 8.384 4 7.37c0-1.012-.83-1.84-1.843-1.84S.314 6.357.314 7.37c0 1.015.83 1.844 1.843 1.844zm0-5.528C3.17 3.686 4 2.856 4 1.843 4 .83 3.17 0 2.157 0S.314.83.314 1.843s.83 1.843 1.843 1.843z"})))))};function h(a){a.stopPropagation()}e.exports=a}),null);
__d("FBRTCGroupCallIncallView.react",["cx","FBRTCConstants","FBRTCGroupCallFluidGridView.react","FBRTCGroupCallIncallVideo.react","FBRTCGroupCallStore","FluxContainer","React","RTCRemoteViewPopoverMenuButton.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("FBRTCConstants").GroupVideoViewLayout,i=6;d=function(a){var c=a.dominantSpeakerFBID,d=a.isAudioCall,e=a.layout,f=a.pinnedSpeakerFBID,g=a.remoteUsers;switch(e){case h.DOMINANT_SPEAKER:a=g.find(function(a){return a.FBID===(f||c)});return a?b("React").createElement("div",{className:"_ncs"},b("React").createElement(b("FBRTCGroupCallIncallVideo.react"),{isAudioCall:d,user:a})):null;case h.GRID:return b("React").createElement(b("FBRTCGroupCallFluidGridView.react"),{hidden:d,remoteUsers:g,renderUser:function(a){return b("React").createElement("div",{className:"_2rik"},b("React").createElement(b("FBRTCGroupCallIncallVideo.react"),{user:a}),b("React").createElement("div",{className:g.size>1?"_2ril":null},b("React").createElement(b("RTCRemoteViewPopoverMenuButton.react"),{user:a})))}});default:return b("React").createElement("div",{className:"_ncs"},g.map(function(a,c){return b("React").createElement(b("FBRTCGroupCallIncallVideo.react"),{displayNone:c>=i,isAudioCall:d,key:a.FBID,user:a})}))}};function a(){return[b("FBRTCGroupCallStore")]}function c(){arguments.length<=0||arguments[0]===undefined?({}):arguments[0];var a=arguments[1],c=b("FBRTCGroupCallStore").getState(),d=c.dominantSpeakerFBID,e=c.pinnedSpeakerFBID;return babelHelpers["extends"]({dominantSpeakerFBID:d,pinnedSpeakerFBID:e},a)}e.exports=b("FluxContainer").createFunctional(d,a,c,{withProps:!0})}),null);
__d("RTCAppSpinner.react",["cx","MessengerSpinner.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){a=a.className;return b("React").createElement(b("MessengerSpinner.react"),{className:b("joinClasses")("_4ywx",a),color:"blue",size:32})};e.exports=a}),null);
__d("RTCAppViewMain.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className,e=a.fullBleed;e=e===undefined?!0:e;a=babelHelpers.objectWithoutProperties(a,["children","className","fullBleed"]);return b("React").createElement("section",babelHelpers["extends"]({className:b("joinClasses")("_3cb2"+(e?" fullBleed":""),d)},a),c)};e.exports=a}),null);
__d("RTCCallConnectionStatus.react",["cx","fbt","FBRTCCallTimer.react","React","RTCP2PConnectionStatus","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PureComponent;i=babelHelpers.inherits(a,c);i&&i.prototype;a.prototype.render=function(){var a=this.props,c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")(d,"_46la")},a),c!=null?c:this.$2())};a.prototype.$2=function(){switch(this.props.connectionStatus){case b("RTCP2PConnectionStatus").CONTACTING:return h._("Contacting...");case b("RTCP2PConnectionStatus").RINGING:return h._("Ringing...");case b("RTCP2PConnectionStatus").CONNECTING:return h._("Connecting...");case b("RTCP2PConnectionStatus").RECONNECTING:return h._("Reconnecting...");case b("RTCP2PConnectionStatus").CONNECTED:this.$1||(this.$1=Math.floor(Date.now()/1e3));return b("React").createElement(b("FBRTCCallTimer.react"),{start:this.$1});case b("RTCP2PConnectionStatus").DISCONNECTED:return h._("Call Ended");default:return null}};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("RTCCallStateInfo.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")("_2_my",d)},a),c)};e.exports=a}),null);
__d("RTCGroupCallDraggableComponent.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PureComponent;var h=5;d=babelHelpers.inherits(a,c);g=d&&d.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$2=!1,this.$3=0,this.$4=0,this.$5=0,this.$10=function(a){a&&(this.$1=a)}.bind(this),this.$8=function(a){this.$2&&(a.stopPropagation(),this.$2=!1)}.bind(this),this.$9=function(a){var b=a.clientX;a=a.clientY;this.$1&&(this.$3=b,this.$4=a,this.$5=this.$1.scrollLeft+b,document.addEventListener("mousemove",this.$6),document.addEventListener("mouseup",this.$7))}.bind(this),this.$6=function(a){var b=a.clientX;a=a.clientY;this.$1&&(this.$1.scrollLeft=this.$5-b,(Math.abs(b-this.$3)>h||Math.abs(a-this.$4)>h)&&(this.$2=!0))}.bind(this),this.$7=function(){document.removeEventListener("mousemove",this.$6),document.removeEventListener("mouseup",this.$7)}.bind(this),b}a.prototype.componentWillUnmount=function(){document.removeEventListener("mousemove",this.$6),document.removeEventListener("mouseup",this.$7)};a.prototype.render=function(){return b("React").createElement("div",{className:this.props.className,onClickCapture:this.$8,onMouseDown:this.$9,ref:this.$10},this.props.children)};e.exports=a}),null);
__d("AudioContextSingleton",[],(function(a,b,c,d,e,f){var g=window.AudioContext||window.webkitAudioContext,h=null;a={get:function(){h==null&&(h=new g());return h}};e.exports=a}),null);
__d("RTCGroupCallRosterUser.react",["cssVar","cx","fbt","AudioContextSingleton","DOM","FBRTCParticipantCallState","MessengerContactImage.react","React","ReactDOM","Tooltip"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PureComponent;var k="rgba(0, 132, 255, 0.5)",l=48;d=babelHelpers.inherits(a,c);j=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=j.constructor).call.apply(a,[this].concat(e)),this.state={audioLevel:0},this.$1=b("DOM").create("div"),this.$2=!1,this.$3=null,c}a.prototype.componentDidMount=function(){this.$4(),this.$5()};a.prototype.componentDidUpdate=function(a){a=a.user;var b=this.props.user.participantState;a=a.participantState;if(!b||!a)return;b.state!==a.state&&this.$4();this.$5()};a.prototype.componentWillUnmount=function(){this.$6()};a.prototype.render=function(){var a=this.props.user.participantState;return!a?null:b("React").createElement("div",{className:"_2bcu",style:{boxShadow:"0 0 0 "+this.state.audioLevel+"px "+k}},b("React").createElement(b("MessengerContactImage.react"),{ref:"image",className:"_2z_7"+(a.state!==b("FBRTCParticipantCallState").CONNECTED?" _25d9":""),size:l,src:this.props.user.profilePictureUrl}))};a.prototype.$4=function(){b("ReactDOM").render(b("React").createElement("div",{className:"_25d6"},b("React").createElement("div",{className:"_25d7"},this.props.user.userName),b("React").createElement("div",{className:"_25d8"},this.$7())),this.$1),b("Tooltip").set(b("ReactDOM").findDOMNode(this.refs.image),this.$1,"above","center")};a.prototype.$5=function(){__p&&__p();var a=this.props.user;a=a.getMainStream();if(!this.$2&&a&&a.getAudioTracks().length>0){this.$2=!0;var c=b("AudioContextSingleton").get();a=c.createMediaStreamSource(a);c=c.createAnalyser();var d=new Uint8Array(c.frequencyBinCount);a.connect(c);this.$8(c,d)}};a.prototype.$6=function(){this.$2=!1,cancelAnimationFrame(this.$3)};a.prototype.$8=function(a,b){this.$3=requestAnimationFrame(function(){if(this.$2){a.getByteFrequencyData(b);var c=b.reduce(function(a,b){return a+b});this.setState({audioLevel:Math.floor(c/a.frequencyBinCount/256*40)});this.$8(a,b)}}.bind(this))};a.prototype.$7=function(){var a=this.props.user.participantState;if(!a)return null;switch(a.state){case b("FBRTCParticipantCallState").CONTACTING:return i._("Contacting...");case b("FBRTCParticipantCallState").RINGING:return i._("Ringing...");case b("FBRTCParticipantCallState").CONNECTING:return i._("Connecting...");case b("FBRTCParticipantCallState").CONNECTED:return i._("Connected");default:return null}};e.exports=a}),null);
__d("RTCGroupCallRosterRow.react",["cx","FBRTCGroupCallUserPopoverMenu.react","FBRTCParticipantCallState","MessengerContactImage.react","React","RTCGroupCallDraggableComponent.react","RTCGroupCallRosterUser.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=48;a=function(a){var c=a.localUser;a=a.remoteUsers;return b("React").createElement(b("RTCGroupCallDraggableComponent.react"),{className:"_1a8c"},a.filter(function(a){return i(a.participantState)}).map(function(a){return b("React").createElement(b("FBRTCGroupCallUserPopoverMenu.react"),{key:a.FBID,isMessengerUser:c.isMessengerUser,user:a},b("React").createElement(b("RTCGroupCallRosterUser.react"),{user:a}))}),b("React").createElement(b("MessengerContactImage.react"),{className:"_1a8d",isMessengerUser:c.isMessengerUser,size:h,src:c.profilePictureUrl}))};function i(a){if(a)switch(a.state){case b("FBRTCParticipantCallState").CONTACTING:case b("FBRTCParticipantCallState").RINGING:case b("FBRTCParticipantCallState").CONNECTING:case b("FBRTCParticipantCallState").CONNECTED:return!0}return!1}e.exports=a}),null);
__d("RTCGroupCallStateInfo.react",["cx","fbt","CurrentUser","FBRTCCallTimer.react","MercuryParticipantsImage.react","MercuryThreadTitle.react","MessengerProfileImageWrapperReact.bs","MessengerThreadImageReact.bs","React","RTCCallTitle.react","RTCConferenceState","RTCGroupCallRosterRow.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("MessengerProfileImageWrapperReact.bs").jsComponent,k=b("MessengerThreadImageReact.bs").jsComponent;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={start:0},b}a.getDerivedStateFromProps=function(a,c){var d=a.conferenceState;a=a.initialStartTime;a=a||Date.now();return c.start===0&&d===b("RTCConferenceState").CONNECTED?babelHelpers["extends"]({},c,{start:Math.floor(a/1e3)}):null};a.prototype.render=function(){return b("React").createElement("div",{className:"_4j_i"},this.$1())};a.prototype.$1=function(){var a=!this.props.isAudioCall&&this.props.conferenceState!==b("RTCConferenceState").TERMINATED;return a?null:b("React").createElement("div",{className:"_4j_i"},this.renderPeerImage(),this.renderMessage(),this.renderSubMessage(),this.renderParticipants())};a.prototype.renderPeerImage=function(){var a=this.props.participants.filter(function(a,b){return!a.is_parties_user}),c=Array.from(this.props.participants.filter(function(a,b){return a.is_parties_user}).map(function(a,b){return a.image_src}).values());return this.props.thread?b("React").createElement(k,{className:"_4j_j",participants:this.props.participants,size:100,thread:this.props.thread,viewer:b("CurrentUser").getID()}):b("React").createElement(j,{className:"_4j_j",size:100,showBadge:!1},b("React").createElement(b("MercuryParticipantsImage.react"),{participants:Object.keys(a.toJS()),partiesProfileImages:c,size:100}))};a.prototype.renderMessage=function(){return this.props.conferenceState===b("RTCConferenceState").AWAITING_USER_START?this.props.thread?b("React").createElement("p",{className:"_fjp"},h._("Ready to call {name}?",[h._param("name",b("React").createElement(b("MercuryThreadTitle.react"),{thread:this.props.thread,viewer:b("CurrentUser").getID()}))])):b("React").createElement("p",{className:"_fjp"},h._("Ready to call {name}?",[h._param("name",b("React").createElement(b("RTCCallTitle.react"),{participants:this.props.participants,viewer:b("CurrentUser").getID()}))])):this.props.thread?b("React").createElement("p",{className:"_fjp"},b("React").createElement(b("MercuryThreadTitle.react"),{thread:this.props.thread,viewer:b("CurrentUser").getID()})):b("React").createElement("p",{className:"_fjp"},b("React").createElement(b("RTCCallTitle.react"),{participants:this.props.participants,viewer:b("CurrentUser").getID()}))};a.prototype.renderSubMessage=function(){var a=this.props.callMessage;return b("React").createElement("p",{className:"_fjq"},a||this.$2(this.props.conferenceState))};a.prototype.$2=function(a){switch(a){case b("RTCConferenceState").CONNECTING:return h._("Contacting...");case b("RTCConferenceState").CONNECTED:return this.state.start>0?b("React").createElement(b("FBRTCCallTimer.react"),{start:this.state.start}):null;case b("RTCConferenceState").TERMINATING:return h._("Hanging up...");case b("RTCConferenceState").TERMINATED:return h._("Call Ended");default:return null}};a.prototype.renderParticipants=function(){return this.props.conferenceState!==b("RTCConferenceState").CONNECTING&&this.props.conferenceState!==b("RTCConferenceState").CONNECTED?null:b("React").createElement("div",{className:"_5-tc"},b("React").createElement(b("RTCGroupCallRosterRow.react"),{localUser:this.props.localUser,remoteUsers:this.props.remoteUsers}))};e.exports=a}),null);
__d("RTCRingBackTone.react",["React","RTCConfig","Sound"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").Component;var h=[b("RTCConfig").ringback_mp3_url,b("RTCConfig").ringback_ogg_url];d=babelHelpers.inherits(a,c);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={isPlaying:!1},b}a.prototype.componentDidMount=function(){this.$1(this.props.active)};a.prototype.componentDidUpdate=function(){this.$1(this.props.active)};a.prototype.componentWillUnmount=function(){this.$2()};a.prototype.render=function(){if(this.props.active)return b("React").createElement("div",{display:"none",id:"RingTonePlaying"});else return null};a.prototype.$1=function(a){a?this.$3():this.$2()};a.prototype.$3=function(){this.state.isPlaying||this.setState({isPlaying:!0},function(){b("Sound").play(h,null,!0)})};a.prototype.$2=function(){this.state.isPlaying&&(this.setState({isPlaying:!1}),b("Sound").stop(h))};a.defaultProps={active:!1};e.exports=a}),null);
__d("RTCDialog.react",["fbt","LayerFadeOnHide","LayerTabIsolation","React","XUIDialog.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children;a=babelHelpers.objectWithoutProperties(a,["children"]);return b("React").createElement(b("XUIDialog.react"),babelHelpers["extends"]({behaviors:{LayerFadeOnHide:b("LayerFadeOnHide"),LayerTabIsolation:b("LayerTabIsolation")},hideOnEscape:!0,label:g._("Real time communication {child_label}",[g._param("child_label",a.label)]),shown:!0},a),c)};e.exports=a}),null);
__d("RTCDialogBody.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")(d,"_zbh")},a),c)};e.exports=a}),null);
__d("RTCDialogHeader.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement("header",babelHelpers["extends"]({className:b("joinClasses")(d,"_7xt")},a),c)};e.exports=a}),null);
__d("RTCDialogHeaderButton.react",["cx","AbstractButton.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.className;a=babelHelpers.objectWithoutProperties(a,["className"]);return b("React").createElement(b("AbstractButton.react"),babelHelpers["extends"]({type:"button",className:b("joinClasses")(c,"_4py8"),label:a.label},a))};e.exports=a}),null);
__d("RTCFeedbackView.react",["cx","fbt","React","AbstractTextArea.react","RTCCallActions","RTCDialog.react","RTCDialogBody.react","RTCDialogHeader.react","RTCDialogHeaderButton.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={feedbackMessage:null},this.$3=function(){this.props.rating!=null&&b("RTCCallActions").submitRating(this.props.rating),this.props.onDone()}.bind(this),this.$4=function(){this.props.rating!=null&&b("RTCCallActions").submitRating(this.props.rating),this.state.feedbackMessage&&b("RTCCallActions").submitFeedback(this.state.feedbackMessage),this.props.onDone()}.bind(this),c}a.prototype.render=function(){return b("React").createElement("section",null,b("React").createElement(b("RTCDialog.react"),{height:447,hideOnEscape:!1,label:"Video call feedback",layerHideOnBlur:!1,width:544},this.$1(),this.$2()))};a.prototype.$1=function(){return b("React").createElement(b("RTCDialogHeader.react"),null,b("React").createElement("h1",{className:"_10mm"},h._("Give Feedback")),b("React").createElement(b("RTCDialogHeaderButton.react"),{label:h._("Not Now"),onClick:this.$3}),b("React").createElement(b("RTCDialogHeaderButton.react"),{label:h._("Submit"),onClick:this.$4}))};a.prototype.$2=function(){return b("React").createElement(b("RTCDialogBody.react"),null,b("React").createElement(b("AbstractTextArea.react"),{className:"_6162",placeholder:h._("Describe the problem..."),value:this.state.feedbackMessage,onChange:function(a){return this.setState({feedbackMessage:a.target.value})}.bind(this)}))};e.exports=a}),null);
__d("RTCStarRatingInput.react",["cx","React","RTCSVGIcon.react","TooltipLink.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={starsShown:null},this.$3=function(){this.setState({starsShown:null}),this.props.onHover(null)}.bind(this),b}a.prototype.render=function(){var a=this.props.rating,c=this.state.starsShown,d=c!=null?c:a||0;c=Array.from({length:this.props.count}).map(function(a,c){return b("React").createElement(b("TooltipLink.react"),{alignH:"center",className:"_2r1w",key:c,onClick:function(){return this.$1(c+1)}.bind(this),onMouseEnter:function(){return this.$2(c+1)}.bind(this),onMouseLeave:this.$3,position:"above"},b("React").createElement(i,{selected:c<d}))}.bind(this));return b("React").createElement("div",{className:b("joinClasses")("_2r1x",this.props.className)},c)};a.prototype.$2=function(a){this.setState({starsShown:a}),this.props.onHover(a)};a.prototype.$1=function(a){this.props.onClick(a)};a.defaultProps={count:5};var i=function(a){a.className;var c=a.selected;a=babelHelpers.objectWithoutProperties(a,["className","selected"]);return b("React").createElement(b("RTCSVGIcon.react"),babelHelpers["extends"]({className:"_2r1y"},a),b("React").createElement("svg",{viewBox:"0 0 25 23"},b("React").createElement("path",{d:"M12.1 1L9.5 9H1l6.9 5-2.7 8 6.9-5 6.8 5-2.6-8 6.8-5h-8.5z",fill:c?"":"none"})))};e.exports=a}),null);
__d("RTCTextButton.react",["cx","AbstractButton.react","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.className;a=babelHelpers.objectWithoutProperties(a,["className"]);return b("React").createElement(b("AbstractButton.react"),babelHelpers["extends"]({className:b("joinClasses")(c,"_5lc4")},a))};e.exports=a}),null);
__d("RTCStarRating.react",["cx","fbt","FBRTCLogger","React","RTCCallActions","RTCFeedbackView.react","RTCStarRatingInput.react","RTCTextButton.react","VideoCallWebDriverIDs","dangerouslyBypassDispatchError"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PureComponent;function j(a){__p&&__p();var c="";switch(a.rating){case 1:c=h._("Poor");break;case 2:c=h._("Fair");break;case 3:c=h._("Good");break;case 4:c=h._("Very Good");break;case 5:c=h._("Excellent");break}return b("React").createElement("p",{className:a.isConfirmed?"_66tb":"_4a-c"},c)}d=babelHelpers.inherits(a,c);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={confirmedRating:null,previewRating:null,promptFeedback:!1},this.$3=function(a){this.setState({previewRating:a})}.bind(this),this.$2=function(a){this.setState({confirmedRating:a})}.bind(this),this.$5=function(){if(this.state.confirmedRating!=null){if(this.state.confirmedRating===1){this.setState({promptFeedback:!0});return}b("RTCCallActions").submitRating(this.state.confirmedRating)}this.props.onDone();this.props.shouldCloseWindow&&window.close()}.bind(this),c}a.prototype.render=function(){return this.state.promptFeedback?b("React").createElement(b("RTCFeedbackView.react"),{onDone:this.props.onDone,rating:this.state.confirmedRating}):b("React").createElement("section",{className:"_4a-a","data-testid":b("VideoCallWebDriverIDs").STAR_RATING_VIEW},this.$1(),b("React").createElement(b("RTCStarRatingInput.react"),{className:"_4a-b",onClick:this.$2,onHover:this.$3,rating:this.state.previewRating||this.state.confirmedRating}),b("React").createElement(j,{isConfirmed:this.state.confirmedRating!=null&&(this.state.previewRating==null||this.state.previewRating==this.state.confirmedRating),rating:this.state.previewRating||this.state.confirmedRating}),this.$4())};a.prototype.$1=function(){var a=this.props.isAudioCall?h._("Please rate the quality of your audio call"):h._("Please rate the quality of your video call");return b("React").createElement("p",{className:"_4a-d"},a)};a.prototype.$4=function(){var a=this.props,c=a.isAudioCall;a=a.isGroupCall;return this.state.confirmedRating===null?b("React").createElement(b("RTCTextButton.react"),{className:"_4a-e hollow"+(!c&&!a?" white":"")+(c||a?" blue":""),label:h._("Not now"),onClick:this.$5}):b("React").createElement(b("RTCTextButton.react"),{className:"_4a-e"+(!c&&!a?" white":"")+(c||a?" blue":""),label:h._("Submit"),onClick:this.$5})};a.prototype.componentDidMount=function(){try{b("RTCCallActions").ratingShown()}catch(a){b("dangerouslyBypassDispatchError")(function(){return b("RTCCallActions").ratingShown()})}};a.defaultProps={shouldCloseWindow:!1};e.exports=a}),null);
__d("RTCThreadInfo.react",["cx","CurrentUser","MercuryParticipantsImage.react","MercuryThreadTitle.react","MessengerProfileImageWrapperReact.bs","MessengerThreadImageReact.bs","MercuryParticipantsConstants","React","RTCCallTitle.react"],(function(a,b,c,d,e,f,g){"use strict";var h=b("MessengerProfileImageWrapperReact.bs").jsComponent,i=b("MessengerThreadImageReact.bs").jsComponent;a=function(a){var c=a.participants;a=a.thread;return a?b("React").createElement("div",{className:"_dzr"},b("React").createElement(i,{className:"_dzs",participants:c,size:100,thread:a,viewer:b("CurrentUser").getID()}),b("React").createElement(b("MercuryThreadTitle.react"),{className:"_dzt",thread:a,viewer:b("CurrentUser").getID()})):b("React").createElement("div",{className:"_dzr"},b("React").createElement(h,{className:"_4j_j",size:b("MercuryParticipantsConstants").BIG_IMAGE_SIZE,showBadge:!1},b("React").createElement(b("MercuryParticipantsImage.react"),{participants:Object.keys(c.toJS()),size:b("MercuryParticipantsConstants").BIG_IMAGE_SIZE})),b("React").createElement(b("RTCCallTitle.react"),{className:"_dzt",participants:c,viewer:b("CurrentUser").getID()}))};e.exports=a}),null);
__d("RTCMWAppViewContent.react",["cx","fbt","CurrentUser","FBRTCConstants","FBRTCGroupCallIncallView.react","FBRTCLogger","FBRTCParticipantCallState","MessengerRTCGroupCallParticipantsPickerDialogController","React","RTCAppSpinner.react","RTCAppViewMain.react","RTCCallConnectionStatus.react","RTCCallState","RTCCallStateInfo.react","RTCCallStore","RTCConferenceState","RTCGroupCallEscalationStore","RTCGroupCallStateInfo.react","RTCRingBackTone.react","RTCStarRating.react","RTCTextButton.react","RTCThreadInfo.react","RTCUtils","VideoCallWebDriverIDs","idx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FBRTCConstants").CallType,k=b("FBRTCLogger").Trigger;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);i=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={wasStarRatingDone:!1},this.$4=function(){this.setState({wasStarRatingDone:!0})}.bind(this),b}a.prototype.render=function(){__p&&__p();var a,c=this.props,d=c.endCallReason,e=c.remoteUsers;c=babelHelpers.objectWithoutProperties(c,["endCallReason","remoteUsers"]);var f=b("RTCUtils").isBonfireCall(this.props.conferenceName);switch(this.props.conferenceState){case b("RTCConferenceState").NEW:return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCCallStateInfo.react"),null,b("React").createElement(b("RTCThreadInfo.react"),{participants:this.props.participants,thread:this.props.thread}),b("React").createElement(b("RTCAppSpinner.react"),null)));case b("RTCConferenceState").AWAITING_USER_START:var g=h._("Join Call"),i=(a=this.props)!=null?(a=a.thread)!=null?(a=a.rtc_call_data)!=null?a.server_info_data:a:a:a,k=(a=this.props)!=null?(a=a.thread)!=null?(a=a.rtc_call_data)!=null?a.call_state:a:a:a;k&&k===b("RTCCallState").NO_ONGOING_CALL&&(g=h._("Start Call"));return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCCallStateInfo.react"),null,b("React").createElement(b("RTCThreadInfo.react"),{participants:this.props.participants,thread:this.props.thread}),b("React").createElement(b("RTCCallConnectionStatus.react"),null,h._("Ready to call?")),b("React").createElement(b("RTCTextButton.react"),{className:"green _2fst","data-testid":b("VideoCallWebDriverIDs").RTC_APP_VIEW_START_CALL_BUTTON,label:g,onClick:function(){return this.$1(k,i)}.bind(this)})));case b("RTCConferenceState").CONNECTING:case b("RTCConferenceState").CONNECTED:case b("RTCConferenceState").TERMINATING:return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!0},b("React").createElement(b("FBRTCGroupCallIncallView.react"),babelHelpers["extends"]({remoteUsers:e.filter(function(a){a=a.participantState;return a&&a.state===b("FBRTCParticipantCallState").CONNECTED})},c)),this.$2(),this.$3());case b("RTCConferenceState").TERMINATED:if(this.props.wasConnected&&!f&&!this.state.wasStarRatingDone){a=b("RTCCallStore").getState().callSummary.getCallType()!==j.DIRECT_VIDEO;g=b("RTCCallStore").getState().callSummary.getCallType()!==j.ESCALATED;return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!0},b("React").createElement(b("RTCStarRating.react"),{isAudioCall:a&&g,isGroupCall:!0,onDone:this.$4}))}else return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!0},this.$3(d?d.toString():null));default:return null}};a.prototype.$3=function(a){var c=b("RTCGroupCallEscalationStore").getState();c=c.p2pCallSummary;c=c?c.getConnectedStartTime():0;return b("React").createElement(b("RTCGroupCallStateInfo.react"),babelHelpers["extends"]({callMessage:a,initialStartTime:c},this.props))};a.prototype.$2=function(){return this.props.conferenceState===b("RTCConferenceState").CONNECTING?b("React").createElement(b("RTCRingBackTone.react"),{active:!0,conferenceName:b("RTCUtils").isGroupCall(this.props.conferenceName)?b("RTCUtils").generateRandomInt().toString():this.props.conferenceName}):null};a.prototype.$1=function(a,c){a=a!==b("RTCCallState").NO_ONGOING_CALL;a?this.props.onStartCallClick(this.props.remoteUsers.toArray().map(function(a){return a.FBID}),k.MULTIWAY_POPUP_START_CALL_BUTTON):b("MessengerRTCGroupCallParticipantsPickerDialogController").render({conferenceName:this.props.conferenceName,handleCall:function(a){return this.props.onStartCallClick(a,k.MULTIWAY_POPUP_START_CALL_BUTTON,c)}.bind(this),hasVideo:!0,participants:this.props.participants.filter(function(a){a=a.fbid;return a!==b("CurrentUser").getID()}),thread:this.props.thread,trigger:k.MULTIWAY_POPUP_START_CALL_BUTTON,viewerID:b("CurrentUser").getID()})};e.exports=a}),null);
__d("RTCElementResizeListener.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$3=function(a){this.$1=a&&a.getDOMNode?a.getDOMNode():a}.bind(this),this.$4=function(a){a&&a.contentWindow?a.contentWindow.addEventListener("resize",this.$5,!1):this.$2&&this.$2.contentWindow&&this.$2.contentWindow.removeEventListener("resize",this.$5,!1),this.$2=a}.bind(this),this.$5=i(function(a){a=a.target;var b=this.props.onResize;b&&a&&b({height:a.innerHeight,width:a.innerWidth})}.bind(this),32),b}a.prototype.getDOMNode=function(){return this.$1};a.prototype.render=function(){var a=this.props,c=a.children,d=a.className,e=a.component,f=a.onResize;a=babelHelpers.objectWithoutProperties(a,["children","className","component","onResize"]);return b("React").createElement(e,babelHelpers["extends"]({className:b("joinClasses")("_3u0-",d),ref:this.$3},a),c,f?b("React").createElement("iframe",{className:"_3u11",ref:this.$4}):null)};a.prototype.componentDidMount=function(){this.$2&&this.$5({target:this.$2.contentWindow})};a.prototype.componentDidUpdate=function(a){var b=this.props.onResize;this.$2&&b&&b!==a.onResize&&this.$5({target:this.$2.contentWindow})};a.prototype.componentWillUnmount=function(){this.$2&&this.$2.contentWindow&&this.$2.contentWindow.removeEventListener("resize",this.$5,!1),this.$5.cancel()};a.defaultProps={component:"div"};function i(a,b){var c=0,d=null,e=function(){for(var e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];var h=Date.now();c&&h<c+b?(clearTimeout(d),d=setTimeout(function(){c=h,a.apply(undefined,f)},b)):(c=h,a.apply(undefined,f))};e.cancel=function(){return clearTimeout(d)};return e}e.exports=a}),null);
__d("RTCAppViewFooter.react",["cx","React","RTCElementResizeListener.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement(b("RTCElementResizeListener.react"),babelHelpers["extends"]({component:"footer",className:b("joinClasses")("_u0t",d)},a),c)};e.exports=a}),null);
__d("RTCMouseActivityProvider.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("React").Children;c=b("React").PureComponent;var i=500;d=babelHelpers.inherits(a,c);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1=null,this.$2=j(function(){clearTimeout(this.$1),this.props.onActive(),this.$1=setTimeout(this.props.onIdle,this.props.idleDelay)}.bind(this),i),b}a.prototype.render=function(){return h.only(this.props.children)};a.prototype.componentDidMount=function(){window.addEventListener("mousemove",this.$2),this.$2()};a.prototype.componentWillUnmount=function(){window.removeEventListener("mousemove",this.$2),clearTimeout(this.$1),this.$2.cancel()};a.defaultProps={idleDelay:3e3};function j(a){var b=arguments.length<=1||arguments[1]===undefined?100:arguments[1],c=0,d=null,e=function(){for(var e=arguments.length,f=Array(e),g=0;g<e;g++)f[g]=arguments[g];var h=Date.now(),i=function(){c=h,a.apply(undefined,f)};c&&h<c+b?(clearTimeout(d),d=setTimeout(i,b)):i()};e.cancel=function(){return clearTimeout(d)};return e}e.exports=a}),null);
__d("RTCCallControls.react",["cx","React","RTCElementResizeListener.react","RTCMouseActivityProvider.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={hasFocus:!1,isMouseActive:!0},this.$6=function(a){this.$1=a&&a.getDOMNode?a.getDOMNode():a}.bind(this),this.$2=function(){this.setState({isMouseActive:!0}),this.$7(!0)}.bind(this),this.$3=function(){this.setState({isMouseActive:!1}),this.$7(!1)}.bind(this),this.$5=function(){this.setState({hasFocus:!0})}.bind(this),this.$4=function(){this.setState({hasFocus:!1})}.bind(this),b}a.prototype.getDOMNode=function(){return this.$1};a.prototype.render=function(){var a=this.props,c=a.children,d=a.className,e=a.compact;a=babelHelpers.objectWithoutProperties(a,["children","className","compact"]);return b("React").createElement(b("RTCMouseActivityProvider.react"),{onActive:this.$2,onIdle:this.$3},b("React").createElement(b("RTCElementResizeListener.react"),babelHelpers["extends"]({className:b("joinClasses")("_2eaq"+(e?" compact":"")+(!this.props.autoHide||this.state.isMouseActive||this.state.hasFocus?" visible":""),d),component:"section",onBlur:this.$4,onFocus:this.$5,ref:this.$6},a),c))};a.prototype.$7=function(a){this.props.onUpdateVisibility&&this.props.onUpdateVisibility(a)};a.defaultProps={autoHide:!0,compact:!1};e.exports=a}),null);
__d("RTCAbstractButton.react",["cx","AbstractButton.react","React","RTCSVGIcon.react","joinClasses","throttle"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(event){var a=this.props.disabled;if(a){event.preventDefault();return}this.props.shouldThrottle?this.$2():this.props.onClick()}.bind(this),this.$2=b("throttle")(function(){this.props.onClick()}.bind(this),500),c}a.prototype.render=function(){var a=this.props,c=a.children,d=a.className,e=a.disabled,f=a.highlighted,g=a.title;a=babelHelpers.objectWithoutProperties(a,["children","className","disabled","highlighted","title"]);c=b("React").createElement(b("RTCSVGIcon.react"),{className:"_4uwr"},c);return b("React").createElement(b("AbstractButton.react"),babelHelpers["extends"]({"aria-disabled":e,className:b("joinClasses")(d,"_4uwq"+(!e&&f?" highlighted":"")),"data-hover":e?"none":"tooltip",image:c,label:g},a,{onClick:this.$1}))};a.defaultProps={highlighted:!1,disabled:!1,shouldThrottle:!0};e.exports=a}),null);
__d("RTCCallControlsButton.react",["React","RTCAbstractButton.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.prototype.render=function(){var a=this.props,c=a.title;a=babelHelpers.objectWithoutProperties(a,["title"]);return b("React").createElement(b("RTCAbstractButton.react"),babelHelpers["extends"]({"data-tooltip-alignh":"center","data-tooltip-content":c,label:c,labelIsHidden:!0,title:c},a))};function a(){g.apply(this,arguments)}a.defaultProps={highlighted:!1,disabled:!1,shouldThrottle:!0};e.exports=a}),null);
__d("RTCP2PCallNUXIDs",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({RTC_P2P_ADD_GROUP_MEMBER_NUX:5609,RTC_P2P_REMOTE_STREAMS_SLIDER_NUX:4773,RTC_P2P_REMOTE_SCREEN_CONTENT_POP_OUT_NUX:4774,RTC_P2P_REMOTE_CAMERA_CONTROLS_NUX:4775,RTC_P2P_SETTINGS_NUX:4776})}),null);
__d("RTCUIAddParticipantIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 48 48"},b("React").createElement("g",{transform:"translate(11 16)"},b("React").createElement("path",{d:"M13.21 1.644c-1.023.763-.748 1.669-.656 3.21-.421 0-.37.31-.29.709.073.364.11.838.283.838a.123.123 0 0 0 .053-.013c.604 2.518 1.073.438.712 2.73l-.292.067c-.038.136-.09.617-.293.94C8.281 12 8.24 11.397 7.8 16H24c-.441-4.603-.46-4-4.905-5.875-.203-.323-.255-.804-.293-.94l-.292-.066c-.362-2.293.082-.213.685-2.731a.12.12 0 0 0 .053.013c.174 0 .21-.474.283-.838.08-.398.146-.71-.276-.71.09-1.54.371-2.438-.595-3.209-.763-1.14-2.693-1.05-2.76-1.05 0 0-1.374.067-2.69 1.05z",fillRule:"evenodd"}),b("React").createElement("path",{d:"M5.738 4.407V0H4.463v4.407H0v1.26h4.463v4.407h1.275V5.667H10.2v-1.26z",fillRule:"evenodd"}))))};e.exports=a}),null);
__d("RTCUIPlusIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 48 48"},b("React").createElement("path",{d:"M24 12v24M12 24h24",fill:"none",stroke:"red"})))};e.exports=a}),null);
__d("RTCCallControlsAddGroupMembersButton.react",["cx","fbt","FunnelLogger","immutable","React","RTCCallControlsButton.react","RTCGroupCallDialogController","RTCP2PCallNUXActions","RTCP2PCallNUXIDs","RTCUIAddParticipantIcon.react","RTCUIPlusIcon.react","VideoCallWebDriverIDs","XUIAmbientNUX.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$2=function(){var a=this.props,c=a.localUser,d=a.participants,e=a.remoteUsers;a=a.thread;b("RTCGroupCallDialogController").showAddGroupMembersDialog(d.filter(function(a){a=a.fbid;return a!==c.FBID}),b("immutable").Map(e.map(function(a){return[a.FBID,a.participantState]})),a,c.FBID,!!this.props.isEscalatedCall)}.bind(this),c}a.prototype.render=function(){var a=void 0;b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","render_add_participants_button");this.props.thread?a=h._("Add group members"):this.props.isEscalatedCall?a=h._("Add more people"):a=h._("See call participants");return b("React").createElement(b("React").Fragment,null,b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")("semiopaque icon-48",this.props.className),"data-testid":b("VideoCallWebDriverIDs").ADD_GROUP_MEMBERS_BUTTON,onClick:this.$2,ref:function(a){return this.$1=a}.bind(this),title:a},b("React").createElement(b("RTCUIAddParticipantIcon.react"),null)),b("React").createElement(k,{contextRef:function(){return this.$1}.bind(this),shown:this.props.showNux}))};a.prototype.$3=function(){this.props.showNux&&j(),this.$2()};a.prototype.componentDidMount=function(){this.$4()};a.prototype.componentDidUpdate=function(){this.$4()};a.prototype.$4=function(){this.props.showNux&&b("RTCP2PCallNUXActions").markNUXViewed(b("RTCP2PCallNUXIDs").RTC_P2P_ADD_GROUP_MEMBER_NUX)};a.defaultProps={showNux:!1};function j(){b("RTCP2PCallNUXActions").dismissNUX(b("RTCP2PCallNUXIDs").RTC_P2P_ADD_GROUP_MEMBER_NUX)}var k=function(a){return b("React").createElement(b("XUIAmbientNUX.react"),babelHelpers["extends"]({alignment:"right",offsetX:21,onCloseButtonClick:j,position:"above",width:"auto"},a),h._("Add someone to your chat"))};e.exports=a}),null);
__d("RTCCallControlsButtonWithLabel.react",["cx","React","RTCAbstractButton.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").PureComponent);h&&h.prototype;a.prototype.render=function(){var a=babelHelpers.objectWithoutProperties(this.props,[]);return b("React").createElement("div",{className:"_665d"},b("React").createElement(b("RTCAbstractButton.react"),babelHelpers["extends"]({"data-hover":"none",labelIsHidden:!0},a)),b("React").createElement("div",{className:"_665c"},this.props.title))};function a(){h.apply(this,arguments)}a.defaultProps={highlighted:!1,disabled:!1,shouldThrottle:!0};e.exports=a}),null);
__d("RTCUIXIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 48 48"},b("React").createElement("path",{d:"M24 25.4l-4.9 4.9c-.4 .4-1 .4-1.4 0c-.4-.4-.4-1 0-1.4L22.6 24L17.6 19.1c-.4-.4-.4-1 0-1.4c.4-.4 1-.4 1.4 0L24 22.6l4.9-4.9c.4-.4 1-.4 1.4 0c.4 .4 .4 1 0 1.4L25.4 24l4.9 4.9c.4 .4 .4 1 0 1.4c-.4 .4-1 .4-1.4 0L24 25.4z"})))};e.exports=a}),null);
__d("RTCCallControlsCloseWindowButton.react",["cx","fbt","React","RTCCallControlsButton.react","RTCCallControlsButtonWithLabel.react","RTCUIXIcon.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){var c=a.className;a=a.showLabel;a=a===undefined?!1:a;return b("React").createElement(i,{className:b("joinClasses")("closeWindow icon-48",c),label:h._("Close"),onClick:function(){return window.close()},showLabel:a},b("React").createElement(b("RTCUIXIcon.react"),null))};var i=function(a){var c=a.children,d=a.className,e=a.label,f=a.onClick;a=a.showLabel;return a?b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),{className:d,onClick:f,title:e},c):b("React").createElement(b("RTCCallControlsButton.react"),{className:d,onClick:f,title:e},c)};e.exports=a}),null);
__d("RTCUIPhoneIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){var c=a.variant;c=c===undefined?"start call":c;a=babelHelpers.objectWithoutProperties(a,["variant"]);return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 48 48"},c==="start call"?b("React").createElement("path",{d:"M32.3 33.3c-4.2 3.5-12.6-4.7-12.8-4.9C19.4 28.3 10.9 20 14.5 15.9C17.2 12.8 17.9 14 18.3 14.3c.3 .3 2.9 4 3 4.7C21.5 19.7 20 21.5 20 22.1c.1 .6 1.8 2.5 2.6 3.3c.7 .7 2.7 2.4 3.3 2.5c.6 .1 2.4-1.4 3.1-1.3c.8 .1 4.5 2.7 4.8 3C34.2 29.9 35.4 30.7 32.3 33.3"}):b("React").createElement("path",{d:"M12.054 24.58C12.52 19.102 24.34 19.002 24.54 19c.202 0 12.024-.1 12.408 5.37.284 4.048-1.092 3.74-1.56 3.778-.41.033-4.823-.767-5.452-1.19-.63-.422-.785-2.703-1.293-3.094-.507-.39-3.092-.51-4.134-.502-1.043.01-3.63.174-4.143.572-.513.4-.702 2.683-1.337 3.117-.636.434-5.062 1.31-5.47 1.283-.47-.03-1.85.3-1.506-3.753"})))};e.exports=a}),null);
__d("RTCCallControlsEndCallButton.react",["cx","fbt","React","RTCCallControlsButton.react","RTCUIPhoneIcon.react","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("RTWebUserActionLogger").logClick({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").END_CALL,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS}),this.props.onClick&&this.props.onClick()}.bind(this),c}a.prototype.componentDidMount=function(){b("RTWebUserActionLogger").logImpression({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").END_CALL,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS})};a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")("opaque endCall icon-48",this.props.className),"data-testid":b("VideoCallWebDriverIDs").END_CALL_BUTTON,disabled:this.props.disabled,onClick:this.$1,title:h._("End call")},b("React").createElement(b("RTCUIPhoneIcon.react"),{variant:"end call"}))};e.exports=a}),null);
__d("RTCUIMicrophoneIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){var c=a.strikeThrough;c=c===undefined?!1:c;a=babelHelpers.objectWithoutProperties(a,["strikeThrough"]);return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{height:48,viewBox:"0 0 48 48",width:48},c?b("React").createElement("path",{d:"M25 31c.7-.1 1.3-.3 1.9-.6l-.5-.9c-.6.3-1.2.5-1.9.5-2.5 0-4.5-2.2-4.5-5v-5h-1v5.2c0 3.1 2.2 5.6 5 5.8v3h-3v1h7v-1h-3v-3zm-.5-2c.5 0 1-.1 1.4-.3L21 20.6v4.9c0 1.9 1.6 3.5 3.5 3.5zm-5.8-16l-.9.5L30.3 34l.9-.5L18.7 13zM30 25.2V20h-1v5c0 .8-.2 1.6-.5 2.2l.6 1c.6-.8.9-1.9.9-3zm-2 .3v-9c0-1.9-1.6-3.5-3.5-3.5-1.5 0-2.7.9-3.2 2.2L28 26.3v-.8z"}):b("React").createElement("path",{d:"M29 20v5c0 2.7-2 5-4.5 5S20 27.8 20 25v-5h-1v5.2c0 3.1 2.2 5.6 5 5.8v3h-3v1h7v-1h-3v-3c2.8-.3 5-2.8 5-5.8V20h-1zm-4.5 9c1.9 0 3.5-1.6 3.5-3.5v-9c0-1.9-1.6-3.5-3.5-3.5S21 14.6 21 16.5v9c0 1.9 1.6 3.5 3.5 3.5z"})))};e.exports=a}),null);
__d("RTCCallControlsToggleAudioButton.react",["cx","fbt","React","RTCCallActions","RTCCallControlsButton.react","RTCUIMicrophoneIcon.react","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("RTWebUserActionLogger").logClick({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").TOGGLE_AUDIO,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS}),b("RTCCallActions").toggleMuteAudio(this.props.audioMuted)}.bind(this),c}a.prototype.componentDidMount=function(){b("RTWebUserActionLogger").logImpression({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").TOGGLE_AUDIO,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS})};a.prototype.render=function(){var a=this.props,c=a.audioMuted,d=a.className;a=a.disabled;return b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")(d,"semiopaque icon-48"),"data-testid":b("VideoCallWebDriverIDs").TOGGLE_AUDIO_BUTTON,disabled:a,highlighted:c,onClick:this.$1,title:c?h._("Unmute your microphone"):h._("Mute your microphone")},b("React").createElement(b("RTCUIMicrophoneIcon.react"),{strikeThrough:c||a}))};e.exports=a}),null);
__d("RTCUIScreenIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){var c=a.variant;a=babelHelpers.objectWithoutProperties(a,["variant"]);return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 48 48"},b("React").createElement(g,{variant:c})))};var g=function(a){a=a.variant;switch(a){case"strike-through":return b("React").createElement("path",{d:"M18.475 17H12v14h14.887l-.6-1H13V18h6.076l-.6-1zm3.5 0H36v14h-5.613l-.6-1H35V18H22.576l-.6-1zm5.513 15H19v1h9.09l-.602-1zm-7.81-13H14v10h11.685l-6.008-10zm3.5 0H34v10h-4.815l-6.008-10zm7.183 16.087l.86-.515L18.858 14l-.858.515 12.36 20.572z"});case"x":return b("React").createElement("path",{d:"M24.706 18l3.182 3.183a.5.5 0 0 1-.707.707L24 18.708l-3.182 3.182a.5.5 0 0 1-.707-.707L23.292 18l-3.182-3.182a.5.5 0 0 1 .707-.707L24 17.294l3.182-3.182a.5.5 0 0 1 .707.707zM28.999 17v1h6v12h-22V18h6v-1h-7v14h24V17h-7zm-10 15h10v1h-10z"});case"normal":default:return b("React").createElement("path",{d:"M12 17v14h24V17H12zm23 13H13V18h22v12zm-16.001 2h10v1h-10zm-4.986-13.005h20.018v10.009H14.013z"})}};e.exports=a}),null);
__d("RTCCallControlsScreenSharingButton.react",["cx","React","RTCCallControlsButton.react","RTCUIScreenIcon.react","ScreenSharingWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=a.className,d=a.disabled;d=d===undefined?!1:d;var e=a.sharing;a=babelHelpers.objectWithoutProperties(a,["className","disabled","sharing"]);var f=d?"strike-through":e?"x":"normal";return b("React").createElement(b("RTCCallControlsButton.react"),babelHelpers["extends"]({className:b("joinClasses")(c,"semiopaque icon-48"),"data-testid":b("ScreenSharingWebDriverIDs").SHARE_SCREEN_BUTTON,disabled:d,highlighted:e},a),b("React").createElement(b("RTCUIScreenIcon.react"),{variant:f}))}e.exports=a}),null);
__d("RTCDialogList.react",["React"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){return b("React").createElement("ul",null,this.props.children)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("RTCDialogListItem.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){var a=b("joinClasses")("_4gtz",this.props.className);return b("React").createElement("li",babelHelpers["extends"]({onClick:this.props.onClick},{className:a}),this.props.children)};function a(){h.apply(this,arguments)}e.exports=a}),null);
__d("RTCCallControlsScreenSharingDialog.react",["cx","fbt","React","RTCDialog.react","RTCDialogList.react","RTCDialogListItem.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();function a(a){var c=a.cancelLabel,d=a.dialogWidth;d=d===undefined?350:d;var e=a.onDialogHide,f=a.onDialogToggle,g=a.onStopScreenSharingClick,i=a.onUpdateScreenSharingClick,j=a.shareDifferentWindowLabel;a=a.stopScreenSharingLabel;j=j||h._("Share a Different Window");a=a||h._("Stop Screen Sharing");c=c||h._("Cancel");return b("React").createElement(b("RTCDialog.react"),{className:"_1z6a",label:"Screen sharing call controls",onToggle:f,width:d},b("React").createElement(b("RTCDialogList.react"),null,b("React").createElement(b("RTCDialogListItem.react"),{onClick:i},j),b("React").createElement(b("RTCDialogListItem.react"),{className:"_1z6b",onClick:g},a),b("React").createElement(b("RTCDialogListItem.react"),{onClick:e},c)))}e.exports=a}),null);
__d("RTCInstallExtensionDialog.react",["fbt","Bootloader","CollabCallMessengerBrowserEventEnum","MessengerDialog.react","MessengerDialogBody.react","MessengerDialogButton.react","MessengerDialogCancelButton.react","MessengerDialogFooter.react","MessengerDialogHeader.react","MessengerDialogTitle.react","React","RTCCallStore","ScreenSharingWebDriverIDs","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$2=function(){this.props.onToggle(!1)}.bind(this),this.$3=function(){this.$1(b("CollabCallMessengerBrowserEventEnum").SCREEN_SHARING_EXT_LINK),b("promiseDone")(this.props.onInstall(),function(){return this.$2()}.bind(this))}.bind(this),c}a.prototype.componentDidMount=function(){this.$1(b("CollabCallMessengerBrowserEventEnum").SCREEN_SHARING_EXT_DIALOG)};a.prototype.render=function(){return b("React").createElement(b("MessengerDialog.react"),{layerHideOnBlur:!1,onToggle:this.props.onToggle,width:544},b("React").createElement(b("MessengerDialogHeader.react"),null,b("React").createElement(b("MessengerDialogTitle.react"),null,g._("Add Facebook Screen Sharing Extension"))),b("React").createElement(b("MessengerDialogBody.react"),{"data-testid":b("ScreenSharingWebDriverIDs").INSTALL_EXT_DIALOG},b("React").createElement("div",null,g._("To share your screen during video calls on Messenger, Facebook and Workplace, you'll need to add the Facebook Screen Sharing extension. The extension will not save images of your screen during your call or share your data with other apps or websites. You can also share your screen during your Facebook Live videos."))),b("React").createElement(b("MessengerDialogFooter.react"),null,b("React").createElement(b("MessengerDialogCancelButton.react"),{onClick:this.$2}),b("React").createElement(b("MessengerDialogButton.react"),{action:"confirm",label:g._("Add Extension"),onClick:this.$3,type:"primary",use:"default"})))};a.prototype.$1=function(event){b("Bootloader").loadModules(["CollabMessengerLogger"],function(a){var c=b("RTCCallStore").getState(),d=c.remoteUsers;c=c.callInfo;a.log(event,{peerID:d.first().FBID,callID:c.conferenceName})},"RTCInstallExtensionDialog.react")};e.exports=a}),null);
__d("RTCUnsupportedBrowserDialog.react",["cx","fbt","ix","FBRTCVersionDetection","Image.react","Link.react","Layout.react","React","RTCDialog.react","RTCDialogBody.react","RTCDialogHeader.react","RTCDialogHeaderButton.react","XUIText.react"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("Layout.react").Column;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);j=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.$3=function(){this.props.onToggle(!1)}.bind(this),b}a.prototype.render=function(){return b("React").createElement(b("RTCDialog.react"),{label:"Screen sharing update browser",layerHideOnBlur:!1,onToggle:this.props.onToggle,width:640},this.$1(),this.$2())};a.prototype.$1=function(){var a=null;b("FBRTCVersionDetection").isChrome()?a=h._("Update Browser to Share Your Screen"):a=h._("Switch Browsers to Share Your Screen");return b("React").createElement(b("RTCDialogHeader.react"),null,b("React").createElement("h1",{className:"_10mm"},a),b("React").createElement(b("RTCDialogHeaderButton.react"),{label:h._("Cancel"),onClick:this.$3}))};a.prototype.$2=function(){var a=b("FBRTCVersionDetection").isChrome()?this.$4():this.$5();return b("React").createElement(b("RTCDialogBody.react"),null,b("React").createElement("div",null,b("React").createElement("p",{className:"_2gx8"},a),this.$6()))};a.prototype.$4=function(){return h._("Screen sharing doesn't work in the older version of Google Chrome you're using. To share your screen, please update Google Chrome.")};a.prototype.$5=function(){if(b("FBRTCVersionDetection").isFirefox())return h._("Screen sharing doesn't work in Mozilla Firefox yet. To share your screen, please open Facebook in Google Chrome.");else return h._("Screen sharing doesn't work in your browser yet. To share your screen, please open Facebook in Google Chrome.")};a.prototype.$6=function(){return b("React").createElement(b("Layout.react"),null,b("React").createElement(k,{style:{width:"100%",textAlign:"center"}},b("React").createElement(b("Link.react"),{href:"https://www.google.com/chrome/index.html",target:"_blank"},b("React").createElement(b("Image.react"),{alt:"Chrome",className:"_4_if",src:i("28180"),width:"64"}),b("React").createElement(b("XUIText.react"),{display:"block"},"Google Chrome"))))};e.exports=a}),null);
__d("RTCCallControlsToggleScreenSharingButton.react",["fbt","Promise","CollabRTCChromeScreenSharingExtension","MediaRequestSourceApp","React","RTCCallControlsScreenSharingButton.react","RTCCallControlsScreenSharingDialog.react","RTCConfig","RTCInstallExtensionDialog.react","RTCScreenSharing","RTCUnsupportedBrowserDialog.react","RTCUtils","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","UserAgent","WorkplaceChatHelper","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(){__p&&__p();b("RTWebUserActionLogger").logClick({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").SCREENSHARING,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS});this.props.onClick!=null&&this.props.onClick();if(!b("RTCUtils").isScreenSharingSupported()){this.$2(b("React").createElement(b("RTCUnsupportedBrowserDialog.react"),{onToggle:function(){return this.$3()}.bind(this)}));return}if(this.props.stream!=null){this.$2(b("React").createElement(b("RTCCallControlsScreenSharingDialog.react"),{onDialogHide:function(){this.$3(),this.props.onDialogDismiss!=null&&this.props.onDialogDismiss()}.bind(this),onDialogToggle:this.$3,onStopScreenSharingClick:this.$4,onUpdateScreenSharingClick:this.$5}));this.props.onDialogShow!=null&&this.props.onDialogShow();return}this.$6()}.bind(this),this.$7=function(){this.$3();return this.props.onExtensionInstallStart().then(function(){this.props.onExtensionInstallComplete&&this.props.onExtensionInstallComplete(null),window.focus(),this.$6()}.bind(this))["catch"](function(a){this.props.onExtensionInstallComplete&&this.props.onExtensionInstallComplete(a),window.focus()}.bind(this))}.bind(this),this.$4=function(){var a=this.props.stream;if(a==null)return;this.$3();this.props.onShareStop!=null&&this.props.onShareStop(a);b("RTCScreenSharing").stop()}.bind(this),this.$5=function(){this.$3();var a=this.props.stream;if(a==null)return;this.props.onShareUpdateAttempt!=null&&this.props.onShareUpdateAttempt();this.$8().then(function(b){return this.props.onShareStreamUpdate(a,b)}.bind(this))["catch"](this.$9)}.bind(this),this.$9=function(a){this.$3();var c=a.message;switch(c){case b("CollabRTCChromeScreenSharingExtension").EXTENSION_NOT_FOUND:this.$2(b("React").createElement(b("RTCInstallExtensionDialog.react"),{onInstall:this.$7,onToggle:this.$3}));break;case b("CollabRTCChromeScreenSharingExtension").DIALOG_USER_CANCEL:break;case b("RTCScreenSharing").SCREEN_SHARING_NOT_SUPPORTED:this.$2(b("React").createElement(b("RTCUnsupportedBrowserDialog.react"),{onToggle:this.$3}));break}this.props.onShareError!=null&&this.props.onShareError(a)}.bind(this),this.$3=function(){var a=this.context;a!=null&&typeof a.dialogHide==="function"&&a.dialogHide()}.bind(this),c}a.prototype.componentDidMount=function(){b("RTWebUserActionLogger").logImpression({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").SCREENSHARING,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS})};a.prototype.render=function(){var a=this.props.stream;return b("React").createElement(b("RTCCallControlsScreenSharingButton.react"),{disabled:this.props.disabled,onClick:this.$1,sharing:a!=null,title:a!=null?g._("Screen sharing options"):g._("Share your screen")})};a.prototype.$6=function(){this.props.onShareStartAttempt!=null&&this.props.onShareStartAttempt(),this.$3(),this.$8()["catch"](this.$9)};a.prototype.$8=function(){return b("UserAgent").isBrowser("Chrome")&&!b("WorkplaceChatHelper").isDesktopChatApp()&&!b("CollabRTCChromeScreenSharingExtension").isInstalled()?b("Promise").reject(new Error(b("CollabRTCChromeScreenSharingExtension").EXTENSION_NOT_FOUND)):b("RTCUtils").getUserScreenMedia({audio:!1,video:babelHelpers["extends"]({},b("RTCConfig").CollaborationCallQuality.screen_v2||b("RTCConfig").CollaborationCallQuality.screen,{mediaSource:"screen"})},b("MediaRequestSourceApp").RTC_CALL).then(function(a){b("promiseDone")(i(a),this.$4);this.props.onShareStarted(a);return a}.bind(this))};a.prototype.$2=function(a){var b=this.context;b!=null&&typeof b.dialogShow==="function"&&b.dialogShow(a)};a.prototype.componentWillUnmount=function(){this.$3()};a.defaultProps={disabled:!1};a.contextTypes={dialogHide:c.func,dialogShow:c.func};function i(a){return b("Promise").all(a.getVideoTracks().map(function(a){return new(b("Promise"))(function(b){return a.addEventListener("ended",b)})}))}e.exports=a}),null);
__d("RTCCallControlsToggleScreenSharingWithFunnelButton.react",["Promise","CollabRTCChromeScreenSharingExtension","FBRTCConfig","FBRTCConstants","FunnelLogger","React","RTCCallControlsToggleScreenSharingButton.react","RTCCallStore","RTCScreenSharing","UserAgentData","promiseDone"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("FBRTCConstants").SignalingProtocol,i="WEB_RTC_SCREEN_SHARING_FUNNEL",j=Object.freeze({START_IN_P2P:"p2p_call",START_IN_MW:"mw_call",START_IN_VC:"vc_call",BUTTON_DISABLED:"button_disabled",BUTTON_ENABLED:"button_enabled",BUTTON_MOUNTED:"button_mounted",BUTTON_CLICK:"button_click",DIALOG_SHOW:"dialog_show",DIALOG_CANCEL:"dialog_cancel",START_SHARING:"start_sharing",UPDATE_SHARING:"update_sharing",STOP_SHARING:"stop_sharing",STREAM_ENDED:"stream_ended",SCREEN_SUCCEEDED:"screen_succeeded",SCREEN_FAILED:"screen_failed",FAILED_REASON_NO_EXTENSION:"no_extension",FAILED_REASON_NOT_SUPPORTED:"not_supported",FAILED_REASON_NO_PERMISSION:"no_permission",FAILED_REASON_OTHER:"other_reason",EXTENSION_INSTALL_START:"extension_install_start",EXTENSION_INSTALL_SUCCEED:"extension_install_succeed",EXTENSION_INSTALL_FAIL:"extension_install_fail"});c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(){l(j.BUTTON_CLICK),this.props.onClick!=null&&this.props.onClick()}.bind(this),this.$2=function(){l(j.DIALOG_CANCEL),this.props.onDialogDismiss!=null&&this.props.onDialogDismiss()}.bind(this),this.$3=function(){l(j.DIALOG_SHOW),this.props.onDialogShow!=null&&this.props.onDialogShow()}.bind(this),this.$5=function(){l(j.EXTENSION_INSTALL_START);return this.props.onExtensionInstallStart()}.bind(this),this.$4=function(a){a?m(j.EXTENSION_INSTALL_FAIL,a.toString()):l(j.EXTENSION_INSTALL_SUCCEED),this.props.onExtensionInstallComplete&&this.props.onExtensionInstallComplete(a)}.bind(this),this.$6=function(a){l(j.SCREEN_FAILED);switch(a.message){case b("CollabRTCChromeScreenSharingExtension").EXTENSION_NOT_FOUND:l(j.FAILED_REASON_NO_EXTENSION);break;case b("RTCScreenSharing").SCREEN_SHARING_NOT_SUPPORTED:l(j.FAILED_REASON_NOT_SUPPORTED);break;default:l(j.FAILED_REASON_OTHER);break}this.props.onShareError!=null&&this.props.onShareError(a)}.bind(this),this.$7=function(){l(j.START_SHARING),this.props.onShareStartAttempt!=null&&this.props.onShareStartAttempt()}.bind(this),this.$8=function(a){l(j.SCREEN_SUCCEEDED),b("promiseDone")(n(a),function(){b("FunnelLogger").appendAction(i,j.STREAM_ENDED)}),this.props.onShareStarted(a)}.bind(this),this.$9=function(a){l(j.STOP_SHARING),this.props.onShareStop(a)}.bind(this),this.$10=function(){this.props.onShareUpdateAttempt!=null&&this.props.onShareUpdateAttempt(),l(j.UPDATE_SHARING)}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsToggleScreenSharingButton.react"),{conferenceState:this.props.conferenceState,isP2P:this.props.isP2P,onClick:this.$1,onDialogDismiss:this.$2,onDialogShow:this.$3,onExtensionInstallComplete:this.$4,onExtensionInstallStart:this.$5,onShareError:this.$6,onShareStartAttempt:this.$7,onShareStarted:this.$8,onShareStop:this.$9,onShareUpdateAttempt:this.$10,disabled:this.props.disabled,onShareStreamUpdate:this.props.onShareStreamUpdate,stream:this.props.stream})};a.prototype.componentDidMount=function(){k(),l(j.BUTTON_MOUNTED),l(this.props.disabled?j.BUTTON_DISABLED:j.BUTTON_ENABLED)};a.prototype.componentDidUpdate=function(a){a.disabled!==this.props.disabled&&l(this.props.disabled?j.BUTTON_DISABLED:j.BUTTON_ENABLED)};a.prototype.componentWillUnmount=function(){b("FunnelLogger").endFunnel(i)};function k(){__p&&__p();b("FunnelLogger").startFunnel(i);b("FunnelLogger").addFunnelTag(i,"bn:"+(b("UserAgentData").browserName||"unknown"));b("FunnelLogger").addFunnelTag(i,"os:"+(b("UserAgentData").platformName||"unknown"));b("FBRTCConfig").isVCEndpointCall()&&l(j.START_IN_VC);var a=b("RTCCallStore").getState();a=a.callInfo;switch(a.protocol){case h.P2P:l(j.START_IN_P2P);break;case h.MULTIWAY:l(j.START_IN_MW);break}}function l(a){b("FunnelLogger").appendAction(i,a)}function m(a,c){b("FunnelLogger").appendActionWithTag(i,a,c)}function n(a){return b("Promise").all(a.getVideoTracks().map(function(a){return new(b("Promise"))(function(b){return a.addEventListener("ended",b)})}))}e.exports=a}),null);
__d("RTCUICameraIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){var c=a.strikeThrough;c=c===undefined?!1:c;a=babelHelpers.objectWithoutProperties(a,["strikeThrough"]);return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 48 48"},c?b("React").createElement("path",{d:"M36 29h1V19h-1v10zm-6-2.727L35 29V19l-5 2.727v4.546zM19.344 17H26c1.126 0 2 .938 2 2v10c0 .54-.225 1.047-.595 1.415L19.345 17zm-3.5 0H15c-1.126 0-2 .938-2 2v10c0 1.062.874 2 2 2h9.257l-8.413-14zm11.408 17.044l.857-.516-12.362-20.572-.857.516 12.362 20.572z"}):b("React").createElement("path",{d:"M26 17H15c-1.126 0-2 .938-2 2v10c0 1.062.874 2 2 2h11c1.126 0 2-.938 2-2V19c0-1.062-.874-2-2-2zm10 12h1V19h-1v10zm-6-2.727L35 29V19l-5 2.727v4.546z"})))};e.exports=a}),null);
__d("RTCCallControlsVideoButton.react",["cx","fbt","React","RTCCallControlsButton.react","RTCUICameraIcon.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){var c=a.className,d=a.disabled;d=d===undefined?!1:d;var e=a.onClick,f=a.nodeRef,g=a.videoMuted;a=babelHelpers.objectWithoutProperties(a,["className","disabled","onClick","nodeRef","videoMuted"]);return b("React").createElement(b("RTCCallControlsButton.react"),babelHelpers["extends"]({className:b("joinClasses")(c,"semiopaque icon-48"),disabled:d,highlighted:g,onClick:e,ref:f,title:g?h._("Enable your video"):h._("Disable your video")},a),b("React").createElement(b("RTCUICameraIcon.react"),{strikeThrough:g||d}))};e.exports=a}),null);
__d("RTCCallControlsToggleVideoButton.react",["React","RTCCallActions","RTCCallControlsButton.react","RTCCallControlsVideoButton.react","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("RTWebUserActionLogger").logClick({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").TOGGLE_VIDEO,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS}),b("RTCCallActions").toggleMuteVideo(this.props.videoMuted)}.bind(this),c}a.prototype.componentDidMount=function(){b("RTWebUserActionLogger").logImpression({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").TOGGLE_VIDEO,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS})};a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsVideoButton.react"),{className:this.props.className,"data-testid":b("VideoCallWebDriverIDs").TOGGLE_VIDEO_BUTTON,disabled:this.props.disabled,nodeRef:this.props.nodeRef,onClick:this.$1,videoMuted:this.props.videoMuted})};e.exports=a}),null);
__d("RTCCallControlsVideoEscalationButton.react",["React","RTCCallControlsVideoButton.react","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f){"use strict";a=function(a){var c=a.disabled;c=c===undefined?!1:c;var d=a.videoMuted;d=d===undefined?!0:d;a=babelHelpers.objectWithoutProperties(a,["disabled","videoMuted"]);return b("React").createElement(b("RTCCallControlsVideoButton.react"),{"data-testid":b("VideoCallWebDriverIDs").ESCALATE_CALL_BUTTON,disabled:c,onClick:a.onClick,videoMuted:d})};e.exports=a}),null);
__d("RTCGroupCallRemoteViewThumbnail.react",["cx","FBRTCVideo.react","Image.react","React","RTCRemoteViewPopoverMenuButton.react","RTCSVGIcon.react","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.isDominantSpeaker,d=a.isPinnedSpeaker,e=a.onClick;a=a.user;return b("React").createElement("div",{className:"_30dp"+(c?" dominant":""),"data-testid":b("VideoCallWebDriverIDs").REMOTE_VIEW_THUMBNAIL+a.FBID,onClick:e},b("React").createElement("div",{className:"_30dq"},b("React").createElement(b("RTCRemoteViewPopoverMenuButton.react"),{user:a})),d?b("React").createElement("div",null,b("React").createElement(b("RTCSVGIcon.react"),{className:"_5-vf"},b("React").createElement("svg",{viewBox:"0 0 36 36"},b("React").createElement("path",{d:"M0 0h32a4 4 0 0 1 4 4v32"}))),b("React").createElement(b("RTCSVGIcon.react"),{className:"_5-vg"},b("React").createElement("svg",{viewBox:"0 0 19 19"},b("React").createElement("path",{d:"M2.5 6.65h13a1 1 0 0 1 1 1v9.637a1 1 0 0 1-1 1H3.5a1 1 0 0 1-1-1V7.65a1 1 0 0 1 1-1M9.192 0h.616a4 4 0 0 1 4 4v.313a4 4 0 0 1-.754 2.337H5.946a4 4 0 0 1-.754-2.337V4a4 4 0 0 1 4-4m0 1h.616a3 3 0 0 1 3 3v.313a3 3 0 0 1-1.12 2.337H7.312a3 3 0 0 1-1.12-2.337V4a3 3 0 0 1 3-3",fillRule:"evenodd"})))):null,c||a.isVideoMuted()?b("React").createElement(b("Image.react"),{src:a.profilePictureUrl}):b("React").createElement(b("FBRTCVideo.react"),{mediaStream:a.getMainStream()}))};e.exports=a}),null);
__d("RTCGroupCallRemoteView.react",["cx","FBRTCGroupCallStore","FluxContainer","React","RTCGroupCallActions","RTCGroupCallDraggableComponent.react","RTCGroupCallRemoteViewThumbnail.react"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();d=function(a){var c=a.dominantSpeakerFBID,d=a.pinnedSpeakerFBID;a=a.remoteUsers;return b("React").createElement(b("RTCGroupCallDraggableComponent.react"),{className:"_1qwn"},a.map(function(a){return b("React").createElement(b("RTCGroupCallRemoteViewThumbnail.react"),{isDominantSpeaker:a.FBID===(d||c),isPinnedSpeaker:a.FBID===d,key:a.FBID,onClick:function(){a.FBID===d?b("RTCGroupCallActions").setPinnedSpeaker(null):b("RTCGroupCallActions").setPinnedSpeaker(a.FBID)},user:a})}))};function a(){return[b("FBRTCGroupCallStore")]}function c(){arguments.length<=0||arguments[0]===undefined?({}):arguments[0];var a=arguments[1],c=b("FBRTCGroupCallStore").getState(),d=c.dominantSpeakerFBID,e=c.pinnedSpeakerFBID;return babelHelpers["extends"]({dominantSpeakerFBID:d,pinnedSpeakerFBID:e},a)}e.exports=b("FluxContainer").createFunctional(d,a,c,{withProps:!0})}),null);
__d("RTCSelfViewAnimationConfig",[],(function(a,b,c,d,e,f){"use strict";a={stiffness:200,damping:25};e.exports={springConfig:a}}),null);
/**
 * License: https://www.facebook.com/legal/license/szRD2xg2JXY/
 */
__d("performance-now-0.2.0",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={};var g={exports:a};function h(){__p&&__p();(function(){var a,b,c;typeof performance!=="undefined"&&performance!==null&&performance.now?g.exports=function(){return performance.now()}:typeof process!=="undefined"&&process!==null&&process.hrtime?(g.exports=function(){return(a()-c)/1e6},b=process.hrtime,a=function(){var a;a=b();return a[0]*1e9+a[1]},c=a()):Date.now?(g.exports=function(){return Date.now()-c},c=Date.now()):(g.exports=function(){return new Date().getTime()-c},c=new Date().getTime())}).call(this)}var i=!1,j=function(){i||(i=!0,h());return g.exports};b=function(a){switch(a){case undefined:return j()}};e.exports=b}),null);
/**
 * License: https://www.facebook.com/legal/license/szRD2xg2JXY/
 */
__d("prop-types-15.6.0",["fbjs-0.8.16","object-assign-4.1.1"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("fbjs-0.8.16"));a(b("object-assign-4.1.1"));c={};var h={exports:c};function i(){var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";h.exports=a}var j=!1,k=function(){j||(j=!0,i());return h.exports};d={};var l={exports:d};function m(){__p&&__p();var a=g("/lib/emptyFunction"),b=g("/lib/invariant"),c=k();l.exports=function(){__p&&__p();function d(a,d,e,f,g,h){if(h===c)return;b(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}d.isRequired=d;function e(){return d}e={array:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:e,element:d,instanceOf:e,node:d,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};e.checkPropTypes=a;e.PropTypes=e;return e}}var n=!1,o=function(){n||(n=!0,m());return l.exports};f={};var p={exports:f};function q(){p.exports=o()()}var r=!1,s=function(){r||(r=!0,q());return p.exports};a=function(a){switch(a){case undefined:return s()}};e.exports=a}),null);
/**
 * License: https://www.facebook.com/legal/license/szRD2xg2JXY/
 */
__d("performance-now-2.1.0",[],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={};var g={exports:a};function h(){__p&&__p();(function(){var a,b,c,d,e,f;typeof performance!=="undefined"&&performance!==null&&performance.now?g.exports=function(){return performance.now()}:typeof process!=="undefined"&&process!==null&&process.hrtime?(g.exports=function(){return(a()-e)/1e6},b=process.hrtime,a=function(){var a;a=b();return a[0]*1e9+a[1]},d=a(),f=process.uptime()*1e9,e=d-f):Date.now?(g.exports=function(){return Date.now()-c},c=Date.now()):(g.exports=function(){return new Date().getTime()-c},c=new Date().getTime())}).call(this)}var i=!1,j=function(){i||(i=!0,h());return g.exports};b=function(a){switch(a){case undefined:return j()}};e.exports=b}),null);
/**
 * License: https://www.facebook.com/legal/license/szRD2xg2JXY/
 */
__d("raf-3.4.0",["performance-now-2.1.0"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function c(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=c(b("performance-now-2.1.0"));d={};var h={exports:d};function i(){__p&&__p();var b=g(),c=typeof window==="undefined"?a:window,d=["moz","webkit"],e="AnimationFrame",f=c["request"+e],i=c["cancel"+e]||c["cancelRequest"+e];for(var j=0;!f&&j<d.length;j++)f=c[d[j]+"Request"+e],i=c[d[j]+"Cancel"+e]||c[d[j]+"CancelRequest"+e];if(!f||!i){var k=0,l=0,m=[],n=1e3/60;f=function(a){__p&&__p();if(m.length===0){var c=b(),d=Math.max(0,n-(c-k));k=d+c;setTimeout(function(){var b=m.slice(0);m.length=0;for(var a=0;a<b.length;a++)if(!b[a].cancelled)try{b[a].callback(k)}catch(a){setTimeout(function(){throw a},0)}},Math.round(d))}m.push({handle:++l,callback:a,cancelled:!1});return l};i=function(b){for(var a=0;a<m.length;a++)m[a].handle===b&&(m[a].cancelled=!0)}}h.exports=function(a){return f.call(c,a)};h.exports.cancel=function(){i.apply(c,arguments)};h.exports.polyfill=function(a){a||(a=c),a.requestAnimationFrame=f,a.cancelAnimationFrame=i}}var j=!1,k=function(){j||(j=!0,i());return h.exports};f=function(a){switch(a){case undefined:return k()}};e.exports=f}),null);
/**
 * License: https://www.facebook.com/legal/license/szRD2xg2JXY/
 */
__d("react-motion-0.5.2",["performance-now-0.2.0","raf-3.4.0","react-0.0.0","prop-types-15.6.0"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a){return a&&typeof a==="object"&&"default"in a?a["default"]:a}var g=a(b("performance-now-0.2.0")),h=a(b("raf-3.4.0")),i=a(b("react-0.0.0")),j=a(b("prop-types-15.6.0")),k={},l={exports:k};function m(){k.__esModule=!0;k["default"]=a;function a(a){var b={};for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=0);return b}l.exports=k["default"]}var n=!1,o=function(){n||(n=!0,m());return l.exports},p={},q={exports:p};function r(){__p&&__p();p.__esModule=!0;p["default"]=a;function a(a){var b={};for(var c in a){if(!Object.prototype.hasOwnProperty.call(a,c))continue;b[c]=typeof a[c]==="number"?a[c]:a[c].val}return b}q.exports=p["default"]}var s=!1,t=function(){s||(s=!0,r());return q.exports},u={},v={exports:u};function w(){__p&&__p();u.__esModule=!0;u["default"]=b;var a=[0,0];function b(b,c,d,e,f,g,h){__p&&__p();f=-f*(c-e);g=-g*d;f=f+g;g=d+f*b;d=c+g*b;if(Math.abs(g)<h&&Math.abs(d-e)<h){a[0]=e;a[1]=0;return a}a[0]=d;a[1]=g;return a}v.exports=u["default"]}var x=!1,y=function(){x||(x=!0,w());return v.exports},z={},A={exports:z};function aa(){__p&&__p();z.__esModule=!0;z["default"]=a;function a(a,b,c){__p&&__p();for(var d in b){if(!Object.prototype.hasOwnProperty.call(b,d))continue;if(c[d]!==0)return!1;var e=typeof b[d]==="number"?b[d]:b[d].val;if(a[d]!==e)return!1}return!0}A.exports=z["default"]}var B=!1,C=function(){B||(B=!0,aa());return A.exports},D={},E={exports:D};function ba(){__p&&__p();D.__esModule=!0;var a=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},b=function(){__p&&__p();function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();function c(a){return a&&a.__esModule?a:{"default":a}}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var f=o(),k=c(f);f=t();var l=c(f);f=y();var m=c(f);f=g();var n=c(f);f=h();var p=c(f);f=C();var q=c(f);f=i();var r=c(f);f=j();var s=c(f),u=1e3/60;c=function(c){__p&&__p();e(f,c);b(f,null,[{key:"propTypes",value:{defaultStyle:s["default"].objectOf(s["default"].number),style:s["default"].objectOf(s["default"].oneOfType([s["default"].number,s["default"].object])).isRequired,children:s["default"].func.isRequired,onRest:s["default"].func},enumerable:!0}]);function f(b){__p&&__p();var e=this;d(this,f);c.call(this,b);this.wasAnimating=!1;this.animationID=null;this.prevTime=0;this.accumulatedTime=0;this.unreadPropStyle=null;this.clearUnreadPropStyle=function(b){var c=!1,d=e.state,f=d.currentStyle,g=d.currentVelocity,h=d.lastIdealStyle;d=d.lastIdealVelocity;for(var i in b){if(!Object.prototype.hasOwnProperty.call(b,i))continue;var j=b[i];typeof j==="number"&&(c||(c=!0,f=a({},f),g=a({},g),h=a({},h),d=a({},d)),f[i]=j,g[i]=0,h[i]=j,d[i]=0)}c&&e.setState({currentStyle:f,currentVelocity:g,lastIdealStyle:h,lastIdealVelocity:d})};this.startAnimationIfNecessary=function(){__p&&__p();e.animationID=p["default"](function(a){__p&&__p();var b=e.props.style;if(q["default"](e.state.currentStyle,b,e.state.currentVelocity)){e.wasAnimating&&e.props.onRest&&e.props.onRest();e.animationID=null;e.wasAnimating=!1;e.accumulatedTime=0;return}e.wasAnimating=!0;a=a||n["default"]();var c=a-e.prevTime;e.prevTime=a;e.accumulatedTime=e.accumulatedTime+c;e.accumulatedTime>u*10&&(e.accumulatedTime=0);if(e.accumulatedTime===0){e.animationID=null;e.startAnimationIfNecessary();return}a=(e.accumulatedTime-Math.floor(e.accumulatedTime/u)*u)/u;c=Math.floor(e.accumulatedTime/u);var d={},f={},g={},h={};for(var i in b){if(!Object.prototype.hasOwnProperty.call(b,i))continue;var j=b[i];if(typeof j==="number")g[i]=j,h[i]=0,d[i]=j,f[i]=0;else{var k=e.state.lastIdealStyle[i],l=e.state.lastIdealVelocity[i];for(var o=0;o<c;o++){var p=m["default"](u/1e3,k,l,j.val,j.stiffness,j.damping,j.precision);k=p[0];l=p[1]}p=m["default"](u/1e3,k,l,j.val,j.stiffness,j.damping,j.precision);o=p[0];j=p[1];g[i]=k+(o-k)*a;h[i]=l+(j-l)*a;d[i]=k;f[i]=l}}e.animationID=null;e.accumulatedTime-=c*u;e.unreadPropStyle=null;e.startAnimationIfNecessary();e.setState({currentStyle:g,currentVelocity:h,lastIdealStyle:d,lastIdealVelocity:f})})};this.state=this.defaultState()}f.prototype.defaultState=function(){var a=this.props,b=a.defaultStyle;a=a.style;b=b||l["default"](a);a=k["default"](b);return{currentStyle:b,currentVelocity:a,lastIdealStyle:b,lastIdealVelocity:a}};f.prototype.componentDidMount=function(){this.prevTime=n["default"](),this.startAnimationIfNecessary()};f.prototype.componentWillReceiveProps=function(a){this.unreadPropStyle!=null&&this.clearUnreadPropStyle(this.unreadPropStyle),this.unreadPropStyle=a.style,this.animationID==null&&(this.prevTime=n["default"](),this.startAnimationIfNecessary())};f.prototype.componentWillUnmount=function(){this.animationID!=null&&(p["default"].cancel(this.animationID),this.animationID=null)};f.prototype.render=function(){var a=this.props.children(this.state.currentStyle);return a&&r["default"].Children.only(a)};return f}(r["default"].Component);D["default"]=c;E.exports=D["default"]}var F=!1,ca=function(){F||(F=!0,ba());return E.exports},G={},H={exports:G};function da(){__p&&__p();G.__esModule=!0;var a=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},b=function(){__p&&__p();function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();function c(a){return a&&a.__esModule?a:{"default":a}}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var f=o(),k=c(f);f=t();var l=c(f);f=y();var m=c(f);f=g();var n=c(f);f=h();var p=c(f);f=C();var q=c(f);f=i();var r=c(f);f=j();var s=c(f),u=1e3/60;function v(a,b,c){for(var d=0;d<a.length;d++)if(!q["default"](a[d],b[d],c[d]))return!1;return!0}c=function(c){__p&&__p();e(f,c);b(f,null,[{key:"propTypes",value:{defaultStyles:s["default"].arrayOf(s["default"].objectOf(s["default"].number)),styles:s["default"].func.isRequired,children:s["default"].func.isRequired},enumerable:!0}]);function f(b){__p&&__p();var e=this;d(this,f);c.call(this,b);this.animationID=null;this.prevTime=0;this.accumulatedTime=0;this.unreadPropStyles=null;this.clearUnreadPropStyle=function(b){__p&&__p();var c=e.state,d=c.currentStyles,f=c.currentVelocities,g=c.lastIdealStyles;c=c.lastIdealVelocities;var h=!1;for(var i=0;i<b.length;i++){var j=b[i],k=!1;for(var l in j){if(!Object.prototype.hasOwnProperty.call(j,l))continue;var m=j[l];typeof m==="number"&&(k||(k=!0,h=!0,d[i]=a({},d[i]),f[i]=a({},f[i]),g[i]=a({},g[i]),c[i]=a({},c[i])),d[i][l]=m,f[i][l]=0,g[i][l]=m,c[i][l]=0)}}h&&e.setState({currentStyles:d,currentVelocities:f,lastIdealStyles:g,lastIdealVelocities:c})};this.startAnimationIfNecessary=function(){__p&&__p();e.animationID=p["default"](function(a){__p&&__p();var b=e.props.styles(e.state.lastIdealStyles);if(v(e.state.currentStyles,b,e.state.currentVelocities)){e.animationID=null;e.accumulatedTime=0;return}a=a||n["default"]();var c=a-e.prevTime;e.prevTime=a;e.accumulatedTime=e.accumulatedTime+c;e.accumulatedTime>u*10&&(e.accumulatedTime=0);if(e.accumulatedTime===0){e.animationID=null;e.startAnimationIfNecessary();return}a=(e.accumulatedTime-Math.floor(e.accumulatedTime/u)*u)/u;c=Math.floor(e.accumulatedTime/u);var d=[],f=[],g=[],h=[];for(var i=0;i<b.length;i++){var j=b[i],k={},l={},o={},p={};for(var q in j){if(!Object.prototype.hasOwnProperty.call(j,q))continue;var r=j[q];if(typeof r==="number")k[q]=r,l[q]=0,o[q]=r,p[q]=0;else{var s=e.state.lastIdealStyles[i][q],t=e.state.lastIdealVelocities[i][q];for(var w=0;w<c;w++){var x=m["default"](u/1e3,s,t,r.val,r.stiffness,r.damping,r.precision);s=x[0];t=x[1]}x=m["default"](u/1e3,s,t,r.val,r.stiffness,r.damping,r.precision);w=x[0];r=x[1];k[q]=s+(w-s)*a;l[q]=t+(r-t)*a;o[q]=s;p[q]=t}}g[i]=k;h[i]=l;d[i]=o;f[i]=p}e.animationID=null;e.accumulatedTime-=c*u;e.unreadPropStyles=null;e.startAnimationIfNecessary();e.setState({currentStyles:g,currentVelocities:h,lastIdealStyles:d,lastIdealVelocities:f})})};this.state=this.defaultState()}f.prototype.defaultState=function(){var a=this.props,b=a.defaultStyles;a=a.styles;b=b||a().map(l["default"]);a=b.map(function(a){return k["default"](a)});return{currentStyles:b,currentVelocities:a,lastIdealStyles:b,lastIdealVelocities:a}};f.prototype.componentDidMount=function(){this.prevTime=n["default"](),this.startAnimationIfNecessary()};f.prototype.componentWillReceiveProps=function(a){this.unreadPropStyles!=null&&this.clearUnreadPropStyle(this.unreadPropStyles),this.unreadPropStyles=a.styles(this.state.lastIdealStyles),this.animationID==null&&(this.prevTime=n["default"](),this.startAnimationIfNecessary())};f.prototype.componentWillUnmount=function(){this.animationID!=null&&(p["default"].cancel(this.animationID),this.animationID=null)};f.prototype.render=function(){var a=this.props.children(this.state.currentStyles);return a&&r["default"].Children.only(a)};return f}(r["default"].Component);G["default"]=c;H.exports=G["default"]}var I=!1,ea=function(){I||(I=!0,da());return H.exports},J={},K={exports:J};function fa(){__p&&__p();J.__esModule=!0;J["default"]=a;function a(a,b,c){__p&&__p();var d={};for(var e=0;e<a.length;e++)d[a[e].key]=e;var f={};for(var e=0;e<b.length;e++)f[b[e].key]=e;var g=[];for(var e=0;e<b.length;e++)g[e]=b[e];for(var e=0;e<a.length;e++)if(!Object.prototype.hasOwnProperty.call(f,a[e].key)){var h=c(e,a[e]);h!=null&&g.push(h)}return g.sort(function(a,c){__p&&__p();var e=f[a.key],g=f[c.key],h=d[a.key],i=d[c.key];if(e!=null&&g!=null)return f[a.key]-f[c.key];else if(h!=null&&i!=null)return d[a.key]-d[c.key];else if(e!=null){for(var a=0;a<b.length;a++){c=b[a].key;if(!Object.prototype.hasOwnProperty.call(d,c))continue;if(e<f[c]&&i>d[c])return-1;else if(e>f[c]&&i<d[c])return 1}return 1}for(var a=0;a<b.length;a++){c=b[a].key;if(!Object.prototype.hasOwnProperty.call(d,c))continue;if(g<f[c]&&h>d[c])return 1;else if(g>f[c]&&h<d[c])return-1}return-1})}K.exports=J["default"]}var L=!1,ga=function(){L||(L=!0,fa());return K.exports},M={},N={exports:M};function ha(){__p&&__p();M.__esModule=!0;var a=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},b=function(){__p&&__p();function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}();function c(a){return a&&a.__esModule?a:{"default":a}}function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var f=o(),k=c(f);f=t();var l=c(f);f=y();var m=c(f);f=ga();var n=c(f);f=g();var p=c(f);f=h();var q=c(f);f=C();var r=c(f);f=i();var s=c(f);f=j();var u=c(f),v=1e3/60;function w(a,b,c){var d=b;return d==null?a.map(function(a,b){return{key:a.key,data:a.data,style:c[b]}}):a.map(function(a,b){for(var e=0;e<d.length;e++)if(d[e].key===a.key)return{key:d[e].key,data:d[e].data,style:c[b]};return{key:a.key,data:a.data,style:c[b]}})}function x(a,b,c,d){if(d.length!==b.length)return!1;for(var e=0;e<d.length;e++)if(d[e].key!==b[e].key)return!1;for(var e=0;e<d.length;e++)if(!r["default"](a[e],b[e].style,c[e]))return!1;return!0}function z(a,b,c,d,e,f,g,h,i){__p&&__p();e=n["default"](d,e,function(a,d){__p&&__p();var e=b(d);if(e==null){c({key:d.key,data:d.data});return null}if(r["default"](f[a],e,g[a])){c({key:d.key,data:d.data});return null}return{key:d.key,data:d.data,style:e}});var j=[],l=[],m=[],o=[];for(var p=0;p<e.length;p++){var q=e[p],s=null;for(var t=0;t<d.length;t++)if(d[t].key===q.key){s=t;break}if(s==null){t=a(q);j[p]=t;m[p]=t;t=k["default"](q.style);l[p]=t;o[p]=t}else j[p]=f[s],m[p]=h[s],l[p]=g[s],o[p]=i[s]}return[e,j,l,m,o]}c=function(c){__p&&__p();e(f,c);b(f,null,[{key:"propTypes",value:{defaultStyles:u["default"].arrayOf(u["default"].shape({key:u["default"].string.isRequired,data:u["default"].any,style:u["default"].objectOf(u["default"].number).isRequired})),styles:u["default"].oneOfType([u["default"].func,u["default"].arrayOf(u["default"].shape({key:u["default"].string.isRequired,data:u["default"].any,style:u["default"].objectOf(u["default"].oneOfType([u["default"].number,u["default"].object])).isRequired}))]).isRequired,children:u["default"].func.isRequired,willEnter:u["default"].func,willLeave:u["default"].func,didLeave:u["default"].func},enumerable:!0},{key:"defaultProps",value:{willEnter:function(a){return l["default"](a.style)},willLeave:function(){return null},didLeave:function(){}},enumerable:!0}]);function f(b){__p&&__p();var e=this;d(this,f);c.call(this,b);this.unmounting=!1;this.animationID=null;this.prevTime=0;this.accumulatedTime=0;this.unreadPropStyles=null;this.clearUnreadPropStyle=function(b){__p&&__p();var c=z(e.props.willEnter,e.props.willLeave,e.props.didLeave,e.state.mergedPropsStyles,b,e.state.currentStyles,e.state.currentVelocities,e.state.lastIdealStyles,e.state.lastIdealVelocities),d=c[0],f=c[1],g=c[2],h=c[3];c=c[4];for(var i=0;i<b.length;i++){var j=b[i].style,k=!1;for(var l in j){if(!Object.prototype.hasOwnProperty.call(j,l))continue;var m=j[l];typeof m==="number"&&(k||(k=!0,f[i]=a({},f[i]),g[i]=a({},g[i]),h[i]=a({},h[i]),c[i]=a({},c[i]),d[i]={key:d[i].key,data:d[i].data,style:a({},d[i].style)}),f[i][l]=m,g[i][l]=0,h[i][l]=m,c[i][l]=0,d[i].style[l]=m)}}e.setState({currentStyles:f,currentVelocities:g,mergedPropsStyles:d,lastIdealStyles:h,lastIdealVelocities:c})};this.startAnimationIfNecessary=function(){__p&&__p();if(e.unmounting)return;e.animationID=q["default"](function(a){__p&&__p();if(e.unmounting)return;var b=e.props.styles;b=typeof b==="function"?b(w(e.state.mergedPropsStyles,e.unreadPropStyles,e.state.lastIdealStyles)):b;if(x(e.state.currentStyles,b,e.state.currentVelocities,e.state.mergedPropsStyles)){e.animationID=null;e.accumulatedTime=0;return}a=a||p["default"]();var c=a-e.prevTime;e.prevTime=a;e.accumulatedTime=e.accumulatedTime+c;e.accumulatedTime>v*10&&(e.accumulatedTime=0);if(e.accumulatedTime===0){e.animationID=null;e.startAnimationIfNecessary();return}a=(e.accumulatedTime-Math.floor(e.accumulatedTime/v)*v)/v;c=Math.floor(e.accumulatedTime/v);b=z(e.props.willEnter,e.props.willLeave,e.props.didLeave,e.state.mergedPropsStyles,b,e.state.currentStyles,e.state.currentVelocities,e.state.lastIdealStyles,e.state.lastIdealVelocities);var d=b[0],f=b[1],g=b[2],h=b[3];b=b[4];for(var i=0;i<d.length;i++){var j=d[i].style,k={},l={},n={},o={};for(var q in j){if(!Object.prototype.hasOwnProperty.call(j,q))continue;var r=j[q];if(typeof r==="number")k[q]=r,l[q]=0,n[q]=r,o[q]=0;else{var s=h[i][q],t=b[i][q];for(var u=0;u<c;u++){var y=m["default"](v/1e3,s,t,r.val,r.stiffness,r.damping,r.precision);s=y[0];t=y[1]}y=m["default"](v/1e3,s,t,r.val,r.stiffness,r.damping,r.precision);u=y[0];r=y[1];k[q]=s+(u-s)*a;l[q]=t+(r-t)*a;n[q]=s;o[q]=t}}h[i]=n;b[i]=o;f[i]=k;g[i]=l}e.animationID=null;e.accumulatedTime-=c*v;e.unreadPropStyles=null;e.startAnimationIfNecessary();e.setState({currentStyles:f,currentVelocities:g,lastIdealStyles:h,lastIdealVelocities:b,mergedPropsStyles:d})})};this.state=this.defaultState()}f.prototype.defaultState=function(){__p&&__p();var a=this.props,b=a.defaultStyles,c=a.styles,d=a.willEnter,e=a.willLeave;a=a.didLeave;var f=typeof c==="function"?c(b):c;c=undefined;b==null?c=f:c=b.map(function(a){for(var b=0;b<f.length;b++)if(f[b].key===a.key)return f[b];return a});var g=b==null?f.map(function(a){return l["default"](a.style)}):b.map(function(a){return l["default"](a.style)});b=b==null?f.map(function(a){return k["default"](a.style)}):b.map(function(a){return k["default"](a.style)});d=z(d,e,a,c,f,g,b,g,b);e=d[0];a=d[1];c=d[2];g=d[3];b=d[4];return{currentStyles:a,currentVelocities:c,lastIdealStyles:g,lastIdealVelocities:b,mergedPropsStyles:e}};f.prototype.componentDidMount=function(){this.prevTime=p["default"](),this.startAnimationIfNecessary()};f.prototype.componentWillReceiveProps=function(a){this.unreadPropStyles&&this.clearUnreadPropStyle(this.unreadPropStyles);a=a.styles;typeof a==="function"?this.unreadPropStyles=a(w(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.lastIdealStyles)):this.unreadPropStyles=a;this.animationID==null&&(this.prevTime=p["default"](),this.startAnimationIfNecessary())};f.prototype.componentWillUnmount=function(){this.unmounting=!0,this.animationID!=null&&(q["default"].cancel(this.animationID),this.animationID=null)};f.prototype.render=function(){var a=w(this.state.mergedPropsStyles,this.unreadPropStyles,this.state.currentStyles);a=this.props.children(a);return a&&s["default"].Children.only(a)};return f}(s["default"].Component);M["default"]=c;N.exports=M["default"]}var O=!1,ia=function(){O||(O=!0,ha());return N.exports},P={},Q={exports:P};function ja(){P.__esModule=!0,P["default"]={noWobble:{stiffness:170,damping:26},gentle:{stiffness:120,damping:14},wobbly:{stiffness:180,damping:12},stiff:{stiffness:210,damping:20}},Q.exports=P["default"]}var R=!1,S=function(){R||(R=!0,ja());return Q.exports},T={},U={exports:T};function ka(){__p&&__p();T.__esModule=!0;var a=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};T["default"]=d;function b(a){return a&&a.__esModule?a:{"default":a}}d=S();b=b(d);var c=a({},b["default"].noWobble,{precision:.01});function d(b,d){return a({},c,d,{val:b})}U.exports=T["default"]}var V=!1,la=function(){V||(V=!0,ka());return U.exports},W={},X={exports:W};function ma(){W.__esModule=!0;W["default"]=a;function a(){}X.exports=W["default"]}var Y=!1,na=function(){Y||(Y=!0,ma());return X.exports},Z={},oa={exports:Z};function pa(){__p&&__p();Z.__esModule=!0;function a(a){return a&&a.__esModule?a["default"]:a}var b=ca();Z.Motion=a(b);b=ea();Z.StaggeredMotion=a(b);b=ia();Z.TransitionMotion=a(b);b=la();Z.spring=a(b);b=S();Z.presets=a(b);b=t();Z.stripStyle=a(b);b=na();Z.reorderKeys=a(b)}var $=!1,qa=function(){$||($=!0,pa());return oa.exports};c=function(a){switch(a){case undefined:return qa()}};e.exports=c}),null);
__d("react-motion",["react-motion-0.5.2"],(function(a,b,c,d,e,f){e.exports=b("react-motion-0.5.2")()}),null);
__d("ReactMotion",["react-motion"],(function(a,b,c,d,e,f){e.exports=b("react-motion")}),null);
__d("RTCSelfViewTile.react",["cx","React","ReactMotion","RTCElementResizeListener.react","RTCSelfViewAnimationConfig","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("ReactMotion").Motion,j=b("ReactMotion").spring,k=b("RTCSelfViewAnimationConfig").springConfig;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={width:0},this.$1=function(a){this.setState({width:a.width})}.bind(this),b}a.prototype.render=function(){return b("React").createElement(i,{defaultStyle:{x:0},style:{x:j(this.state.width-l(this.props,this.state),k)}},function(a){return b("React").createElement("div",{className:b("joinClasses")("_drs"+(this.props.focused?" focused":"")+(this.props.hovered?" hovered":""),this.props.className),style:babelHelpers["extends"]({width:l(this.props,this.state)},this.props.style)},b("React").createElement("div",{className:"_drt",style:{width:this.state.width}},b("React").createElement(b("RTCElementResizeListener.react"),{className:"_dru",onResize:this.$1,style:{transform:"translateX("+a.x+"px)"}},this.props.children)),b("React").createElement("button",{className:"_drv",onClick:this.props.onClick}))}.bind(this))};a.prototype.componentDidUpdate=function(a,b){var c=l(this.props,this.state);c!==l(a,b)&&this.props.onResize({width:c,height:0})};a.defaultProps={collapsed:!1,focused:!1,hovered:!1};function l(a,b){return a.collapsed?a.focused||a.hovered?30:22:b.width}e.exports=a}),null);
__d("RTCSelfViewTileLayer.react",["cx","React","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className,e=a.renderBackground;e=e===undefined?!1:e;var f=a.visible;f=f===undefined?!0:f;a=babelHelpers.objectWithoutProperties(a,["children","className","renderBackground","visible"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")("_drw"+(f?" _drx":"")+(e?" _dry":""),d)},a),c)};e.exports=a}),null);
__d("RTCSelfViewCameraStream.react",["cx","fbt","FBRTCVideo.react","Image.react","React","RTCSelfViewTile.react","RTCSelfViewTileLayer.react","RTCSVGIcon.react","RTCUIMicrophoneIcon.react","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){var c=a.collapsed,d=a.focused,e=a.isFilterMode,f=a.hovered,g=a.user;a=babelHelpers.objectWithoutProperties(a,["collapsed","focused","isFilterMode","hovered","user"]);var i=g.isAudioMuted(),j=g.getMainStream(),k=g.isVideoMuted();return b("React").createElement(b("RTCSelfViewTile.react"),{collapsed:c,focused:d,hovered:f,onClick:a.onClick,onResize:a.onResize,style:a.style},b("React").createElement(b("FBRTCVideo.react"),{className:"_88q mirror"+(g.isVideoMuted()||j==null?" muted":""),"data-testid":b("VideoCallWebDriverIDs").RTC_SELF_VIEW,mediaStream:j,muted:!0}),b("React").createElement(b("RTCSelfViewTileLayer.react"),{renderBackground:i||k,visible:k},b("React").createElement(b("Image.react"),{alt:h._("Profile Picture"),className:"_drz",src:g.profilePictureUrl})),b("React").createElement(b("RTCSelfViewTileLayer.react"),{renderBackground:!k,visible:i},b("React").createElement(b("RTCUIMicrophoneIcon.react"),{className:"_drz",strikeThrough:!0})),e?null:b("React").createElement(b("RTCSelfViewTileLayer.react"),{renderBackground:d||f},b("React").createElement(b("RTCSVGIcon.react"),null,b("React").createElement("svg",{className:"_drz _dr_",height:28,viewBox:"0 0 8 28",width:8},b("React").createElement("path",{d:c?"M6 2L2 14L6 26":"M2 2L6 14L2 26",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3})))))};e.exports=a}),null);
__d("RTCSelfViewScreenStream.react",["cx","fbt","FBRTCVideo.react","React","RTCSelfViewTile.react","RTCSelfViewTileLayer.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.$1=function(){var a=this.props.user.getScreenStream();if(!a||!this.props.onStopSharing)return;this.props.onStopSharing(a)}.bind(this),b}a.prototype.render=function(){var a=this.props,c=a.focused,d=a.hovered;a=a.user;a=a.getScreenStream();return!a?null:b("React").createElement(b("RTCSelfViewTile.react"),{focused:c,hovered:d,onClick:this.$1,onResize:this.props.onResize,style:this.props.style},b("React").createElement(b("FBRTCVideo.react"),{className:"_88q",mediaStream:a,muted:!0}),this.props.onStopSharing!=null?b("React").createElement(b("RTCSelfViewTileLayer.react"),{renderBackground:!0,visible:c||d},b("React").createElement("span",{className:"_dr-"},h._("Stop"))):null)};e.exports=a}),null);
__d("RTCToggleVideoFiltersIcon.react",["cx","fbt","React","RTCCallControlsButton.react","RTCSVGIcon.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){var c=a.className,d=a.disabled;d=d===undefined?!1:d;var e=a.onClick;babelHelpers.objectWithoutProperties(a,["className","disabled","onClick"]);return b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")(c,"semiopaque icon-48 videoFilters"),disabled:d,onClick:e?e:function(){},title:h._("Add a filter to your video")},b("React").createElement(b("RTCSVGIcon.react"),null,b("React").createElement("svg",{viewBox:"0 0 36 36"},b("React").createElement("defs",null,b("React").createElement("filter",{id:"a",width:"169%",height:"165.5%",x:"-34.5%",y:"-24.1%",filterUnits:"objectBoundingBox"},b("React").createElement("feOffset",{dy:"2","in":"SourceAlpha",result:"shadowOffsetOuter1"}),b("React").createElement("feGaussianBlur",{"in":"shadowOffsetOuter1",result:"shadowBlurOuter1",stdDeviation:"2"}),b("React").createElement("feColorMatrix",{"in":"shadowBlurOuter1",result:"shadowMatrixOuter1",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),b("React").createElement("feMerge",null,b("React").createElement("feMergeNode",{"in":"shadowMatrixOuter1"}),b("React").createElement("feMergeNode",{"in":"SourceGraphic"})))),b("React").createElement("g",{fill:"none",fillRule:"evenodd",filter:"url(#a)",transform:"translate(5)"},b("React").createElement("path",{d:"M11.40061293 3.9017668l5.4259751 6.2797418 8.11984779-.9354691-4.1463352 7.13037962 3.45892004 7.57303275-7.98836523-1.87243905-5.98190777 5.61576242-.7910037-8.28789878-7.15602142-4.10192228 7.49972902-3.2497839z",stroke:"#FFF",strokeWidth:"2"}),b("React").createElement("circle",{cx:"2.63636364",cy:"23.7272727",r:"2.63636364",stroke:"#FFF",strokeWidth:"2"}),b("React").createElement("circle",{cx:"4.39393939",cy:"7.03030303",fill:"#FFF",r:"1.75757576"}),b("React").createElement("circle",{cx:"18.4545455",cy:"27.2424242",fill:"#FFF",r:"1"}),b("React").createElement("circle",{cx:"26.3636364",cy:"15.8181818",fill:"#FFF",r:"1"}),b("React").createElement("circle",{cx:"21.0909091",cy:"5.27272727",fill:"#FFF",r:"1"})))))};e.exports=a}),null);
__d("RTCSVGIconDropShadowFilter.react",["React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PureComponent;var h=0;d=babelHelpers.inherits(a,c);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1="filter:blur."+h+++"."+Date.now().toString(24),b}a.prototype.render=function(){var a=this.props,c=a.blur,d=a.x;a=a.y;var e=Math.ceil(c*3*Math.sqrt(2*Math.PI)/8);return b("React").createElement("filter",{id:this.getID(),height:this.props.height+e*2,width:this.props.width+e*2,x:d-e,y:a-e},b("React").createElement("feGaussianBlur",{"in":"SourceAlpha",result:"blur",stdDeviation:c}),b("React").createElement("feOffset",{dx:d,dy:a,"in":"blur",result:"offsetBlur"}),b("React").createElement("feFlood",{floodColor:this.props.color,floodOpacity:this.props.opacity}),b("React").createElement("feComposite",{in2:"offsetBlur",operator:"in",result:"shadow"}),b("React").createElement("feMorphology",{operator:"dilate",radius:"1","in":"SourceAlpha",result:"outline"}),b("React").createElement("feFlood",{floodColor:"#000",floodOpacity:.1}),b("React").createElement("feComposite",{in2:"outline",operator:"in",result:"stroke"}),b("React").createElement("feMerge",null,b("React").createElement("feMergeNode",{"in":"shadow"}),b("React").createElement("feMergeNode",{"in":"stroke"}),b("React").createElement("feMergeNode",{"in":"SourceGraphic"})))};a.prototype.getID=function(){return this.props.id||this.$1};a.prototype.getURL=function(){return"url(#"+this.getID()+")"};a.defaultProps={blur:2,color:"#000",opacity:.2,x:0,y:1};e.exports=a}),null);
__d("RTCUIFullscreenIcon.react",["React","RTCSVGIcon.react","RTCSVGIconDropShadowFilter.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1="",this.$2=function(a){a&&(this.$1=a.getURL(),this.forceUpdate())}.bind(this),b}a.prototype.render=function(){var a=this.props,c=a.direction,d=a.shadow;a=babelHelpers.objectWithoutProperties(a,["direction","shadow"]);return d?b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement("defs",null,b("React").createElement(b("RTCSVGIconDropShadowFilter.react"),{height:20,ref:this.$2,width:20})),b("React").createElement("g",{filter:this.$1},b("React").createElement(h,{direction:c})))):b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement(h,{direction:c})))};a.defaultProps={shadow:!1};var h=function(a){a=a.direction;return a==="in"?b("React").createElement("path",{d:"M25.8 24.2c.2.2.4.3.7.3h6c.5 0 1-.4 1-1s-.4-1-1-1h-3.6l4.8-4.8c.4-.4.4-1 0-1.4-.4-.4-1-.4-1.4 0l-4.8 4.8v-3.6c0-.5-.4-1-1-1s-1 .4-1 1v6c0 .3.1.5.3.7zM24.2 25.8c.2.2.3.5.3.8v6c0 .6-.4 1-1 1s-1-.5-1-1V29l-4.8 4.7c-.4.4-1 .4-1.4 0s-.4-1 0-1.4l4.8-4.8h-3.6c-.6 0-1-.4-1-1s.5-1 1-1h6c.3 0 .5.1.7.3z"}):b("React").createElement("path",{d:"M33.7 16.3c-.2-.2-.4-.3-.7-.3h-6c-.5 0-1 .4-1 1s.4 1 1 1h3.6l-4.8 4.8c-.4.4-.4 1 0 1.4s1 .4 1.4 0l4.8-4.8V23c0 .5.4 1 1 1s1-.4 1-1v-6c0-.3-.1-.5-.3-.7zM16.3 33.7c-.2-.2-.3-.4-.3-.7v-6c0-.5.4-1 1-1s1 .4 1 1v3.6l4.8-4.8c.4-.4 1-.4 1.4 0s.4 1 0 1.4L19.5 32h3.6c.5 0 1 .4 1 1s-.4 1-1 1h-6c-.3 0-.6-.1-.8-.3z"})};e.exports=a}),null);
__d("RTCVideoFilterOptionButton.react",["cx","fbt","Image.react","React","RTCCallControlsButton.react","RTCSVGIcon.react","RTCVideoFilterConfig","RTCVideoFilterRenderer","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PureComponent;var j=b("RTCVideoFilterConfig").config;d=babelHelpers.inherits(a,c);i=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){this.props.filterName&&!this.props.highlighted?b("RTCVideoFilterRenderer").applyStreamEffect(this.props.filterName):b("RTCVideoFilterRenderer").removeStreamEffect()}.bind(this),c}a.prototype.render=function(){var a=this.props,c=a.className,d=a.disabled,e=a.filterName;a=a.highlighted;return b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")(c,"_66h4 semiopaque icon-48"),disabled:d,highlighted:a,onClick:this.$1,title:h._("Add Effect")},b("React").createElement(k,{filterName:e}))};var k=function(a){a=a.filterName;return b("React").createElement(b("Image.react"),{className:"_1oer",src:j[a].thumbnail_url})};e.exports=a}),null);
__d("RTCVideoFilterControls.react",["ix","cx","fbt","Image.react","React","RTCCallControlsButton.react","RTCToggleVideoFiltersIcon.react","RTCUIFullscreenIcon.react","RTCVideoFilterConfig","RTCVideoFilterOptionButton.react","asset","joinClasses"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("RTCVideoFilterConfig").config;c=babelHelpers.inherits(a,b("React").PureComponent);j=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.state={scrollLeft:!1},b}a.prototype.render=function(){var a=this.props;return b("React").createElement(b("React").Fragment,null,a.displayOptions?b("React").createElement(l,{onClick:a.onToggle}):null,b("React").createElement("section",{className:b("joinClasses")("_4e38"+(a.displayOptions?" _4e39":""),a.className)},a.displayOptions?b("React").createElement(b("React").Fragment,null,b("React").createElement(m,{alignLeft:this.state.scrollLeft,onClick:function(){this.setState(function(a,b){return{scrollLeft:!a.scrollLeft}})}.bind(this)}),b("React").createElement("div",{className:"_4e3a"},b("React").createElement(n,{currentFilter:a.currentFilter,showAdditionalFilters:this.state.scrollLeft}))):b("React").createElement(b("RTCToggleVideoFiltersIcon.react"),{className:"_4e3b",onClick:a.onToggle})))};var l=function(a){return b("React").createElement(b("RTCCallControlsButton.react"),{className:"_4e3c transparent icon-48",onClick:a.onClick,title:i._("Close filter options")},b("React").createElement(b("RTCUIFullscreenIcon.react"),{direction:"in",shadow:!0}))},m=function(a){return b("React").createElement(b("RTCCallControlsButton.react"),{className:(a.alignLeft?"_69rf":"")+(a.alignLeft?"":" _1oes")+" icon-16",onClick:a.onClick,title:i._("See more filters")},b("React").createElement(b("Image.react"),{src:a.alignLeft?g("561422"):g("561433")}))},n=function(a){var c=a.currentFilter,d=[];for(var e in k)d.push(b("React").createElement(b("RTCVideoFilterOptionButton.react"),{filterName:e,highlighted:c===e,key:e}));!a.showAdditionalFilters?d=d.splice(Math.ceil(d.length/2),d.length):d=d.splice(0,Math.floor(d.length/2));return b("React").createElement(b("React").Fragment,null,d)};e.exports=a}),null);
__d("RTCSelfView.react",["cx","FBRTCSupport","React","ReactMotion","RTCSelfViewAnimationConfig","RTCSelfViewCameraStream.react","RTCSelfViewScreenStream.react","RTCVideoFilterControls.react","joinClasses","keyMirror"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("ReactMotion").TransitionMotion,j=b("ReactMotion").spring,k=b("ReactMotion").stripStyle,l=b("RTCSelfViewAnimationConfig").springConfig,m=10,n=b("keyMirror")({CAMERA:null,SCREEN:null});c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={cameraViewCollapsed:!1,filtersEnabled:!1,focused:!1,hovered:!1,showFilterOptions:!1,tiles:[],width:0},b}a.getDerivedStateFromProps=function(a,b){var c=q(a);return{filtersEnabled:c,showFilterOptions:c?b.showFilterOptions:!1,tiles:o(a,b.tiles)}};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.className,d=a.user,e=babelHelpers.objectWithoutProperties(a,["className","user"]);if(!(d.hasVideo()||d.hasScreenStream()))return null;a=this.state;var f=a.cameraViewCollapsed,g=a.focused,h=a.hovered;return b("React").createElement(i,{styles:this.$1(),willEnter:function(a){a=a.style;return babelHelpers["extends"]({},k(a),{opacity:0})},willLeave:function(a){a=a.style;return babelHelpers["extends"]({},a,{opacity:j(0,l)})}},function(a){__p&&__p();return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")("_u2-"+(this.state.showFilterOptions?" filters":""),c),onBlur:function(){return this.setState({focused:!1})}.bind(this),onFocus:function(){return this.setState({focused:!0})}.bind(this),onMouseEnter:function(){return this.setState({hovered:!0})}.bind(this),onMouseLeave:function(){return this.setState({hovered:!1})}.bind(this),style:{width:this.state.width}},e),a.map(function(a){switch(a.key){case n.CAMERA:return b("React").createElement(b("RTCSelfViewCameraStream.react"),{collapsed:f,focused:g,hovered:h,isFilterMode:this.state.showFilterOptions,key:a.key,onClick:function(){return this.setState(function(a){return{cameraViewCollapsed:!a.cameraViewCollapsed,showFilterOptions:!1}})}.bind(this),onResize:function(a){return this.$2(n.CAMERA,a.width)}.bind(this),style:this.$3(a.style),user:d});case n.SCREEN:return b("React").createElement(b("RTCSelfViewScreenStream.react"),{focused:g,hovered:h,key:a.key,onResize:function(a){return this.$2(n.SCREEN,a.width)}.bind(this),onStopSharing:this.props.onScreenSharingStop,style:this.$3(a.style),user:d});default:return null}}.bind(this)),this.state.filtersEnabled&&!f?b("React").createElement(r,{onToggle:function(){return this.setState(function(a){return{showFilterOptions:!a.showFilterOptions}})}.bind(this),showOptions:this.state.showFilterOptions,user:d}):null)}.bind(this))};a.prototype.$1=function(){var a=this.state.tiles,b=a.map(function(a){return a.width});return a.map(function(a,c){var d=b.reduce(function(a,b,d){return b<=0||d<=c?a:a+b+m},0);return{key:a.type,style:{opacity:j(1,l),x:j(d,l)}}})};a.prototype.$2=function(a,b){this.setState(function(c){c=c.tiles;return{tiles:c.map(function(c){return c.type===a?p(a,b):c})}})};a.prototype.$3=function(a){var b=a.opacity;a=a.x;return{opacity:b,transform:"translateX(-"+a+"px)"}};a.prototype.componentDidUpdate=function(a,b){__p&&__p();if(b.tiles!==this.state.tiles){a=this.state.tiles.reduce(function(a,b,c){b=b.width;return b<=0?a:c>0?a+b+m:a+b},0);this.setState({width:a})}if(b.width!==this.state.width){a=this.props.onResize;a!=null&&a({height:0,width:this.state.width})}};a.defaultProps={hideCameraViewWhenScreenSharing:!1};function o(a,b){__p&&__p();var c=a.user;b=b;var d=b.find(function(a){return a.type===n.CAMERA});c.hasStream()&&!(a.hideCameraViewWhenScreenSharing&&c.hasScreenStream())?d==null&&(b=[].concat(b,[p(n.CAMERA)])):d!=null&&(b=b.filter(function(a){return a.type!==n.CAMERA}));a=b.find(function(a){return a.type===n.SCREEN});c.hasScreenStream()?a==null&&(b=[p(n.SCREEN)].concat(b)):a&&(b=b.filter(function(a){return a.type!==n.SCREEN}));return b}function p(a){var b=arguments.length<=1||arguments[1]===undefined?0:arguments[1];return{type:a,width:b}}function q(a){return!b("FBRTCSupport").isVideoFilterEffectSupported()||a.hideCameraViewWhenScreenSharing&&a.user.hasScreenStream()||a.user.isVideoMuted()?!1:!0}var r=function(a){if(!a.showOptions)return b("React").createElement(b("RTCVideoFilterControls.react"),{onToggle:a.onToggle});var c=a.user.videoFilter;return b("React").createElement(b("RTCVideoFilterControls.react"),{currentFilter:c,displayOptions:!0,onToggle:a.onToggle})};e.exports=a}),null);
__d("RTCMWAppViewFooter.react",["cx","Promise","CollabRTCChromeScreenSharingExtension","FBRTCConstants","FBRTCHangupReason","FBRTCParticipantCallState","FBRTCScreenSharingUtils","MediaRequestSourceApp","React","RTCAppViewFooter.react","RTCCallControls.react","RTCCallControlsAddGroupMembersButton.react","RTCCallControlsCloseWindowButton.react","RTCCallControlsEndCallButton.react","RTCCallControlsToggleAudioButton.react","RTCCallControlsToggleScreenSharingWithFunnelButton.react","RTCCallControlsToggleVideoButton.react","RTCCallControlsVideoEscalationButton.react","RTCConferenceState","RTCGroupCallRemoteView.react","RTCMWProtocolHandler","RTCSelfView.react","UserAgent"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("FBRTCConstants").GroupVideoViewLayout;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=0,this.$2=0,this.$3=0,this.$5=0,this.$6=null,this.$9=function(){b("RTCMWProtocolHandler").endCall(this.props.conferenceName,this.props.serverInfoData,b("FBRTCHangupReason").HANGUP_CALL)}.bind(this),this.$7=function(a){a=a.width;if(this.$1===a)return;this.$1=a;this.$11()}.bind(this),this.$8=function(a){a=a.width;if(this.$3===a)return;this.$3=a;this.$11()}.bind(this),this.$10=function(a){a=a.width;if(this.$2===a)return;this.$2=a;this.$11()}.bind(this),c}a.prototype.render=function(){__p&&__p();var a=this.props,c=a.hasVideoInput,d=a.isAudioCall,e=a.layout;a=a.localUser;e=e===i.DOMINANT_SPEAKER;switch(this.props.conferenceState){case b("RTCConferenceState").CONNECTING:case b("RTCConferenceState").CONNECTED:var f=a&&a.getScreenStream(),g=b("React").createElement(b("RTCCallControlsAddGroupMembersButton.react"),{className:e?"addMember":"",localUser:a,participants:this.props.participants,remoteUsers:this.props.remoteUsers,thread:this.props.thread});return b("React").createElement(b("RTCAppViewFooter.react"),{onResize:this.$7},b("React").createElement(b("RTCCallControls.react"),{autoHide:!d,className:"_5rdt"+(!d&&e?" video":""),onResize:this.$8,ref:function(a){return this.$4=a?a.getDOMNode():a}.bind(this)},a.hasVideo()?b("React").createElement(b("RTCCallControlsToggleVideoButton.react"),{conferenceState:this.props.conferenceState,disabled:!!f,isP2P:!1,videoMuted:a.isVideoMuted()}):b("React").createElement(b("RTCCallControlsVideoEscalationButton.react"),{disabled:!c,onClick:function(){return b("RTCMWProtocolHandler").videoEscalation()}}),b("React").createElement(b("RTCCallControlsToggleAudioButton.react"),{audioMuted:a.isAudioMuted(),conferenceState:this.props.conferenceState,isP2P:!1}),b("FBRTCScreenSharingUtils").isGroupCallScreenSharingSupported()?b("React").createElement(b("RTCCallControlsToggleScreenSharingWithFunnelButton.react"),{conferenceState:this.props.conferenceState,disabled:!a.hasScreenStream()&&(d||a.isVideoMuted()),isP2P:!1,onExtensionInstallStart:function(){return b("UserAgent").isBrowser("Chrome")?b("CollabRTCChromeScreenSharingExtension").install(b("MediaRequestSourceApp").RTC_CALL):b("Promise").reject("unexpected browser")},onShareStarted:b("RTCMWProtocolHandler").startScreenStream,onShareStop:b("RTCMWProtocolHandler").stopScreenStream,onShareStreamUpdate:b("RTCMWProtocolHandler").updateScreenStream,stream:f}):null,e?null:g,b("React").createElement(b("RTCCallControlsEndCallButton.react"),{conferenceState:this.props.conferenceState,isP2P:!1,onClick:this.$9})),e?g:null,d||!e?null:b("React").createElement(b("RTCGroupCallRemoteView.react"),{remoteUsers:this.props.remoteUsers.filter(function(a){a=a.participantState;return a&&a.state===b("FBRTCParticipantCallState").CONNECTED})}),b("React").createElement(b("RTCSelfView.react"),{className:"_3kqh"+(!d&&e?" video":""),hideCameraViewWhenScreenSharing:!0,onResize:this.$10,onScreenSharingStop:b("RTCMWProtocolHandler").stopScreenStream,user:a}));case b("RTCConferenceState").TERMINATING:return b("React").createElement(b("RTCAppViewFooter.react"),{onResize:this.$7},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_5rdt",onResize:this.$8,ref:function(a){return this.$4=a?a.getDOMNode():a}.bind(this)},b("React").createElement(b("RTCCallControlsToggleVideoButton.react"),{conferenceState:this.props.conferenceState,disabled:!0,isP2P:!1,videoMuted:!0}),b("React").createElement(b("RTCCallControlsToggleAudioButton.react"),{audioMuted:!0,conferenceState:this.props.conferenceState,disabled:!0,isP2P:!1}),b("React").createElement(b("RTCCallControlsEndCallButton.react"),{conferenceState:this.props.conferenceState,disabled:!0,isP2P:!1})));case b("RTCConferenceState").TERMINATED:return b("React").createElement(b("RTCAppViewFooter.react"),{onResize:this.$7},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_5rdt",onResize:this.$8,ref:function(a){return this.$4=a?a.getDOMNode():a}.bind(this)},b("React").createElement(b("RTCCallControlsCloseWindowButton.react"),null)));default:return b("React").createElement(b("RTCAppViewFooter.react"),null)}};a.prototype.$11=function(){__p&&__p();var a=this;if(this.$1===0||this.$3===0)return;var b=Math.min(0,this.$1/2-(this.$3/2+this.$2));if(b===this.$5)return;this.$5=b;this.$4&&(function(){var b=a.$4.style;b.transition="none";a.$6=requestAnimationFrame(function(){b.transform="translateX("+this.$5+"px)",b.transition=""}.bind(a))})()};a.prototype.componentWillUnmount=function(){cancelAnimationFrame(this.$6)};e.exports=a}),null);
__d("RTCAppViewHeader.react",["cx","React","RTCLogo.react","WorkModeConfig","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.children,d=a.className;a.isAudioCall;a=babelHelpers.objectWithoutProperties(a,["children","className","isAudioCall"]);var e=b("WorkModeConfig").is_work_user;e=e?b("React").createElement(b("RTCLogo.react"),{className:"_4key",mode:"mono"}):null;return b("React").createElement("header",babelHelpers["extends"]({className:b("joinClasses")("_4keu",d)},a),e,c)};e.exports=a}),null);
__d("RTCUIDominantSpeakerLayoutIcon.react",["React","RTCSVGIcon.react","RTCSVGIconDropShadowFilter.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1="",this.$2=function(a){a&&(this.$1=a.getURL(),this.forceUpdate())}.bind(this),b}a.prototype.render=function(){var a=this.props,c=a.shadow;a=babelHelpers.objectWithoutProperties(a,["shadow"]);return c?b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement("defs",null,b("React").createElement(b("RTCSVGIconDropShadowFilter.react"),{height:20,ref:this.$2,width:20})),b("React").createElement("g",{filter:this.$1},b("React").createElement(h,null)))):b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement(h,null)))};a.defaultProps={shadow:!1};var h=function(){return b("React").createElement("path",{d:"M16.5 14.5h17a2 2 0 0 1 2 2v17a2 2 0 0 1-2 2h-17a2 2 0 0 1-2-2v-17a2 2 0 0 1 2-2zm0 2h17v11h-17zm0 13h4v4h-4zm6.5 0h4v4h-4zm6.5 0h4v4h-4z",fillRule:"evenodd"})};e.exports=a}),null);
__d("RTCCallControlsDominantSpeakerSwitchButton.react",["cx","fbt","FBRTCConstants","React","RTCCallControlsButton.react","RTCGroupCallActions","RTCUIDominantSpeakerLayoutIcon.react","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FBRTCConstants").GroupVideoViewLayout;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButton.react"),{className:"transparent icon-50","data-testid":b("VideoCallWebDriverIDs").DOMINANT_SPEAKER_SWITCH_BUTTON,onClick:this.$1,title:h._("Switch to dominant speaker view")},b("React").createElement(b("RTCUIDominantSpeakerLayoutIcon.react"),{shadow:!0}))};a.prototype.$1=function(){b("RTCGroupCallActions").setLayout(j.DOMINANT_SPEAKER)};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("RTCUIGridLayoutIcon.react",["React","RTCSVGIcon.react","RTCSVGIconDropShadowFilter.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1="",this.$2=function(a){a&&(this.$1=a.getURL(),this.forceUpdate())}.bind(this),b}a.prototype.render=function(){var a=this.props,c=a.shadow;a=babelHelpers.objectWithoutProperties(a,["shadow"]);return c?b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement("defs",null,b("React").createElement(b("RTCSVGIconDropShadowFilter.react"),{height:20,ref:this.$2,width:20})),b("React").createElement("g",{filter:this.$1},b("React").createElement(h,null)))):b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement(h,null)))};a.defaultProps={shadow:!1};var h=function(){return b("React").createElement("path",{d:"M16.5 14.5h17a2 2 0 0 1 2 2v17a2 2 0 0 1-2 2h-17a2 2 0 0 1-2-2v-17a2 2 0 0 1 2-2zm0 2H24V24h-7.5zm9.5 0h7.5V24H26zM16.5 26H24v7.5h-7.5zm9.5 0h7.5v7.5H26z",fillRule:"evenodd"})};e.exports=a}),null);
__d("RTCCallControlsGridSwitchButton.react",["cx","fbt","FBRTCConstants","React","RTCCallControlsButton.react","RTCGroupCallActions","RTCUIGridLayoutIcon.react","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FBRTCConstants").GroupVideoViewLayout;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButton.react"),{className:"transparent icon-50","data-testid":b("VideoCallWebDriverIDs").GRID_SWITCH_BUTTON,onClick:this.$1,title:h._("Switch to grid view")},b("React").createElement(b("RTCUIGridLayoutIcon.react"),{shadow:!0}))};a.prototype.$1=function(){b("RTCGroupCallActions").setLayout(j.GRID)};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("RTCCallControlsToggleFullScreenButton.react",["cx","fbt","FBRTCVersionDetection","React","RTCCallControlsButton.react","RTCUIFullscreenIcon.react","RTCUtils","VideoCallWebDriverIDs","debounce","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=["fullscreenchange","mozfullscreenchange","webkitfullscreenchange","msfullscreenchange"];c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={highlighted:!1},this.$2=function(a){this.setState({highlighted:!0}),this.$1=setTimeout(function(){return this.setState({highlighted:!1})}.bind(this),100),b("RTCUtils").toggleFullScreen()}.bind(this),this.$4=b("debounce")(function(){return this.forceUpdate()}.bind(this),10),c}a.prototype.render=function(){var a=b("RTCUtils").isFullScreen()||this.state.highlighted;return b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")("transparent icon-50",this.props.className),"data-testid":b("VideoCallWebDriverIDs").FULL_SCREEN_BUTTON,onClick:this.$2,shouldThrottle:this.$3(),title:a?h._("Exit full screen"):h._("Enter full screen")},b("React").createElement(b("RTCUIFullscreenIcon.react"),{direction:a?"in":"out",shadow:!0}))};a.prototype.$3=function(){return!b("FBRTCVersionDetection").isFirefox()};a.prototype.componentDidMount=function(){__p&&__p();for(var a=j,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}var event=d;document.addEventListener(event,this.$4)}};a.prototype.componentWillUnmount=function(){__p&&__p();clearTimeout(this.$1);for(var a=j,b=Array.isArray(a),c=0,a=b?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var d;if(b){if(c>=a.length)break;d=a[c++]}else{c=a.next();if(c.done)break;d=c.value}var event=d;document.removeEventListener(event,this.$4)}};e.exports=a}),null);
__d("RTCMWAppViewHeader.react",["FBRTCConstants","React","RTCAppViewHeader.react","RTCCallControls.react","RTCCallControlsDominantSpeakerSwitchButton.react","RTCCallControlsGridSwitchButton.react","RTCCallControlsToggleFullScreenButton.react","RTCConferenceState"],(function(a,b,c,d,e,f){"use strict";var g=b("FBRTCConstants").GroupVideoViewLayout;a=function(a){var c=a.conferenceState,d=a.hideLayoutSwitchButton,e=a.isAudioCall;a=a.layout;switch(c){case b("RTCConferenceState").CONNECTED:return b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:e},b("React").createElement(b("RTCCallControls.react"),{autoHide:!e,compact:!0},!e&&!d&&a!==g.DOMINANT_SPEAKER?b("React").createElement(b("RTCCallControlsDominantSpeakerSwitchButton.react"),null):null,!e&&!d&&a!==g.GRID?b("React").createElement(b("RTCCallControlsGridSwitchButton.react"),null):null,b("React").createElement(b("RTCCallControlsToggleFullScreenButton.react"),null)));default:return b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:e},b("React").createElement(b("RTCCallControls.react"),{autoHide:!e,compact:!0},b("React").createElement(b("RTCCallControlsToggleFullScreenButton.react"),null)))}};e.exports=a}),null);
__d("RTCUserMediaRequest",["immutable","UserMediaRequestError"],(function(a,b,c,d,e,f){"use strict";var g;c=b("immutable").Record({error:null,state:null});g=babelHelpers.inherits(a,c);g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("RTCGroupCallView.react",["cx","Promise","FBRTCConsoleLogger","FBRTCConstants","FBRTCParticipantCallState","React","RTCAppView.react","RTCConferenceState","RTCGrantUserMediaAccessView.react","RTCMWAppViewContent.react","RTCMWAppViewFooter.react","RTCMWAppViewHeader.react","RTCUserMediaRequest","RTCUserMediaRequestState"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("FBRTCConstants").GroupVideoViewLayout;c=b("React").PureComponent;var j=2,k=8;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={hasVideoInput:!1,wasConnected:!1},this.$2=function(){this.setState({wasConnected:!1})}.bind(this),b}a.prototype.render=function(){var a=this.props.userMediaRequest;switch(a.state){case b("RTCUserMediaRequestState").PENDING:case b("RTCUserMediaRequestState").REJECTED:return b("React").createElement(b("RTCGrantUserMediaAccessView.react"),{isAudioCall:this.props.isAudioCall,userMediaRequest:a});default:return this.$1()}};a.prototype.$1=function(){__p&&__p();var a=this.props,c=a.layout,d=a.remoteUsers;a=babelHelpers.objectWithoutProperties(a,["layout","remoteUsers"]);d=d.toList().sort(function(a,b){return a.lastConnectedAt===b.lastConnectedAt?a.FBID>b.FBID?1:a.FBID<b.FBID?-1:0:a.lastConnectedAt-b.lastConnectedAt});var e=d.count(function(a){a=a.participantState;return a&&a.state===b("FBRTCParticipantCallState").CONNECTED});this.props.conferenceState===b("RTCConferenceState").CONNECTED&&this.setState({wasConnected:!0});var f=e>k||e<j;c=e<j?i.GRID:f?i.DOMINANT_SPEAKER:c;return b("React").createElement("div",{className:"_38jq _li"+(this.props.conferenceState===b("RTCConferenceState").TERMINATED?" _17cj":"")},b("React").createElement(b("RTCAppView.react"),{isAudioCall:this.props.isAudioCall},b("React").createElement(b("RTCMWAppViewHeader.react"),babelHelpers["extends"]({hideLayoutSwitchButton:f,layout:c},a)),b("React").createElement(b("RTCMWAppViewContent.react"),babelHelpers["extends"]({layout:c,remoteUsers:d,wasConnected:this.state.wasConnected},a)),b("React").createElement(b("RTCMWAppViewFooter.react"),babelHelpers["extends"]({hasVideoInput:this.state.hasVideoInput,layout:c,onRedial:this.$2,remoteUsers:d},a))))};a.prototype.componentDidMount=function(){new(b("Promise"))(function(a){navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices?a(navigator.mediaDevices.enumerateDevices().then(function(a){return a.some(function(a){a=a.kind;return a==="videoinput"})})):a(!0)}).then(function(a){return this.setState({hasVideoInput:a})}.bind(this))["catch"](function(a){})};e.exports=a}),null);
__d("RTCMediaDevicesActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ENUMERATE_MEDIA_DEVICES:"ENUMERATE_MEDIA_DEVICES"})}),null);
__d("RTCMediaDevicesActions",["RTCAppDispatcher","RTCMediaDevicesActionTypes"],(function(a,b,c,d,e,f){"use strict";a={enumerate:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCMediaDevicesActionTypes").ENUMERATE_MEDIA_DEVICES,devices:a})}};e.exports=a}),null);
__d("RTCMediaDevicesStore",["FBRTCConsoleLogger","FluxReduceStore","RTCAppDispatcher","RTCMediaDevices","RTCMediaDevicesActions","RTCMediaDevicesActionTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("FluxReduceStore"));g=c&&c.prototype;function a(){g.constructor.call(this,b("RTCAppDispatcher")),this.$RTCMediaDevicesStore1(),b("RTCMediaDevices").addEventListener("devicechange",this.$RTCMediaDevicesStore1)}a.prototype.$RTCMediaDevicesStore1=function(){b("RTCMediaDevices").enumerateDevices().then(function(a){return b("RTCMediaDevicesActions").enumerate(a)})["catch"](function(a){})};a.prototype.getInitialState=function(){return null};a.prototype.reduce=function(a,c){var d=c.type;c=c.devices;switch(d){case b("RTCMediaDevicesActionTypes").ENUMERATE_MEDIA_DEVICES:return[].concat(c);default:return a}};a.prototype.refresh=function(){this.$RTCMediaDevicesStore1()};a.prototype.getByLabel=function(a,b){var c=this.getState();return!c?null:c.find(function(c){return c.kind===b&&c.label===a})||c.find(function(c){return c.kind===b&&i(c.label,a)})};a.__moduleID=e.id;var h=/#\d+\s(\([\da-f]{4}:[\da-f]{4}\))$|\s#\d+$/;function i(a,b){return a.replace(h,"$1")===b.replace(h,"$1")}e.exports=new a()}),null);
__d("RTCP2PCallNUXReducer",["FBRTCUtils","RTCP2PCallActionTypes","RTCP2PCallNUXIDs","XBasicFBNuxDismissController","XBasicFBNuxViewController"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c){__p&&__p();switch(c.type){case b("RTCP2PCallActionTypes").P2P_DISMISS_NUX:var d=b("XBasicFBNuxDismissController").getURIBuilder().setInt("nux_id",c.nuxID).getURI();b("FBRTCUtils").sendServerRequest(d);switch(c.nuxID){case b("RTCP2PCallNUXIDs").RTC_P2P_ADD_GROUP_MEMBER_NUX:return a.set("showAddGroupMemberNUX",!1);case b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_CAMERA_CONTROLS_NUX:return a.set("showRemoteCameraControlsNUX",!1);case b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_SCREEN_CONTENT_POP_OUT_NUX:return a.set("showRemoteScreenContentPopOutNUX",!1);case b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_STREAMS_SLIDER_NUX:return a.set("showRemoteStreamsSliderNUX",!1);case b("RTCP2PCallNUXIDs").RTC_P2P_SETTINGS_NUX:return a.set("showSettingsNUX",!1);default:return a}default:return a}}function c(a,c){switch(c.type){case b("RTCP2PCallActionTypes").P2P_INIT_NUX_STATE:c=c.payload;return a.set("showAddGroupMemberNUX",c.showAddGroupMemberNUX).set("showRemoteCameraControlsNUX",c.showRemoteCameraControlsNUX).set("showRemoteScreenContentPopOutNUX",c.showRemoteScreenContentPopOutNUX).set("showRemoteStreamsSliderNUX",c.showRemoteStreamsSliderNUX).set("showSettingsNUX",c.showSettingsNUX);default:return a}}function d(a,c){switch(c.type){case b("RTCP2PCallActionTypes").P2P_MARK_NUX_VIEWED:c=b("XBasicFBNuxViewController").getURIBuilder().setInt("nux_id",c.nuxID).getURI();b("FBRTCUtils").sendServerRequest(c);return a;default:return a}}e.exports={dismissNUX:a,markNUXViewed:d,refreshNUXState:c}}),null);
__d("RTCP2PCallNUXStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;c={showAddGroupMemberNUX:!1,showRemoteCameraControlsNUX:!1,showRemoteScreenContentPopOutNUX:!1,showRemoteStreamsSliderNUX:!1,showSettingsNUX:!1};g=babelHelpers.inherits(a,b("immutable").Record(c));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("RTCP2PCallNUXStore",["FluxReduceStore","RTCAppDispatcher","RTCP2PCallNUXActions","RTCP2PCallNUXReducer","RTCP2PCallNUXStoreState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("RTCP2PCallNUXReducer").dismissNUX,b("RTCP2PCallNUXReducer").markNUXViewed,b("RTCP2PCallNUXReducer").refreshNUXState];c=babelHelpers.inherits(a,b("FluxReduceStore"));g=c&&c.prototype;function a(){g.constructor.call(this,b("RTCAppDispatcher")),b("RTCP2PCallNUXActions").refreshNUXState()}a.prototype.getInitialState=function(){return new(b("RTCP2PCallNUXStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.__moduleID=e.id;e.exports=new a()}),null);
__d("CollabInitStreamTriggerType",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ESCALATION_APPROVED:"escalation_approved",ESCALATION_INITIATED:"escalation_initiated",REDIAL:"redial",USER_MEDIA_REQUEST:"user_media_request",USER_SETTINGS_CHANGED:"user_settings_changed"})}),null);
__d("RTCCallInitUtils",["invariant","CurrentUser","immutable","MercuryIDs","MessengerParticipants.bs","RTCCallActions","RTCUser","URI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a={initializeRTCUsers:function(a,c){a=a.map(function(a){return b("MercuryIDs").getParticipantIDFromUserID(a)});b("MessengerParticipants.bs").getMulti(a,function(a){a=b("immutable").Map(a);this.initializeParticipantsAndStartCall(a,!0,c)}.bind(this))},initializeParticipantsAndStartCall:function(a,c,d){var e=a.keySeq().toArray();b("MessengerParticipants.bs").getBigImageMulti(e,function(e){c&&b("RTCCallActions").initRemoteUsers(a.filter(function(a){a=a.fbid;return a!==b("CurrentUser").getID()}).map(function(a){return this._createRTCUser(a,e)}.bind(this)).toSet());var f=b("MercuryIDs").getParticipantIDFromUserID(b("CurrentUser").getID());b("RTCCallActions").initLocalUser(this._createRTCUser(a.get(f),e));d()}.bind(this),100)},_createRTCUser:function(a,c){var d=a.big_image_src,e=a.fbid,f=a.href,h=a.image_src,i=a.is_messenger_user,j=a.name,k=a.room_location,l=a.short_name;a=a.vanity;e||g(0);if(c){var m=b("MercuryIDs").getParticipantIDFromUserID(e);d=c[m]}return new(b("RTCUser"))({FBID:e,isMessengerUser:!!i,profileUrl:new(b("URI"))(f),profilePictureUrl:d||h,roomLocation:k,userName:j,userShortName:l,vanity:a?a:""})}};e.exports=a}),null);
__d("RTCP2PIncallView.react",["cx","fbt","FBRTCConstants","FluxContainer","immutable","React","RTCAppDispatcher","RTCCallStore","RTCIncallAudio.react","RTCIncallVideo.react","RTCP2PCallNUXActions","RTCP2PCallNUXIDs","RTCP2PCallNUXStore","ShimButton.react","VideoCallWebDriverIDs","XUIAmbientNUX.react"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FBRTCConstants").SignalingProtocol;a=b("React").PureComponent;function k(a){var c=a.audioSinkID;a=a.streams;return a.toArray().map(function(a,d){return b("React").createElement(b("RTCIncallAudio.react"),babelHelpers["extends"]({key:d},{audioSinkID:c,mediaStream:a}))})}c=babelHelpers.inherits(l,a);i=c&&c.prototype;l.getStores=function(){return[b("RTCP2PCallNUXStore")]};l.calculateState=function(){var a=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];return babelHelpers["extends"]({},a,{showNux:b("RTCP2PCallNUXStore").getState().showRemoteStreamsSliderNUX})};function l(a){__p&&__p();i.constructor.call(this,a),this.state=l.calculateState({ratio:.5,resizing:!1}),this.$11=function(){document.addEventListener("keydown",this.$14)}.bind(this),this.$9=function(){document.removeEventListener("keydown",this.$14)}.bind(this),this.$14=function(a){a=a.key;var b=this.state.ratio;switch(a){case"ArrowLeft":this.$15(b-.025);break;case"ArrowRight":this.$15(b+.025);break;case"Escape":this.$10();break}}.bind(this),this.$10=function(){this.setState({ratio:.5})}.bind(this),this.$12=function(a){__p&&__p();var b=a.clientX;if(!this.$1)return;this.$3=this.$1.offsetLeft;this.$4=this.$1.offsetWidth;this.setState({resizing:!0},function(){return this.$16({clientX:b})}.bind(this));document.addEventListener("mousemove",this.$16);document.addEventListener("mouseup",this.$17);this.state.showNux&&this.$18()}.bind(this),this.$16=function(a){a=a.clientX;if(!this.state.resizing)return;this.$15((a-this.$3)/this.$4)}.bind(this),this.$17=function(){this.$19(),this.setState({resizing:!1})}.bind(this),this.$13=function(a){this.$2=a&&a.getDOMNode?a.getDOMNode():a}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCP2PCallNUXStore")])}l.prototype.render=function(){__p&&__p();var a=this.props.user;if(!a)return null;var c=a.streams,d=a.screenStreams;if(this.props.isAudioCall)return b("React").createElement("section",{className:"_1b9s"+(this.state.resizing?" resizing":""),ref:function(a){return this.$1=a}.bind(this)},this.props.children,b("React").createElement("div",{className:"_1b9t"},b("React").createElement(k,{audioSinkID:this.props.audioSinkID,streams:c}),b("React").createElement(k,{audioSinkID:this.props.audioSinkID,streams:d})));var e=!(c.isEmpty()||d.isEmpty()||!this.props.renderScreenStreams);return b("React").createElement("section",{className:"_1b9s"+(this.state.resizing?" resizing":""),ref:function(a){return this.$1=a}.bind(this)},this.props.children,this.$5(d,e),this.$6(e),this.$7(e),this.$8(c,e,a.isVideoMuted()))};l.prototype.$6=function(a){return!a?null:b("React").createElement(b("ShimButton.react"),{className:"_1b9u",onBlur:this.$9,onDoubleClick:this.$10,onFocus:this.$11,onMouseDown:this.$12,ref:this.$13,role:"button",tabIndex:0})};l.prototype.$15=function(a){this.setState({ratio:Math.min(.85,Math.max(.15,a))})};l.prototype.$19=function(){document.removeEventListener("mousemove",this.$16),document.removeEventListener("mouseup",this.$17)};l.prototype.$18=function(){b("RTCP2PCallNUXActions").dismissNUX(b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_STREAMS_SLIDER_NUX)};l.prototype.$7=function(a){if(!this.state.showNux||!a||!this.$1)return null;a=(this.$1.clientHeight-32)/2;var c=h._("Control the size of the video and shared content by dragging the slider");b("RTCP2PCallNUXActions").markNUXViewed(b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_STREAMS_SLIDER_NUX);return b("React").createElement(b("XUIAmbientNUX.react"),{alignment:"left",contextRef:function(){return this.$2}.bind(this),customwidth:250,offsetY:a,onCloseButtonClick:this.$18,position:"right",shown:this.state.showNux,width:"custom"},c)};l.prototype.$5=function(a,c){if(a.isEmpty()||!this.props.renderScreenStreams)return null;var d=this.props.audioSinkID;c=c?{flexGrow:this.state.ratio}:null;return b("React").createElement("div",{className:"_1b9t",style:c},a.toArray().map(function(a,c){return b("React").createElement(b("RTCIncallVideo.react"),babelHelpers["extends"]({key:c},{audioSinkID:d,mediaStream:a}))}))};l.prototype.$8=function(a,c,d){__p&&__p();if(a.isEmpty())return null;var e=this.props.audioSinkID;c=c?{flexGrow:1-this.state.ratio}:null;var f=b("RTCCallStore").getConnection(j.P2P);if(!f)return null;var g=b("immutable").Set(f.getRemoteStreams());return b("React").createElement("div",{className:"_1b9t","data-testid":b("VideoCallWebDriverIDs").INCALL_VIDEO_CONTAINER,style:c},a.filter(function(a){return g.has(a)}).toArray().map(function(a,c){return a.getVideoTracks().length>0?b("React").createElement(b("RTCIncallVideo.react"),babelHelpers["extends"]({key:c},{audioSinkID:e,mediaStream:a,muted:d})):b("React").createElement(b("RTCIncallAudio.react"),babelHelpers["extends"]({key:c},{audioSinkID:e,mediaStream:a}))}))};l.prototype.componentWillUnmount=function(){this.$19(),document.removeEventListener("keydown",this.$14)};l.prototype.componentDidUpdate=function(a){this.props.user!==a.user&&this.$10()};l.defaultProps={renderScreenStreams:!0};e.exports=b("FluxContainer").create(l)}),null);
__d("RTCUserSettingsActionTypes",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({USER_SETTINGS_CANCEL_EDITING:"USER_SETTINGS_CANCEL_EDITING",USER_SETTINGS_EDIT:"USER_SETTINGS_EDIT",USER_SETTINGS_SAVE:"USER_SETTINGS_SAVE",USER_SETTINGS_SET_AUDIO_INPUT:"USER_SETTINGS_SET_AUDIO_INPUT",USER_SETTINGS_SET_AUDIO_OUTPUT:"USER_SETTINGS_SET_AUDIO_OUTPUT",USER_SETTINGS_SET_VIDEO_INPUT:"USER_SETTINGS_SET_VIDEO_INPUT"})}),null);
__d("RTCUserSettingsReducers",["RTCCallActionTypes","RTCMediaDevicesStore","RTCUserSettingsActionTypes"],(function(a,b,c,d,e,f){__p&&__p();function a(a,c){switch(c.type){case b("RTCUserSettingsActionTypes").USER_SETTINGS_EDIT:return a.set("editing",!0);case b("RTCUserSettingsActionTypes").USER_SETTINGS_CANCEL_EDITING:return a.set("editing",!1);case b("RTCUserSettingsActionTypes").USER_SETTINGS_SAVE:return a.set("audioInput",c.audioInput).set("audioOutput",c.audioOutput).set("editing",!1).set("videoInput",c.videoInput);case b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_AUDIO_INPUT:return a.set("audioInput",c.audioInput);case b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_AUDIO_OUTPUT:return a.set("audioOutput",c.audioOutput);case b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_VIDEO_INPUT:return a.set("videoInput",c.videoInput);default:return a}}function c(a,c){switch(c.type){case b("RTCCallActionTypes").ADD_LOCAL_STREAM:return a.set("audioInput",g(c.stream.getAudioTracks()[0],"audioinput")||a.audioInput).set("videoInput",g(c.stream.getVideoTracks()[0],"videoinput")||a.videoInput);default:return a}}function g(a,c){if(!a)return null;a=b("RTCMediaDevicesStore").getByLabel(a.label,c);return a?a.deviceId:null}e.exports={activelySetSettings:a,passivelySetSettings:c}}),null);
__d("RTCUserSettingsStoreState",["immutable"],(function(a,b,c,d,e,f){"use strict";var g;g=babelHelpers.inherits(a,b("immutable").Record({audioInput:null,audioOutput:null,editing:!1,videoInput:null}));g&&g.prototype;function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("RTCUserSettingsStore",["FluxReduceStore","RTCAppDispatcher","RTCUserSettingsReducers","RTCUserSettingsStoreState"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=[b("RTCUserSettingsReducers").activelySetSettings,b("RTCUserSettingsReducers").passivelySetSettings];c=babelHelpers.inherits(a,b("FluxReduceStore"));g=c&&c.prototype;function a(){g.constructor.call(this,b("RTCAppDispatcher"))}a.prototype.getInitialState=function(){return new(b("RTCUserSettingsStoreState"))()};a.prototype.reduce=function(a,b){return h.reduce(function(a,c){return c(a,b)},a)};a.__moduleID=e.id;e.exports=new a()}),null);
__d("RTCP2PRedialButton.react",["cx","fbt","Bootloader","CollabCallMessengerBrowserEventEnum","CollabInitStreamTriggerType","FBRTCConfig","FBRTCConsoleLogger","FBRTCLogger","FBRTCUtils","FluxContainer","MessengerRTCFunnelLogger","React","RTCCallActions","RTCCallStore","RTCP2PCallStore","RTCP2PProtocolHandler","RTCTextButton.react","RTCUser","RTCUserSettingsStore","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){return b("React").createElement(b("RTCTextButton.react"),{className:"green _1gv1","data-testid":b("VideoCallWebDriverIDs").REDIAL_BUTTON,label:h._("Redial"),onClick:a.onClick})};c=function(){__p&&__p();return{onClick:function(){__p&&__p();b("RTCCallActions").reset(b("FBRTCUtils").generateRandomInt().toString());var a=b("RTCUserSettingsStore").getState(),c=a.audioInput;a=a.videoInput;var d=b("RTCP2PCallStore").isAudioOnly();b("MessengerRTCFunnelLogger").startFunnel("RedialButton");b("MessengerRTCFunnelLogger").appendAction("user_media_requested");b("RTCP2PProtocolHandler").initStream(!d,c,a).then(function(a){b("MessengerRTCFunnelLogger").appendAction("user_media_succeeded"),b("RTCCallActions").addLocalStream(a),b("RTCP2PCallStore").getState().protocolHandler.startCall(b("FBRTCLogger").Trigger.REDIAL_BUTTON)})["catch"](function(a){b("MessengerRTCFunnelLogger").appendAction("user_media_rejected");var c=b("RTCCallStore").getState(),d=c.callInfo.conferenceName;c=c.remoteUsers;i(b("CollabCallMessengerBrowserEventEnum").GET_USER_MEDIA_ERROR,JSON.stringify({error:a.name,constraint:a.constraint,trigger:b("CollabInitStreamTriggerType").REDIAL}),d,c.first())})}}};function i(event,a,c,d){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["CollabMessengerLogger"],function(b){return b.log(event,{peerID:d.FBID,callID:Number(c),eventDetails:a})},"RTCP2PRedialButton.react")}e.exports=b("FluxContainer").createFunctional(a,function(){return[b("RTCCallStore"),b("RTCP2PCallStore"),b("RTCUserSettingsStore")]},c)}),null);
__d("RTCP2PStartCallButton.react",["cx","fbt","FBRTCLogger","React","RTCP2PCallStore","RTCTextButton.react","RTWebLoggingCallType","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.$1=function(){b("RTWebUserActionLogger").logClick({callType:b("RTWebLoggingCallType").P2P,component:b("RTWebLoggingComponent").START_CALL,conferenceState:this.props.conferenceState,mediaType:b("RTWebUserActionLogger").getMediaType(this.props.isAudio),page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").P2P_CALL_CONTAINER}),b("RTCP2PCallStore").getState().protocolHandler.startCall(b("FBRTCLogger").Trigger.POPUP_CALL_START_BUTTON)}.bind(this),c}a.prototype.componentDidMount=function(){b("RTWebUserActionLogger").logImpression({callType:b("RTWebLoggingCallType").P2P,component:b("RTWebLoggingComponent").START_CALL,conferenceState:this.props.conferenceState,mediaType:b("RTWebUserActionLogger").getMediaType(this.props.isAudio),page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").P2P_CALL_CONTAINER})};a.prototype.render=function(){return b("React").createElement(b("RTCTextButton.react"),{className:"green _2fst","data-testid":b("VideoCallWebDriverIDs").RTC_APP_VIEW_START_CALL_BUTTON,label:h._("Start Call"),onClick:this.$1})};e.exports=a}),null);
__d("RTCPeerInfo.react",["cx","fbt","Image.react","React","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){a.children;var c=a.className,d=a.peer,e=a.showName;e=e===undefined?!0:e;a=babelHelpers.objectWithoutProperties(a,["children","className","peer","showName"]);return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")(c,"_dzr")},a),b("React").createElement(b("Image.react"),{alt:h._("Profile Picture"),className:"_dzs",src:d.profilePictureUrl}),e?b("React").createElement("p",{className:"_dzt"},d.userName):null)};e.exports=a}),null);
__d("RTCP2PActiveMediaDeviceContainer.react",["CollabCallMessengerBrowserEventEnum","CollabInitStreamTriggerType","FluxContainer","React","RTCAppDispatcher","RTCP2PCallStore","RTCP2PProtocolHandler","RTCUserSettingsStore","RTWebLoggingSurface","RTWebUserActionLogger","UserMediaRequestError"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(a){g.constructor.call(this,a),this.$1=function(a){var c=a.audioInput?a.audioInput:this.state.audioInput;a=a.videoInput?a.videoInput:this.state.videoInput;b("RTCP2PProtocolHandler").initStream(!this.state.isAudioCall,c,a).then(function(a){return b("RTCP2PProtocolHandler").replaceLocalStream(a,!0)})["catch"](function(a){return h(a,b("CollabInitStreamTriggerType").USER_SETTINGS_CHANGED)})}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCP2PCallStore"),b("RTCUserSettingsStore")])}a.getStores=function(){return[b("RTCP2PCallStore"),b("RTCUserSettingsStore")]};a.calculateState=function(){var a=b("RTCUserSettingsStore").getState();return{audioInput:a.audioInput,isAudioCall:b("RTCP2PCallStore").isAudioOnly(),videoInput:a.videoInput}};a.prototype.render=function(){return this.props.children(this.$1)};function h(a,c){b("RTWebUserActionLogger").logError({errorDomain:b("CollabCallMessengerBrowserEventEnum").GET_USER_MEDIA_ERROR,errorType:JSON.stringify(a),page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").P2P_CALL_CONTAINER})}e.exports=b("FluxContainer").create(a)}),null);
__d("RTCPreCallAudioOutputPreview.react",["cx","invariant","FBRTCUtils","MercurySoundsConfig","React","ReactDOM","RTCSVGIcon.react","RTCUserMediaConstraints","RTCUtils","promiseDone"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={mediaStream:null},this.$5=function(){this.$1!=null&&this.$1.play()}.bind(this),this.$6=function(){this.$1!=null&&this.$1.pause()}.bind(this),b}a.prototype.componentDidMount=function(){b("promiseDone")(this.$2(this.props.audioOutputSinkID).then(function(a){return this.setState({mediaStream:a})}.bind(this))),this.$3(this.state.mediaStream),this.$4()};a.prototype.componentDidUpdate=function(a,c){a.audioOutputSinkID!==this.props.audioOutputSinkID&&(b("promiseDone")(this.$2(this.props.audioOutputSinkID).then(function(a){c.mediaStream!=null&&b("RTCUtils").stopMediaStream(c.mediaStream),this.setState({mediaStream:a})}.bind(this))),this.$4())};a.prototype.render=function(){return b("React").createElement("div",{className:"_426m",onMouseEnter:this.$5,onMouseLeave:this.$6},b("React").createElement("audio",{autoPlay:!1,loop:!0,ref:function(a){return this.$1=a}.bind(this)},b("React").createElement("source",{src:b("MercurySoundsConfig").settings_preview_sound_mp3_url,type:"audio/mpeg"}),b("React").createElement("source",{src:b("MercurySoundsConfig").settings_preview_sound_ogg_url,type:"audio/ogg"})),b("React").createElement(j,null))};a.prototype.$2=function(a){return b("RTCUtils").getUserMedia({audio:b("RTCUserMediaConstraints").audio(a)})};a.prototype.$3=function(a){this.$1&&a&&b("FBRTCUtils").attachMediaStream(this.$1,a)};a.prototype.$4=function(){b("FBRTCUtils").supportsSetSink()||h(0);var a=b("ReactDOM").findDOMNode(this.$1);this.props.audioOutputSinkID&&a!=null&&a.setSinkId(this.props.audioOutputSinkID)};var j=function(){return b("React").createElement(b("RTCSVGIcon.react"),{className:"_426l"},b("React").createElement("svg",{viewBox:"0 0 80 61"},b("React").createElement("g",{fill:"#FFF"},b("React").createElement("path",{className:"_426o",d:"M53.5 10.5c-1.65685 0-3-1.34315-3-3s1.34315-3 3-3c14.3594 0 26 11.6406 26 26s-11.6406 26-26 26c-1.65685 0-3-1.34315-3-3s1.34315-3 3-3c11.0457 0 20-8.9543 20-20s-8.9543-20-20-20z"}),b("React").createElement("path",{className:"_426n",d:"M53.5 42.5c-1.65685 0-3-1.34315-3-3s1.34315-3 3-3c3.3137 0 6-2.6863 6-6s-2.6863-6-6-6c-1.65685 0-3-1.34315-3-3s1.34315-3 3-3c6.62742 0 12 5.37258 12 12s-5.37258 12-12 12z"}),b("React").createElement("path",{d:"M.5 30.56204c0 6.90356 5.59644 12.5 12.5 12.5h7.5L40.57042 59.9212c1.26867 1.06567 3.16102.90112 4.2267-.36754A3 3 0 0 0 45.5 57.62408V3.5c0-1.65685-1.34315-3-3-3a3 3 0 0 0-1.92958.70289L20.5 18.06204H13c-6.90356 0-12.5 5.59644-12.5 12.5z"}))))};e.exports=a}),null);
__d("RTCUserSettingsActions",["RTCAppDispatcher","RTCUserSettingsActionTypes"],(function(a,b,c,d,e,f){"use strict";a={edit:function(){b("RTCAppDispatcher").dispatch({type:b("RTCUserSettingsActionTypes").USER_SETTINGS_EDIT})},cancel:function(){b("RTCAppDispatcher").dispatch({type:b("RTCUserSettingsActionTypes").USER_SETTINGS_CANCEL_EDITING})},save:function(a){b("RTCAppDispatcher").dispatch(babelHelpers["extends"]({type:b("RTCUserSettingsActionTypes").USER_SETTINGS_SAVE},a))},setAudioInput:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_AUDIO_INPUT,audioInput:a})},setAudioOutput:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_AUDIO_OUTPUT,audioOutput:a})},setVideoInput:function(a){b("RTCAppDispatcher").dispatch({type:b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_VIDEO_INPUT,videoInput:a})}};e.exports=a}),null);
__d("SUIMessengerRTCDarkTheme",["SUIMessengerRTCThemeConstants","messengerRTCCreateSUITheme"],(function(a,b,c,d,e,f){"use strict";a=b("SUIMessengerRTCThemeConstants").DARK_MAPPING;e.exports=b("messengerRTCCreateSUITheme")(a,"messenger-rtc-dark")}),null);
__d("RTCPreCallAudioOutputContainer.react",["cx","FluxContainer","React","RTCMediaDevicesStore","RTCPreCallAudioOutputPreview.react","RTCSettingsMediaDeviceSelector.react","RTCUserSettingsActions","RTCUserSettingsStore","RTCUtils","SUIMessengerRTCDarkTheme"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){return b("React").createElement("div",{className:"_142c"},b("React").createElement(b("RTCPreCallAudioOutputPreview.react"),{audioOutputSinkID:a.audioOutput}),b("React").createElement(b("RTCSettingsMediaDeviceSelector.react"),{buttonBorderedSides:["top"],buttonRoundedCorners:["bottomLeft","bottomRight"],devices:a.audioOutputDevices,onChange:h,theme:b("SUIMessengerRTCDarkTheme"),value:a.audioOutput,width:172}))};var h=function(a){b("RTCUserSettingsActions").setAudioOutput(a)};c=function(){return{audioOutput:b("RTCUserSettingsStore").getState().audioOutput,audioOutputDevices:b("RTCUtils").filterDevicesByKind(b("RTCMediaDevicesStore").getState(),"audiooutput")}};e.exports=b("FluxContainer").createFunctional(a,function(){return[b("RTCMediaDevicesStore"),b("RTCUserSettingsStore")]},c)}),null);
__d("RTCPreCallVideoPreview.react",["cx","FBRTCVideo.react","React","RTCP2PProtocolHandler","RTCUserMediaConstraints","RTCUtils","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={mediaStream:null},b}a.prototype.componentDidMount=function(){b("promiseDone")(this.$1(this.props.videoInput).then(function(a){return this.setState({mediaStream:a})}.bind(this)))};a.prototype.componentDidUpdate=function(a,c){a.videoInput!==this.props.videoInput&&b("promiseDone")(this.$1(this.props.videoInput).then(function(a){c.mediaStream&&b("RTCUtils").stopMediaStream(c.mediaStream),this.setState({mediaStream:a})}.bind(this)))};a.prototype.render=function(){return b("React").createElement("div",{className:"_68wu"},b("React").createElement(b("FBRTCVideo.react"),{className:"_4fod",mediaStream:this.state.mediaStream,muted:!0}))};a.prototype.$1=function(a){return b("RTCUtils").getUserMedia({video:b("RTCUserMediaConstraints").video(b("RTCP2PProtocolHandler").getDefaultVideoQuality(),a)})};e.exports=a}),null);
__d("RTCPreCallCameraContainer.react",["cx","FluxContainer","React","RTCAppDispatcher","RTCMediaDevicesStore","RTCPreCallVideoPreview.react","RTCSettingsMediaDeviceSelector.react","RTCUserSettingsActions","RTCUserSettingsStore","RTCUtils","SUIMessengerRTCDarkTheme"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$1=function(a){b("RTCUserSettingsActions").setVideoInput(a),this.props.onMediaDevicesChange&&this.props.onMediaDevicesChange({videoInput:a})}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCMediaDevicesStore"),b("RTCUserSettingsStore")])}a.getStores=function(){return[b("RTCMediaDevicesStore"),b("RTCUserSettingsStore")]};a.calculateState=function(){return{videoDevices:b("RTCUtils").filterDevicesByKind(b("RTCMediaDevicesStore").getState(),"videoinput"),videoInput:b("RTCUserSettingsStore").getState().videoInput}};a.prototype.render=function(){return b("React").createElement("div",{className:"_101o"},b("React").createElement(b("RTCPreCallVideoPreview.react"),{videoInput:this.state.videoInput}),b("React").createElement(b("RTCSettingsMediaDeviceSelector.react"),{buttonBorderedSides:["top"],buttonRoundedCorners:["bottomLeft","bottomRight"],devices:this.state.videoDevices,onChange:this.$1,theme:b("SUIMessengerRTCDarkTheme"),value:this.state.videoInput,width:306}))};e.exports=b("FluxContainer").create(a)}),null);
__d("RTCSettingsAudioInputPreview.react",["cx","fbt","AudioContextSingleton","React","cancelAnimationFrame","joinClasses","requestAnimationFrame"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PureComponent;var j={fftSize:32,minDecibels:-90,maxDecibels:-10,smoothingTimeConstant:1},k=Math.log2(128+1);d=babelHelpers.inherits(a,c);i=d&&d.prototype;function a(a){i.constructor.call(this,a),this.state={noAudioTrack:!1},this.$2=b("AudioContextSingleton").get(),this.$3=this.$2.createGain(),this.$3.gain.value=a.gain,this.$4=this.$2.createAnalyser(),Object.assign(this.$4,j)}a.prototype.$7=function(a){__p&&__p();this.$8();if(!(a&&this.$1))return;if(a.getAudioTracks().length<1){this.setState({noAudioTrack:!0});return}var c=this.$1.getContext("2d");if(!c)return;this.$5&&this.$5.disconnect();this.$5=this.$2.createMediaStreamSource(a);this.$5.connect(this.$3);this.$3.connect(this.$4);a=this.$4.frequencyBinCount;var d=new Uint8Array(a);a=this.props;var e=a.width,f=a.height,g=void 0,h=function(){this.$4.getByteTimeDomainData(d);var a=l(d,e,f,g);g=a;c.clearRect(0,0,e,f);c.fillStyle=this.props.fillStyle;c.fill(n(a,e,f));this.$6=b("requestAnimationFrame")(h)}.bind(this);this.$6=b("requestAnimationFrame")(h)};a.prototype.$8=function(){b("cancelAnimationFrame")(this.$6)};a.prototype.render=function(){var a=this.props,c=a.className,d=a.gain,e=a.height,f=a.width;a=babelHelpers.objectWithoutProperties(a,["className","gain","height","width"]);var g=this.state.noAudioTrack;this.$3.gain.value=d;return b("React").createElement("div",babelHelpers["extends"]({className:b("joinClasses")("_brl"+(g?" noAudioTrack":""),c)},a),g?b("React").createElement("span",null,this.props.noMicMessage):null,b("React").createElement("canvas",babelHelpers["extends"]({ref:function(a){return this.$1=a}.bind(this)},{width:f,height:e})))};a.prototype.componentDidUpdate=function(a){var b=this.props.mediaStream;b!==a.mediaStream&&(this.setState({noAudioTrack:!1}),this.$7(b))};a.prototype.componentDidMount=function(){this.$7(this.props.mediaStream)};a.prototype.componentWillUnmount=function(){this.$8(),this.$5&&this.$5.disconnect(),this.$3&&this.$3.disconnect()};a.defaultProps={fillStyle:"rgba(255, 255, 255, .5)",gain:3.5,height:26,noMicMessage:h._("No Mic"),width:106};function l(a,b,c,d){return[128].concat(m(a),[128]).map(function(a,e,f){a=c*(Math.log2(Math.abs(a)+1)/k);return{x:e*b/(f.length-1),y:d?Math.min(a,c-(c-d[e].y)*.95):a}})}function m(a){var b=[];for(var c=0;c*2<a.length;c++)b[c]=Math.min(a[c*2],a[c*2+1]||0);return b}function n(a,b,c){__p&&__p();var d=new Path2D();d.moveTo(0,c);a.forEach(function(b,c,a){switch(c){case 0:d.lineTo(b.x,b.y);break;case 1:break;case a.length-1:d.bezierCurveTo.apply(d,o(b,a[c-1],b));d.lineTo(b.x,b.y);break;case 2:d.lineTo((5*a[c-2].x+a[c-1].x)/6,(5*a[c-2].y+a[c-1].y)/6);default:d.bezierCurveTo.apply(d,o(b,a[c-2],a[c-1]))}});d.lineTo(b,c);d.closePath();return d}function o(a,b,c){return[(2*b.x+c.x)/3,(2*b.y+c.y)/3,(b.x+2*c.x)/3,(b.y+2*c.y)/3,(b.x+4*c.x+a.x)/6,(b.y+4*c.y+a.y)/6]}e.exports=a}),null);
__d("RTCPreCallMicPreview.react",["cx","React","RTCSettingsAudioInputPreview.react","RTCSVGIcon.react","RTCUserMediaConstraints","RTCUtils","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={mediaStream:null},b}a.prototype.componentDidMount=function(){b("promiseDone")(this.$1(this.props.audioInput).then(function(a){return this.setState({mediaStream:a})}.bind(this)))};a.prototype.componentDidUpdate=function(a,c){a.audioInput!==this.props.audioInput&&b("promiseDone")(this.$1(this.props.audioInput).then(function(a){c.mediaStream&&b("RTCUtils").stopMediaStream(c.mediaStream),this.setState({mediaStream:a})}.bind(this)))};a.prototype.render=function(){return b("React").createElement("div",{className:"_2848"},b("React").createElement(i,null),b("React").createElement(b("RTCSettingsAudioInputPreview.react"),{className:"_2-0x",gain:6,mediaStream:this.state.mediaStream}))};a.prototype.$1=function(a){return b("RTCUtils").getUserMedia({audio:b("RTCUserMediaConstraints").audio(a)})};var i=function(){return b("React").createElement(b("RTCSVGIcon.react"),{style:{marginLeft:34,marginTop:16}},b("React").createElement("svg",{fill:"none",height:"144",stroke:"white",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",viewBox:"0 0 24 24",width:"100"},b("React").createElement("path",{d:"M19 10v2a7 7 0 0 1-14 0v-2"}),b("React").createElement("line",{x1:"8",x2:"16",y1:"23",y2:"23"})))};e.exports=a}),null);
__d("RTCPreCallMicrophoneContainer.react",["cx","FluxContainer","React","RTCAppDispatcher","RTCMediaDevicesStore","RTCPreCallMicPreview.react","RTCSettingsMediaDeviceSelector.react","RTCUserSettingsActions","RTCUserSettingsStore","RTCUtils","SUIMessengerRTCDarkTheme"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(a){h.constructor.call(this,a),this.$1=function(a){b("RTCUserSettingsActions").setAudioInput(a),this.props.onMediaDevicesChange&&this.props.onMediaDevicesChange({audioInput:a})}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCMediaDevicesStore"),b("RTCUserSettingsStore")])}a.getStores=function(){return[b("RTCMediaDevicesStore"),b("RTCUserSettingsStore")]};a.calculateState=function(){return{audioInput:b("RTCUserSettingsStore").getState().audioInput,audioDevices:b("RTCUtils").filterDevicesByKind(b("RTCMediaDevicesStore").getState(),"audioinput")}};a.prototype.render=function(){return b("React").createElement("div",{className:"_142c"},b("React").createElement(b("RTCPreCallMicPreview.react"),{audioInput:this.state.audioInput}),b("React").createElement(b("RTCSettingsMediaDeviceSelector.react"),{buttonBorderedSides:["top"],buttonRoundedCorners:["bottomLeft","bottomRight"],devices:this.state.audioDevices,onChange:this.$1,theme:b("SUIMessengerRTCDarkTheme"),value:this.state.audioInput,width:172}))};e.exports=b("FluxContainer").create(a)}),null);
__d("RTCRoomInfo.react",["cx","fbt","Image.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";a=function(a){return b("React").createElement("div",{className:"_1h0c"},b("React").createElement(b("Image.react"),{alt:h._("Room Profile Picture"),className:"_1h11",src:a.peer.profilePictureUrl}),b("React").createElement("div",{className:"_1h12"},b("React").createElement("p",{className:"_1h13"},a.peer.userName),b("React").createElement("p",{className:"_1h14"},a.peer.roomLocation)))};e.exports=a}),null);
__d("RTCPreCallSetup.react",["cx","fbt","FBRTCUtils","React","RTCConferenceState","RTCP2PActiveMediaDeviceContainer.react","RTCP2PCallStore","RTCPreCallAudioOutputContainer.react","RTCPreCallCameraContainer.react","RTCPreCallMicrophoneContainer.react","RTCRoomInfo.react","RTCTextButton.react","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){switch(a.conferenceState){case b("RTCConferenceState").NEW:return b("React").createElement(i,{className:"_4m1g"},b("React").createElement(b("RTCRoomInfo.react"),{peer:a.peer}));case b("RTCConferenceState").AWAITING_USER_START:return b("React").createElement("div",{className:"_4m1g"},b("React").createElement(i,{className:"_3v55"},b("React").createElement(b("RTCRoomInfo.react"),{peer:a.peer}),b("React").createElement(b("RTCTextButton.react"),{className:"green _4m1n","data-testid":b("VideoCallWebDriverIDs").RTC_APP_VIEW_START_CALL_BUTTON,label:h._("Start calling"),onClick:function(){return b("RTCP2PCallStore").getState().protocolHandler.startCall("vc_precall_setup")}})),b("React").createElement(i,{className:"_3v59"},h._("Test your setup before the call...")),b("React").createElement(b("RTCP2PActiveMediaDeviceContainer.react"),null,function(a){return b("React").createElement(i,{className:"_y06"},b("React").createElement(b("RTCPreCallCameraContainer.react"),{onMediaDevicesChange:a}),b("React").createElement(b("RTCPreCallMicrophoneContainer.react"),{onMediaDevicesChange:a}),b("FBRTCUtils").supportsSetSink()?b("React").createElement(b("RTCPreCallAudioOutputContainer.react"),null):null)}));default:return null}};var i=function(a){return b("React").createElement("div",{className:b("joinClasses")(a.className,"_4m1o"),style:a.style},a.children)};e.exports=a}),null);
__d("RTCP2PAppViewContent.react",["cx","fbt","FBRTCConfig","React","RTCAppSpinner.react","RTCAppViewMain.react","RTCCallConnectionStatus.react","RTCCallStateInfo.react","RTCConferenceState","RTCConfig","RTCP2PCallActions","RTCP2PCallStore","RTCP2PConnectionStatus","RTCP2PIncallView.react","RTCP2PProtocolHandler","RTCP2PRedialButton.react","RTCP2PStartCallButton.react","RTCPeerInfo.react","RTCPreCallSetup.react","RTCRingBackTone.react","RTCStarRating.react","RTCTextButton.react","VideoCallWebDriverIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=function(a){__p&&__p();if(a.remoteUser==null)return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!0},b("React").createElement(b("RTCAppSpinner.react"),null));var c=a.awaitingEscalationACK,d=a.conferenceState,e=a.connectionStatus,f=a.endCallReason,g=a.escalationInProgress,l=a.escalationRequest,m=a.isAudioCall,n=a.isScreenContentPoppedOut,o=a.remoteUser,p=a.wasStarRatingDone;switch(d){case b("RTCConferenceState").NEW:return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCCallStateInfo.react"),null,b("RTCConfig").CollabPrecallScreen&&b("FBRTCConfig").isVCEndpointCall()?b("React").createElement(b("RTCPreCallSetup.react"),{conferenceState:d,peer:o}):b("React").createElement(b("RTCPeerInfo.react"),{peer:o}),b("React").createElement(b("RTCAppSpinner.react"),null)));case b("RTCConferenceState").AWAITING_USER_START:return b("RTCConfig").CollabPrecallScreen&&b("FBRTCConfig").isVCEndpointCall()?b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCCallStateInfo.react"),null,b("React").createElement(b("RTCPreCallSetup.react"),{conferenceState:d,peer:o}))):b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCCallStateInfo.react"),null,b("React").createElement(b("RTCPeerInfo.react"),{peer:o}),b("React").createElement(b("RTCCallConnectionStatus.react"),null,h._("Ready to call?")),b("React").createElement(b("RTCP2PStartCallButton.react"),{conferenceState:d,isAudio:m})));case b("RTCConferenceState").CONNECTING:case b("RTCConferenceState").CONNECTED:var q=l&&c||g;return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!m},b("React").createElement(b("RTCP2PIncallView.react"),babelHelpers["extends"]({audioSinkID:a.audioOutput,renderScreenStreams:!n,user:o},{isAudioCall:m}),b("React").createElement(b("RTCCallStateInfo.react"),{className:m?"":"_2fsu"},b("React").createElement(b("RTCPeerInfo.react"),{peer:o}),b("React").createElement(b("RTCCallConnectionStatus.react"),{connectionStatus:e},q?b("React").createElement(i,{awaitingEscalationACK:c,escalationInProgress:g,escalationRequest:l}):null))),b("React").createElement(j,{conferenceState:d,connectionStatus:e}));case b("RTCConferenceState").TERMINATING:case b("RTCConferenceState").TERMINATED:a=b("RTCP2PProtocolHandler").showRedialButton();n=!a&&!p;if(n)return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCStarRating.react"),babelHelpers["extends"]({isGroupCall:!1,onDone:k,shouldCloseWindow:!0},{isAudioCall:m})));else return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1},b("React").createElement(b("RTCCallStateInfo.react"),null,b("React").createElement(b("RTCPeerInfo.react"),{peer:o}),b("React").createElement(b("RTCCallConnectionStatus.react"),{connectionStatus:e},f?f.toString(b("FBRTCConfig").isVCEndpointCall()):null),b("React").createElement(b("RTCP2PRedialButton.react"),null)))}return b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!1})};var i=function(a){if(a.escalationRequest)return a.awaitingEscalationACK?h._("Sending response..."):b("React").createElement("div",null,h._("Would like to video chat..."),b("React").createElement("br",null),b("React").createElement("div",{className:"_46la _43ut"},h._("This will turn your video on.")));return a.escalationInProgress?h._("Requesting video..."):null},j=function(a){return a.conferenceState===b("RTCConferenceState").CONNECTING?b("React").createElement(b("RTCRingBackTone.react"),{active:a.connectionStatus===b("RTCP2PConnectionStatus").RINGING}):null};function k(){b("RTCP2PCallActions").starRatingDone(!0)}e.exports=a}),null);
__d("RTCP2PAppViewContentContainer.react",["FluxContainer","React","RTCP2PAppViewContent.react","RTCP2PCallEscalationStore","RTCP2PCallStore","RTCUserSettingsStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("RTCP2PCallEscalationStore"),b("RTCP2PCallStore"),b("RTCUserSettingsStore")]};a.calculateState=function(){var a=b("RTCP2PCallEscalationStore").getState(),c=b("RTCP2PCallStore").getState();c=c.wasStarRatingDone;var d=b("RTCUserSettingsStore").getState();d=d.audioOutput;return{audioOutput:d,awaitingEscalationACK:a.awaitingACK,escalationInProgress:a.inProgress,escalationRequest:Boolean(a.request),wasStarRatingDone:c}};a.prototype.render=function(){return b("React").createElement(b("RTCP2PAppViewContent.react"),babelHelpers["extends"]({},this.props,this.state))};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("RTCCallControlsEscalationAcceptButton.react",["cx","React","RTCCallControlsButtonWithLabel.react","RTCUICameraIcon.react","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.className;a=babelHelpers.objectWithoutProperties(a,["className"]);return b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),babelHelpers["extends"]({className:b("joinClasses")(c,"opaque redial icon-48"),"data-testid":b("VideoCallWebDriverIDs").ACCEPT_ESCALATION_CALL_BUTTON},a),b("React").createElement(b("RTCUICameraIcon.react"),null))};e.exports=a}),null);
__d("RTCCallControlsEscalationDeclineButton.react",["cx","React","RTCCallControlsButtonWithLabel.react","RTCUIXIcon.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";a=function(a){var c=a.className;a=babelHelpers.objectWithoutProperties(a,["className"]);return b("React").createElement(b("RTCCallControlsButtonWithLabel.react"),babelHelpers["extends"]({className:b("joinClasses")(c,"icon-48 closeWindow")},a),b("React").createElement(b("RTCUIXIcon.react"),null))};e.exports=a}),null);
__d("RTCP2PAppViewFooter.react",["cx","fbt","Promise","Bootloader","CollabCallMessengerBrowserEventEnum","CollabInitStreamTriggerType","CollabRTCChromeScreenSharingExtension","FBRTCCallControlPopover.react","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCConsoleLogger","FBRTCPeerConnection","FBRTCScreenSharingUtils","FBRTCSupport","immutable","MediaRequestSourceApp","MercuryIDs","MessengerParticipants.bs","MessengerRTCFunnelLogger","React","RTCAppViewFooter.react","RTCCallControls.react","RTCCallControlsAddGroupMembersButton.react","RTCCallControlsButton.react","RTCCallControlsCloseWindowButton.react","RTCCallControlsEndCallButton.react","RTCCallControlsEscalationAcceptButton.react","RTCCallControlsEscalationDeclineButton.react","RTCCallControlsToggleAudioButton.react","RTCCallControlsToggleScreenSharingWithFunnelButton.react","RTCCallControlsToggleVideoButton.react","RTCCallControlsVideoEscalationButton.react","RTCCallStore","RTCConferenceState","RTCP2PCallEscalationActions","RTCP2PProtocolHandler","RTCSelfView.react","RTCUtils","UserAgent","dangerouslyBypassDispatchError","gkx","keyMirror"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=1e4,k=b("keyMirror")({READY:null,SHOWN:null,COMPLETE:null}),l=255,m=320;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={forceVisible:k.READY,participants:b("immutable").Map(),showPopovers:!0},this.$1=0,this.$3=0,this.$4=null,this.$8=0,this.$10=0,this.$13=function(){this.props.protocolHandler.endCall()}.bind(this),this.$16=function(){q(function(a){a.setVidEscalationAcceptedClick(),a.setVidEscalationMediaRequested()}),b("RTCP2PProtocolHandler").initStream(!0).then(function(a){q(function(a){return a.setVidEscalationMediaSuccess()}),b("RTCP2PCallEscalationActions").setResponse(!0),this.$21(a)}.bind(this))["catch"](function(a){q(function(a){return a.setVidEscalationMediaFailed()}),this.$22(b("CollabCallMessengerBrowserEventEnum").GET_USER_MEDIA_ERROR,JSON.stringify({error:a.name,constraint:a.constraint,trigger:b("CollabInitStreamTriggerType").ESCALATION_APPROVED})),b("MessengerRTCFunnelLogger").appendAction("escalation_user_media_rejected")}.bind(this))}.bind(this),this.$18=function(){q(function(a){return a.setVidEscalationInitClick()}),this.props.escalationInProgress?b("RTCP2PCallEscalationActions").cancel():(q(function(a){return a.setVidEscalationMediaRequested()}),b("RTCP2PProtocolHandler").initStream(!0).then(function(a){q(function(a){return a.setVidEscalationMediaSuccess()}),this.$6=a,this.props.protocolHandler.startLocalVideoTracker(a),b("RTCP2PCallEscalationActions").start()}.bind(this))["catch"](function(a){q(function(a){return a.setVidEscalationMediaFailed()}),b("MessengerRTCFunnelLogger").appendAction("escalation_user_media_rejected"),this.$22(b("CollabCallMessengerBrowserEventEnum").GET_USER_MEDIA_ERROR,JSON.stringify({error:a.name,constraint:a.constraint,trigger:b("CollabInitStreamTriggerType").ESCALATION_INITIATED}))}.bind(this)))}.bind(this),this.$19=function(a){this.$9!==a&&(this.$9=a,this.forceUpdate())}.bind(this),this.$20=function(a){this.$7!==a&&(this.$7=a,this.forceUpdate())}.bind(this),this.$11=function(a){a=a.width;if(this.$10===a)return;this.$10=a;this.$23()}.bind(this),this.$12=function(a){a=a.width;if(this.$1===a)return;this.$1=a;this.$23()}.bind(this),this.$17=function(a){this.setState({showPopovers:a})}.bind(this),this.$14=function(a){a=a.width;if(this.$8===a)return;this.$8=a;this.$23()}.bind(this),c}a.prototype.componentDidMount=function(){var a=this;b("gkx")("AT5cptvyk3v4q-mPX6FvPR1r8kJdnP0MgzuDdVra8DpZXuiu89qXhkgPD7OKcZn2j9_1ar1-0wqcgyg_FLY_IdusNDUe63z-hD6N3VThwJfBrw")&&(function(){var c=b("MercuryIDs").getParticipantIDFromUserID(a.props.remoteUserID);b("MessengerParticipants.bs").get(c,function(a){var d;this.setState({participants:b("immutable").Map((d={},d[c]=a,d))})}.bind(a))})()};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.canPeerReceiveScreenSharing,d=a.conferenceState,e=a.escalationInProgress,f=a.hasRemoteScreenStream,g=a.isAudioCall,i=a.isRemoteVideoSupported,j=a.localUser,l=a.remotePeerName,m=a.protocolHandler;a=this.state.participants;var q=b("RTCP2PProtocolHandler").supportMultipleStreams(),r=j.getScreenStream(),s=b("gkx")("AT5cptvyk3v4q-mPX6FvPR1r8kJdnP0MgzuDdVra8DpZXuiu89qXhkgPD7OKcZn2j9_1ar1-0wqcgyg_FLY_IdusNDUe63z-hD6N3VThwJfBrw")&&this.props.offerEscalationSupport&&b("FBRTCSupport").isGroupCallWebtrcSupported();switch(d){case b("RTCConferenceState").AWAITING_USER_START:return b("FBRTCConfig").isVCEndpointCall()?b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-6",onResize:this.$11},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_2s-7",onResize:this.$12,ref:function(a){return this.$2=a?a.getDOMNode():a}.bind(this)},b("React").createElement(b("RTCCallControlsToggleVideoButton.react"),{conferenceState:d,disabled:!b("FBRTCConfig").isVCEndpointCall(),isP2P:!0,videoMuted:j.isVideoMuted()}),b("React").createElement(b("RTCCallControlsToggleAudioButton.react"),{audioMuted:j.isAudioMuted(),conferenceState:d,isP2P:!0}))):b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-7"});case b("RTCConferenceState").CONNECTING:return b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-6",onResize:this.$11},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_2s-7",onResize:this.$12,ref:function(a){return this.$2=a?a.getDOMNode():a}.bind(this)},b("React").createElement(b("RTCCallControlsToggleVideoButton.react"),{conferenceState:d,disabled:!b("FBRTCConfig").isVCEndpointCall(),isP2P:!0,videoMuted:j.isVideoMuted()}),b("React").createElement(b("RTCCallControlsToggleAudioButton.react"),{audioMuted:j.isAudioMuted(),conferenceState:d,isP2P:!0}),b("React").createElement(o,{conferenceState:d,disabled:!0,protocolHandler:m,stream:r}),b("React").createElement(b("RTCCallControlsEndCallButton.react"),{conferenceState:d,isP2P:!0,onClick:this.$13})),b("React").createElement(b("RTCSelfView.react"),{className:"_2s-8",hideCameraViewWhenScreenSharing:!q,onResize:this.$14,onScreenSharingStop:function(a){return m.stopScreenStream(a)},user:j}));case b("RTCConferenceState").CONNECTED:if(this.props.escalationRequest){var t=this.props.awaitingEscalationACK;return b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-6"},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_2s-7"},b("React").createElement(b("RTCCallControlsEscalationDeclineButton.react"),{disabled:t,onClick:this.$15,title:h._("Decline")}),b("React").createElement(b("RTCCallControlsEscalationAcceptButton.react"),{disabled:t,onClick:this.$16,title:h._("Accept")})))}return b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-6",onResize:this.$11},b("React").createElement(b("RTCCallControls.react"),{autoHide:!g&&this.state.forceVisible!==k.SHOWN,className:"_2s-7",onResize:this.$12,onUpdateVisibility:this.$17,ref:function(a){return this.$2=a?a.getDOMNode():a}.bind(this)},g&&i?b("React").createElement(b("RTCCallControlsVideoEscalationButton.react"),{onClick:this.$18,videoMuted:g&&!e}):b("React").createElement(b("React").Fragment,null,b("React").createElement(b("RTCCallControlsToggleVideoButton.react"),{conferenceState:d,disabled:!i,isP2P:!0,nodeRef:this.$19,videoMuted:j.isVideoMuted()}),this.state.showPopovers?b("React").createElement(n,{isRemoteVideoSupported:i,localUser:j,peerName:l,reference:this.$9,videoIsAutoDisabled:this.props.videoIsAutoDisabled}):null),b("React").createElement(b("RTCCallControlsToggleAudioButton.react"),{audioMuted:j.isAudioMuted(),conferenceState:d,isP2P:!0}),b("React").createElement(o,{conferenceState:d,disabled:g||!c||f,nodeRef:this.$20,protocolHandler:m,stream:r}),this.state.showPopovers?b("React").createElement(p,{canPeerReceiveScreenSharing:c,hasRemoteScreenStream:f,isAudioCall:g,peerName:l,reference:this.$7}):null,s?b("React").createElement(b("RTCCallControlsAddGroupMembersButton.react"),{isEscalatedCall:!0,localUser:j,participants:a,remoteUsers:b("immutable").List(this.props.remoteUsers),showNux:this.props.showAddMemberNux,thread:null}):null,b("React").createElement(b("RTCCallControlsEndCallButton.react"),{conferenceState:d,isP2P:!0,onClick:this.$13})),b("React").createElement(b("RTCSelfView.react"),{className:"_2s-8",hideCameraViewWhenScreenSharing:!q,onResize:this.$14,onScreenSharingStop:function(a){return m.stopScreenStream(a)},user:j}));case b("RTCConferenceState").TERMINATING:return b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-6",onResize:this.$11},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_2s-7",onResize:this.$12,ref:function(a){return this.$2=a?a.getDOMNode():a}.bind(this)},b("React").createElement(b("RTCCallControlsToggleVideoButton.react"),{conferenceState:d,disabled:!0,isP2P:!0,nodeRef:this.$19,videoMuted:!0}),b("React").createElement(b("RTCCallControlsToggleAudioButton.react"),{audioMuted:!0,conferenceState:d,disabled:!0,isP2P:!0}),b("React").createElement(o,{conferenceState:d,disabled:!0,nodeRef:this.$20,protocolHandler:m,stream:null}),b("React").createElement(b("RTCCallControlsEndCallButton.react"),{conferenceState:d,disabled:!0,isP2P:!0})),b("React").createElement(b("RTCSelfView.react"),{className:"_2s-8",hideCameraViewWhenScreenSharing:!q,onResize:this.$14,user:j}));case b("RTCConferenceState").TERMINATED:t=b("RTCP2PProtocolHandler").showRedialButton();return t?b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-6"},b("React").createElement(b("RTCCallControls.react"),{autoHide:!1,className:"_2s-7",onResize:this.$12,ref:function(a){return this.$2=a?a.getDOMNode():a}.bind(this)},this.props.shouldHideCloseButton?null:b("React").createElement(b("RTCCallControlsCloseWindowButton.react"),{showLabel:!0}))):b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-7"});default:return b("React").createElement(b("RTCAppViewFooter.react"),{className:"_2s-7"})}};a.prototype.$15=function(){q(function(a){return a.setVidEscalationDeclinedClick()}),b("RTCP2PCallEscalationActions").setResponse(!1)};a.prototype.$21=function(a){__p&&__p();if(b("FBRTCPeerConnection").isFirefoxSupportAddTrack()){var c=this.props.localUser.streams.first();for(var d=a.getVideoTracks(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.addTrack(g)}this.props.protocolHandler.updateAddedTracksForFirefoxVideoEscalation(c)}else b("RTCP2PProtocolHandler").replaceLocalStream(a)};a.prototype.$23=function(){__p&&__p();var a=this;if(this.$10===0||this.$1===0)return;var b=Math.min(0,this.$10/2-(this.$1/2+this.$8));if(b===this.$3)return;this.$3=b;this.$2&&(function(){var b=a.$2.style;b.transition="none";a.$4=requestAnimationFrame(function(){b.transform="translateX("+this.$3+"px)",b.transition=""}.bind(a))})()};a.prototype.$24=function(a){var b=this.props,c=b.localUser;b=b.videoIsAutoDisabled;a=a.forceVisible;b||c.hasStream()&&!c.hasVideo()?a===k.READY&&(this.setState({forceVisible:k.SHOWN}),this.$5=setTimeout(function(){this.setState({forceVisible:k.COMPLETE})}.bind(this),j)):a===k.SHOWN&&this.setState({forceVisible:k.COMPLETE})};a.prototype.$22=function(event,a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["CollabMessengerLogger"],function(b){return b.log(event,{peerID:this.props.remoteUserID,callID:Number(this.props.conferenceName),eventDetails:a})}.bind(this),"RTCP2PAppViewFooter.react")};a.prototype.componentDidUpdate=function(a,c){var d=this;this.$24(c);a.escalationInProgress&&!this.props.escalationInProgress&&(this.$6&&function(){var a=d.$6;d.props.escalated?b("dangerouslyBypassDispatchError")(function(){this.$21(a)}.bind(d)):(b("RTCUtils").stopMediaStream(a),d.props.protocolHandler.updateLocalVideoTracker());d.$6=null}())};a.prototype.componentWillUnmount=function(){this.$6&&(b("RTCUtils").stopMediaStream(this.$6),this.$6=null),cancelAnimationFrame(this.$4),clearTimeout(this.$5)};a.defaultProps={isRemoteVideoSupported:!0,videoIsAutoDisabled:!1};var n=function(a){var c=a.isRemoteVideoSupported,d=a.localUser,e=a.peerName,f=a.reference;a=a.videoIsAutoDisabled;if(f==null)return null;var g=null;!c?g=b("FBRTCCallControlPopover.react").Types.REMOTE_VIDEO_UNSUPPORTED:!d.hasVideo()?g=b("FBRTCCallControlPopover.react").Types.NO_VIDEO_TRACKS:a&&(g=b("FBRTCCallControlPopover.react").Types.VIDEO_AUTO_DISABLED);return g==null?null:b("React").createElement(b("FBRTCCallControlPopover.react"),{className:"_26bw",hideOnBlur:!0,peerName:e,reason:g,reference:f,width:m})},o=function(a){var c=a.conferenceState,d=a.disabled,e=a.nodeRef,f=a.protocolHandler;a=a.stream;return b("FBRTCScreenSharingUtils").isScreenSharingSupported()?b("React").createElement(b("RTCCallControlsToggleScreenSharingWithFunnelButton.react"),{conferenceState:c,disabled:d,isP2P:!0,onExtensionInstallStart:function(){return b("UserAgent").isBrowser("Chrome")?b("CollabRTCChromeScreenSharingExtension").install(b("MediaRequestSourceApp").RTC_CALL):b("Promise").reject("unexpected browser")},onShareStarted:function(a){return f.startScreenStream(a)},onShareStop:function(a){return f.stopScreenStream(a)},onShareStreamUpdate:function(a,b){return f.updateScreenStream(a,b)},ref:e,stream:a}):null},p=function(a){var c=a.canPeerReceiveScreenSharing,d=a.hasRemoteScreenStream,e=a.isAudioCall,f=a.peerName;a=a.reference;if(!a)return null;if(!b("FBRTCScreenSharingUtils").isScreenSharingSupported())return null;var g=null;!c?g=b("FBRTCCallControlPopover.react").Types.SCREENSHARING_UNAVAILABLE:d?g=b("FBRTCCallControlPopover.react").Types.PEER_IS_SHARING_SCREEN:e&&(g=b("FBRTCCallControlPopover.react").Types.IS_AUDIO_CALL);return g==null?null:b("React").createElement(b("FBRTCCallControlPopover.react"),{className:"_26bw",hideOnBlur:!0,isVCEndpointCall:b("FBRTCConfig").isVCEndpointCall(),peerName:f,reason:g,reference:a,width:l})};function q(a){var c=b("RTCCallStore").getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())}e.exports=a}),null);
__d("RTCP2PAppViewFooterContainer.react",["FluxContainer","React","RTCAppDispatcher","RTCCallStore","RTCP2PAppViewFooter.react","RTCP2PCallEscalationStore","RTCP2PCallNUXStore","RTCP2PCallStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=babelHelpers.inherits(h,b("React").PureComponent);g=a&&a.prototype;h.getStores=function(){return[b("RTCCallStore"),b("RTCP2PCallStore"),b("RTCP2PCallEscalationStore"),b("RTCP2PCallNUXStore")]};h.calculateState=function(){var a=b("RTCP2PCallEscalationStore").getState(),c=b("RTCP2PCallStore").getState(),d=b("RTCCallStore").getState();return{awaitingEscalationACK:a.awaitingACK,chatWindowVisible:c.chatWindowVisible,conferenceName:d.callInfo.conferenceName,escalated:a.escalated,escalationInProgress:a.inProgress,escalationRequest:Boolean(a.request),offerEscalationSupport:c.offerEscalationSupport,protocolHandler:c.protocolHandler,remoteUsers:d.remoteUsers,showAddMemberNux:b("RTCP2PCallNUXStore").getState().showAddGroupMemberNUX}};function h(){g.constructor.call(this),b("RTCAppDispatcher").explicitlyRegisterStores([].concat(h.getStores()))}h.prototype.render=function(){return b("React").createElement(b("RTCP2PAppViewFooter.react"),babelHelpers["extends"]({},this.props,this.state))};e.exports=b("FluxContainer").create(h)}),null);
__d("RTCChatPanelIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement("path",{d:"M24.999,35.9861483 C23.837,35.9861483 22.73,35.8825981 21.6915,35.6289751 C20.828,35.4183729 19.9265,35.4398834 19.0845,35.7270226 L15.083,36.9551183 C14.4385,37.175225 13.813,36.5489213 14.0315,35.8795966 L14.826,33.2498212 C15.1235,32.3378789 15.008,31.3373937 14.5085,30.5224984 C13.4515,28.7971616 13.0005,26.7361621 13,24.4545555 C13.001,17.7953257 18.0255,13 24.999,13 C31.973,13 36.9975,17.7953257 36.9985,24.4525545 C36.9975,31.1122845 31.973,35.9861483 24.999,35.9861483 Z",id:"path-1"})))};e.exports=a}),null);
__d("RTCCallControlsChatButton.react",["cx","fbt","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCExperiment","FluxContainer","React","RTCCallControlsButton.react","RTCCallStore","RTCChatPanelIcon.react","RTCP2PCallActions","RTCP2PCallStore","RTWebLoggingComponent","RTWebLoggingSurface","RTWebUserActionLogger","VideoCallWebDriverIDs","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;function j(a){var c=b("RTCCallStore").getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())}i=babelHelpers.inherits(k,b("React").PureComponent);i&&i.prototype;k.prototype.componentDidMount=function(){b("RTWebUserActionLogger").logImpression({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").TOGGLE_CHAT,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS}),j(function(a){return a.chatWindowEnabled(!0)})};k.prototype.render=function(){return b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")("transparent icon-50 _3n07",this.props.className),"data-testid":b("VideoCallWebDriverIDs").TOGGLE_CHAT_BUTTON,onClick:function(){return this.$1()}.bind(this),title:h._("Open Chat")},b("React").createElement(b("RTCChatPanelIcon.react"),null))};k.prototype.$1=function(){b("RTWebUserActionLogger").logClick({callType:b("RTWebUserActionLogger").getCallType(!this.props.isP2P),component:b("RTWebLoggingComponent").TOGGLE_CHAT,conferenceState:this.props.conferenceState,page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").CALL_CONTROLS}),j(function(a){return a.onChatPanelOpened()}),b("RTCP2PCallActions").toggleChatWindow()};function k(){i.apply(this,arguments)}function l(){var a=b("FBRTCExperiment").gen("rtc_www_show_chat_while_in_call");return a.getBool("show_chat",!1)&&!b("FBRTCConfig").isVCEndpointCall()}a=b("FluxContainer").createFunctional(function(a){return l()&&!a.chatWindowVisible?b("React").createElement(k,{conferenceState:a.conferenceState,isP2P:!0}):null},function(){return[b("RTCP2PCallStore")]},function(a,c,d){return babelHelpers["extends"]({},c,{chatWindowVisible:b("RTCP2PCallStore").getState().chatWindowVisible})},{withProps:!0});e.exports=a}),null);
__d("RTCUIPopoutIcon.react",["React","RTCSVGIcon.react"],(function(a,b,c,d,e,f){"use strict";a=function(a){var c=a.filledWindow;c=c===undefined?"front":c;a=babelHelpers.objectWithoutProperties(a,["filledWindow"]);return b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},c==="front"?b("React").createElement("path",{d:"M26 23H14.012a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2H26a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2zm9.994-8H24.006a2 2 0 0 0-2 2v4.997h2V17h11.988v8h-6.967v2h6.967a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2z"}):b("React").createElement("path",{d:"M36.01 14.996H24.02a2 2 0 0 0-2 2v4.997h4.028a3 3 0 0 1 3 3v2.003h6.96a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2zm-10.004 8.007H14.018a2 2 0 0 0-2 2v8a2 2 0 0 0 2 2h11.988a2 2 0 0 0 2-2v-8a2 2 0 0 0-2-2zm0 10H14.018v-8h11.988v8z"})))};e.exports=a}),null);
__d("RTCCallControlsPopOutScreenContentButton.react",["cx","fbt","FluxContainer","React","RTCAppDispatcher","RTCCallControlsButton.react","RTCP2PCallActions","RTCP2PCallNUXActions","RTCP2PCallNUXIDs","RTCP2PCallNUXStore","RTCUIPopoutIcon.react","XUIAmbientNUX.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;a.getStores=function(){return[b("RTCP2PCallNUXStore")]};a.calculateState=function(){var a=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];return babelHelpers["extends"]({},a,{showNUX:b("RTCP2PCallNUXStore").getState().showRemoteScreenContentPopOutNUX})};function a(a){i.constructor.call(this,a),this.$2=function(){this.state.showNUX&&j(),b("RTCP2PCallActions").togglePopOutScreenContent(this.props.mediaStream)}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCP2PCallNUXStore")])}a.prototype.render=function(){var a=this.props.mediaStream==null,c=a?h._("Show Shared Content"):h._("Open Shared Content in New Window");return b("React").createElement(b("React").Fragment,null,b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")(this.props.className,"transparent icon-50"),onClick:this.props.onClick||this.$2,ref:function(a){return this.$1=a}.bind(this),title:this.props.title||c},b("React").createElement(b("RTCUIPopoutIcon.react"),{filledWindow:a?"back":"front"})),b("React").createElement(k,{contextRef:function(){return this.$1}.bind(this),shown:this.state.showNUX&&this.props.mediaStream!=null}))};a.prototype.componentDidMount=function(){this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.$3=function(){this.state.showNUX&&this.props.mediaStream!=null&&b("RTCP2PCallNUXActions").markNUXViewed(b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_SCREEN_CONTENT_POP_OUT_NUX)};function j(){b("RTCP2PCallNUXActions").dismissNUX(b("RTCP2PCallNUXIDs").RTC_P2P_REMOTE_SCREEN_CONTENT_POP_OUT_NUX)}var k=function(a){return b("React").createElement(b("XUIAmbientNUX.react"),babelHelpers["extends"]({alignment:"right",onCloseButtonClick:j,position:"below",width:"auto"},a),h._("Pop-out shared content into a separate window"))};e.exports=b("FluxContainer").create(a)}),null);
__d("RTCSettingsAudioOutputPreview.react",["cx","Promise","FBRTCLogger","FBRTCUtils","MercurySoundsConfig","React","ShimButton.react","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.state={currentTime:0,disabled:!0,duration:0,playing:!1},this.$5=function(){var a=this.$1;if(!a||this.state.disabled)return;this.state.playing?(a.pause(),a.currentTime=0,this.$11()):(this.setState({disabled:!0}),b("promiseDone")(b("Promise").resolve(a.play()),function(){return this.setState({disabled:!1})}.bind(this)))}.bind(this),this.$12=function(a){a&&(this.$2=a)}.bind(this),this.$13=function(a){a&&(a.volume=.3,this.$1=a)}.bind(this),this.$14=function(a){a=a.target;this.setState({disabled:!1,duration:a.duration})}.bind(this),this.$15=function(){clearInterval(this.$3);this.setState({playing:!0,currentTime:0});var a=Date.now(),b=function(){return this.setState({currentTime:(Date.now()-a)/1e3})}.bind(this);b();this.$3=setInterval(b,40)}.bind(this),this.$11=function(){clearInterval(this.$3),this.$3=setTimeout(function(){return this.setState({playing:!1,currentTime:0})}.bind(this),250)}.bind(this),c}a.prototype.render=function(){return b("React").createElement(b("ShimButton.react"),{className:"_10mu",onClick:this.$5,tabIndex:0},this.$6(),this.$7(),this.$8(),this.$9(),this.$10())};a.prototype.$6=function(){return b("React").createElement("audio",{ref:this.$12,autoPlay:!0})};a.prototype.$7=function(){return b("React").createElement("audio",{ref:this.$13,autoPlay:!1,loop:!1,preload:"auto",onDurationChange:this.$14,onPlay:this.$15,onEnded:this.$11},b("React").createElement("source",{src:b("MercurySoundsConfig").settings_preview_sound_mp3_url,type:"audio/mpeg"}),b("React").createElement("source",{src:b("MercurySoundsConfig").settings_preview_sound_ogg_url,type:"audio/ogg"}))};a.prototype.$8=function(){var a=this.state.playing?b("React").createElement("path",{d:"M7 5h2v10H7V5zm4 0h2v10H11V5z"}):b("React").createElement("path",{d:"M7 6l6 4-6 4"});return b("React").createElement("svg",{className:"_odh button",viewBox:"0 0 20 20"},a)};a.prototype.$9=function(){var a=this.state,c=a.duration;a=a.currentTime;return b("React").createElement("div",{className:"_odz"},b("React").createElement("div",{className:"_od-",style:{transform:"scaleX("+(c?a/c:0)+")"}}))};a.prototype.$10=function(){var a=this.state.playing?this.state.currentTime:this.state.duration;return b("React").createElement("div",{className:"_odh text"},Math.floor(a)+"s")};a.prototype.componentDidMount=function(){var a=this.props,b=a.sinkID;a=a.mediaStream;this.$16(a);this.$4=setTimeout(function(){return this.$17(b)}.bind(this),1e3)};a.prototype.componentDidUpdate=function(a){var b=this.props,c=b.sinkID;b=b.mediaStream;b!==a.mediaStream?(this.$16(b),this.$17(c)):c!==a.sinkID&&this.$17(c)};a.prototype.$16=function(a){this.$2&&a&&b("FBRTCUtils").attachMediaStream(this.$2,a)};a.prototype.$17=function(a){clearTimeout(this.$4);if(!this.$18()||!a)return;[this.$2,this.$1].reduce(function(b,c){return c?b.then(function(){return c.setSinkId(a)}):b},b("Promise").resolve())["catch"](function(a){})};a.prototype.$18=function(){var a=HTMLAudioElement;a=a.prototype;return"sinkId"in a&&typeof a.setSinkId==="function"};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.pause(),clearInterval(this.$3),clearTimeout(this.$4),this.$2=null,this.$1=null};a.defaultProps={sinkID:null};e.exports=a}),null);
__d("RTCSettingsDialog.react",["cx","fbt","FBRTCConfig","FBRTCLogger","FBRTCUtils","FBRTCVideo.react","Link.react","React","RTCDialog.react","RTCDialogBody.react","RTCDialogHeader.react","RTCDialogHeaderButton.react","RTCP2PProtocolHandler","RTCSettingsAudioInputPreview.react","RTCSettingsAudioOutputPreview.react","RTCSettingsMediaDeviceSelector.react","RTCUserMediaConstraints","RTCUserSettingsActions","RTCUtils","SUIMessengerRTCLightTheme","SUIText.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={audioInput:this.props.audioInput,audioOutput:this.props.audioOutput,mediaStream:null,videoInput:this.props.videoInput},this.$2=function(){b("RTCUserSettingsActions").cancel(),this.props.onHideDialog()}.bind(this),this.$3=function(){var a=this.state,c=a.audioInput,d=a.audioOutput;a=a.videoInput;b("RTCUserSettingsActions").save({audioInput:c,audioOutput:d,videoInput:a});this.props.onHideDialog()}.bind(this),c}a.prototype.componentDidMount=function(){b("RTCUserSettingsActions").edit(),this.$1()["catch"](r)};a.prototype.componentWillUnmount=function(){var a=this.state.mediaStream;a&&b("RTCUtils").stopMediaStream(a)};a.prototype.render=function(){return!this.props.devices?null:b("React").createElement(b("RTCDialog.react"),{label:"Video and audio call settings",onToggle:this.props.onHideDialog,width:544},b("React").createElement(m,{onCancel:this.$2,onSave:this.$3}),b("React").createElement(b("RTCDialogBody.react"),null,this.props.isAudioOnly?null:b("React").createElement(j,{devices:this.props.devices,mediaStream:this.state.mediaStream,onVideoInputChange:function(a){return this.$4({videoInput:a})}.bind(this),selectedVideoInput:this.state.videoInput}),b("React").createElement(k,{devices:this.props.devices,mediaStream:this.state.mediaStream,onAudioInputChange:function(a){return this.$4({audioInput:a})}.bind(this),selectedAudioInput:this.state.audioInput}),b("FBRTCUtils").supportsSetSink()?b("React").createElement(l,{devices:this.props.devices,mediaStream:this.props.remoteStream,onAudioOutputChange:function(a){return this.$4({audioOutput:a})}.bind(this),selectedAudioOutput:this.state.audioOutput}):null,b("React").createElement(n,null)))};a.prototype.$4=function(a){this.setState(a,function(){this.$1()["catch"](r)}.bind(this))};a.prototype.$1=function(){var a=this.state,c=a.audioInput,d=a.mediaStream;a=a.videoInput;return b("RTCUtils").getUserMedia({audio:b("RTCUserMediaConstraints").audio(c),video:this.props.isAudioOnly?!1:b("RTCUserMediaConstraints").video(b("RTCP2PProtocolHandler").getDefaultVideoQuality(),a)}).then(function(a){d&&b("RTCUtils").stopMediaStream(d),this.setState({mediaStream:a})}.bind(this))};var j=function(a){return b("React").createElement(o,{className:"_10mn"},b("React").createElement(p,null,b("React").createElement(q,null,h._("Camera"))),b("React").createElement(p,null,b("React").createElement(b("RTCSettingsMediaDeviceSelector.react"),{devices:b("RTCUtils").filterDevicesByKind(a.devices,"videoinput"),onChange:a.onVideoInputChange,value:a.selectedVideoInput,width:212})),b("React").createElement(p,null,b("React").createElement(b("FBRTCVideo.react"),{className:"_10mo",mediaStream:a.mediaStream,muted:!0})))},k=function(a){return b("React").createElement(o,{className:"_10mn"},b("React").createElement(p,null,b("React").createElement(q,null,h._("Microphone"))),b("React").createElement(p,null,b("React").createElement(b("RTCSettingsMediaDeviceSelector.react"),{devices:b("RTCUtils").filterDevicesByKind(a.devices,"audioinput"),onChange:a.onAudioInputChange,value:a.selectedAudioInput,width:212})),b("React").createElement(p,null,b("React").createElement(b("RTCSettingsAudioInputPreview.react"),{mediaStream:a.mediaStream})))},l=function(a){return b("React").createElement(o,{className:"_10mn"},b("React").createElement(p,null,b("React").createElement(q,null,h._("Audio Output"))),b("React").createElement(p,null,b("React").createElement(b("RTCSettingsMediaDeviceSelector.react"),{devices:b("RTCUtils").filterDevicesByKind(a.devices,"audiooutput"),onChange:a.onAudioOutputChange,value:a.selectedAudioOutput,width:212})),b("React").createElement(p,null,b("React").createElement(b("RTCSettingsAudioOutputPreview.react"),{mediaStream:a.mediaStream,sinkID:a.selectedAudioOutput})))},m=function(a){return b("React").createElement(b("RTCDialogHeader.react"),null,b("React").createElement("h1",{className:"_10mm"},h._("Settings")),b("React").createElement(b("RTCDialogHeaderButton.react"),{label:h._("Cancel"),onClick:a.onCancel}),b("React").createElement(b("RTCDialogHeaderButton.react"),{label:h._("Save"),onClick:a.onSave}))},n=function(){return b("React").createElement("footer",{className:"_10mv _10mn"},b("React").createElement(p,null,b("React").createElement(b("SUIText.react"),{color:"placeholder",size:"header4",theme:b("SUIMessengerRTCLightTheme")},h._("Tip: Try restarting your browser if you're having trouble with your camera or microphone."))),b("React").createElement(p,null,b("React").createElement(b("SUIText.react"),{color:"blueLink",size:"header4",theme:b("SUIMessengerRTCLightTheme")},b("React").createElement(b("Link.react"),{href:b("FBRTCConfig").userMediaErrorUrl(),target:"_blank"},h._("Get help")))))},o=function(a){var c=a.children,d=a.className;a=babelHelpers.objectWithoutProperties(a,["children","className"]);return b("React").createElement("section",babelHelpers["extends"]({className:b("joinClasses")(d,"_10mx")},a),c)},p=function(a){var c=a.children;a=babelHelpers.objectWithoutProperties(a,["children"]);return b("React").createElement("div",babelHelpers["extends"]({className:"_10my"},a),c)},q=function(a){a=a.children;return b("React").createElement(b("SUIText.react"),{color:"placeholder",size:"header3",theme:b("SUIMessengerRTCLightTheme")},a)};function r(a){}e.exports=a}),null);
__d("RTCSettingsContainer.react",["FluxContainer","React","RTCAppDispatcher","RTCCallStore","RTCCallType","RTCMediaDevicesStore","RTCP2PCallStore","RTCSettingsDialog.react","RTCUserSettingsStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=babelHelpers.inherits(h,b("React").PureComponent);g=a&&a.prototype;function h(a){g.constructor.call(this,a),b("RTCAppDispatcher").explicitlyRegisterStores([].concat(h.getStores())),b("RTCMediaDevicesStore").refresh()}h.getStores=function(){return[b("RTCMediaDevicesStore"),b("RTCCallStore"),b("RTCP2PCallStore"),b("RTCUserSettingsStore")]};h.calculateState=function(){var a=b("RTCCallStore").getState();a=a.remoteUsers;var c=b("RTCP2PCallStore").getState();c=c.callType;var d=b("RTCUserSettingsStore").getState(),e=d.audioInput,f=d.audioOutput;d=d.videoInput;a=a?a.first():null;return{audioInput:e,audioOutput:f,devices:b("RTCMediaDevicesStore").getState(),isAudioOnly:c===b("RTCCallType").AUDIO_ONLY,remoteStream:a?a.streams.first():null,videoInput:d}};h.prototype.render=function(){return b("React").createElement(b("RTCSettingsDialog.react"),babelHelpers["extends"]({},this.props,this.state))};e.exports=b("FluxContainer").create(h)}),null);
__d("RTCUISettingsCogIcon.react",["React","RTCSVGIcon.react","RTCSVGIconDropShadowFilter.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$1="",this.$2=function(a){a&&(this.$1=a.getURL(),this.forceUpdate())}.bind(this),b}a.prototype.render=function(){var a=this.props,c=a.variant,d=a.shadow;a=babelHelpers.objectWithoutProperties(a,["variant","shadow"]);return d?b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement("defs",null,b("React").createElement(b("RTCSVGIconDropShadowFilter.react"),{height:24,ref:this.$2,width:24})),b("React").createElement("g",{filter:this.$1},b("React").createElement(h,{variant:c})))):b("React").createElement(b("RTCSVGIcon.react"),a,b("React").createElement("svg",{viewBox:"0 0 50 50"},b("React").createElement(h,{variant:c})))};a.defaultProps={variant:"outline"};var h=function(a){a=a.variant;return a==="outline"?b("React").createElement("g",{strokeWidth:"2"},b("React").createElement("path",{d:"M34.1 23.4l-1.4-.2c-1.1-.2-1.7-1.5-1-2.4l.8-1.1c.3-.4.3-1-.1-1.3l-.9-.9c-.3-.4-.9-.4-1.3-.1l-1.1.8c-.9.7-2.2.1-2.4-1l-.2-1.4c-.1-.5-.5-.9-1-.9h-1.3c-.5 0-.9.4-1 .9l-.2 1.4c-.2 1.1-1.5 1.7-2.4 1l-1.1-.8c-.4-.3-1-.3-1.3.1l-.9.9c-.3.4-.4.9-.1 1.3l.8 1.1c.7.9.1 2.2-1 2.4l-1.4.2c-.5.1-.9.5-.9 1v1.3c0 .5.4.9.9 1l1.4.2c1.1.2 1.7 1.5 1 2.4l-.8 1.1c-.3.4-.3 1 .1 1.3l.9.9c.3.4.9.4 1.3.1l1.1-.8c.9-.7 2.2-.1 2.4 1l.2 1.4c.1.5.5.9 1 .9h1.3c.5 0 .9-.4 1-.9l.2-1.4c.2-1.1 1.5-1.7 2.4-1l1.1.8c.4.3 1 .3 1.3-.1l.9-.9c.4-.4.4-.9.1-1.3l-.8-1.1c-.7-.9-.1-2.2 1-2.4l1.4-.2c.5-.1.9-.5.9-1v-1.3c0-.5-.4-1-.9-1z",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"}),b("React").createElement("circle",{cx:"25",cy:"25",fill:"none",r:"3.5"})):b("React").createElement("path",{d:"M34.2 22.9l-1.4-.2c-.4-.1-.6-.3-.8-.6-.1-.3-.1-.7.1-1L33 20c.4-.6.4-1.4-.1-2l-.9-.9c-.3-.3-.7-.4-1.1-.4-.3 0-.6.1-.9.3l-1.1.8c-.2.1-.4.2-.6.2-.4 0-.9-.3-1-.9l-.2-1.4c-.1-.7-.7-1.3-1.5-1.3h-1.3c-.7 0-1.4.5-1.5 1.3l-.2 1.4c-.1.6-.6.9-1 .9-.2 0-.4-.1-.6-.2l-1-.8c-.3-.2-.6-.3-.9-.3-.4 0-.8.2-1.1.4l-.9.9c-.5.5-.6 1.4-.1 2l.8 1.1c.2.3.3.6.1 1-.1.3-.4.6-.8.6l-1.4.2c-.7.1-1.3.7-1.3 1.5v1.3c0 .7.5 1.4 1.3 1.5l1.4.2c.3.1.6.3.8.6s.1.7-.1 1l-.8 1c-.4.6-.4 1.4.1 2l.9.9c.3.3.7.4 1.1.4.3 0 .6-.1.9-.3l1.1-.8c.2-.1.4-.2.6-.2.4 0 .9.3 1 .9l.2 1.4c.1.7.7 1.3 1.5 1.3h1.3c.7 0 1.4-.5 1.5-1.3l.2-1.4c.1-.6.6-.9 1-.9.2 0 .4.1.6.2l1 .8c.3.2.6.3.9.3.4 0 .8-.2 1.1-.4l.9-.9c.5-.5.6-1.4.1-2l-.8-1.1c-.2-.3-.3-.7-.1-1 .1-.3.4-.6.8-.6l1.4-.2c.7-.1 1.3-.7 1.3-1.5v-1.3c-.1-.7-.6-1.3-1.4-1.4zM25 28.5c-1.9 0-3.5-1.6-3.5-3.5s1.6-3.5 3.5-3.5 3.5 1.6 3.5 3.5-1.6 3.5-3.5 3.5z"})};e.exports=a}),null);
__d("RTCCallControlsShowSettingsButton.react",["cx","fbt","FBRTCUserSettings","FluxContainer","React","RTCAppDispatcher","RTCCallControlsButton.react","RTCP2PCallNUXActions","RTCP2PCallNUXIDs","RTCP2PCallNUXStore","RTCSettingsContainer.react","RTCUISettingsCogIcon.react","XUIAmbientNUX.react","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);i=d&&d.prototype;a.getStores=function(){return[b("RTCP2PCallNUXStore")]};a.calculateState=function(){var a=arguments.length<=0||arguments[0]===undefined?{highlighted:!1,pressed:!1}:arguments[0];return babelHelpers["extends"]({},a,{showNux:b("RTCP2PCallNUXStore").getState().showSettingsNUX})};function a(a){i.constructor.call(this,a),this.$2=function(){if(!b("FBRTCUserSettings").isEnabled())return;var a=this.context;a&&a.dialogShow&&a.dialogHide&&(a.dialogShow(b("React").createElement(b("RTCSettingsContainer.react"),{onHideDialog:this.$3})),this.setState({highlighted:!0}));this.state.showNux&&j()}.bind(this),this.$3=function(){this.setState({highlighted:!1}),this.context.dialogHide()}.bind(this),b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCP2PCallNUXStore")])}a.prototype.render=function(){var a=this.state,c=a.highlighted;a=a.pressed;a=c?a?"outline":"filled":a?"filled":"outline";return b("React").createElement(b("React").Fragment,null,b("React").createElement(b("RTCCallControlsButton.react"),{className:b("joinClasses")("transparent icon-50",this.props.className),highlighted:c,onClick:this.$2,onMouseDown:function(){return this.setState({pressed:!0})}.bind(this),onMouseUp:function(){return this.setState({pressed:!1})}.bind(this),ref:function(a){return this.$1=a}.bind(this),title:h._("Settings")},b("React").createElement(b("RTCUISettingsCogIcon.react"),{shadow:!0,variant:a})),b("React").createElement(k,{contextRef:function(){return this.$1}.bind(this),shown:this.state.showNux}))};a.prototype.componentDidMount=function(){this.$4()};a.prototype.componentDidUpdate=function(){this.$4()};a.prototype.$4=function(){this.state.showNux&&b("RTCP2PCallNUXActions").markNUXViewed(b("RTCP2PCallNUXIDs").RTC_P2P_SETTINGS_NUX)};a.prototype.componentWillUnmount=function(){var a=this.context;this.state.highlighted&&a&&a.dialogHide&&a.dialogHide()};a.contextTypes={dialogShow:c.func,dialogHide:c.func};function j(){b("RTCP2PCallNUXActions").dismissNUX(b("RTCP2PCallNUXIDs").RTC_P2P_SETTINGS_NUX)}var k=function(a){return b("React").createElement(b("XUIAmbientNUX.react"),babelHelpers["extends"]({alignment:"right",onCloseButtonClick:j,position:"below",width:"auto"},a),h._("Change your microphone, camera and speaker devices"))};e.exports=b("FluxContainer").create(a)}),null);
__d("RTCP2PAppViewHeader.react",["FBRTCConfig","FBRTCUserSettings","React","RTCAppViewHeader.react","RTCCallControls.react","RTCCallControlsChatButton.react","RTCCallControlsPopOutScreenContentButton.react","RTCCallControlsShowCameraControlsButton.react","RTCCallControlsShowSettingsButton.react","RTCCallControlsToggleFullScreenButton.react","RTCConferenceState","RTCP2PCallNUXStore","RTCP2PCallStore","UserAgent"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){var c=a.conferenceState,d=a.isAudioCall,e=a.isScreenContentPoppedOut;a=a.remoteUser;var f=!i({conferenceState:c,isAudioCall:d,isScreenContentPoppedOut:e,remoteUser:a});switch(c){case b("RTCConferenceState").AWAITING_USER_START:return b("FBRTCConfig").isVCEndpointCall()?b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:d},b("React").createElement(b("RTCCallControls.react"),babelHelpers["extends"]({compact:!0},{autoHide:f}),b("React").createElement(b("RTCCallControlsToggleFullScreenButton.react"),null),b("React").createElement(h,{isAudioOnly:d,peer:a}),b("React").createElement(b("RTCCallControlsChatButton.react"),{conferenceState:c}))):b("React").createElement(g,{autoHide:f,conferenceState:c,isAudioCall:d});case b("RTCConferenceState").CONNECTED:return b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:d},b("React").createElement(b("RTCCallControls.react"),babelHelpers["extends"]({compact:!0},{autoHide:f}),a&&a.hasScreenStream()?b("React").createElement(b("RTCCallControlsPopOutScreenContentButton.react"),{mediaStream:e?null:a.getScreenStream()}):null,b("FBRTCConfig").isVCEndpointCall()?b("React").createElement(b("RTCCallControlsShowCameraControlsButton.react"),null):null,b("React").createElement(b("RTCCallControlsToggleFullScreenButton.react"),null),b("React").createElement(h,{isAudioOnly:d,peer:a}),b("React").createElement(b("RTCCallControlsChatButton.react"),{conferenceState:c})));default:return b("React").createElement(g,{autoHide:f,conferenceState:c,isAudioCall:d})}};var g=function(a){var c=a.autoHide,d=a.conferenceState;a=a.isAudioCall;return b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:a},b("React").createElement(b("RTCCallControls.react"),babelHelpers["extends"]({compact:!0},{autoHide:c}),b("React").createElement(b("RTCCallControlsChatButton.react"),{conferenceState:d})))},h=function(a){var c=a.isAudioOnly;a=a.peer;var d=b("RTCP2PCallStore").getState();d=d.isPeerOnMobile;d=d&&b("UserAgent").isBrowser("Firefox");d=b("FBRTCUserSettings").isEnabled()&&!d;return d?b("React").createElement(b("RTCCallControlsShowSettingsButton.react"),{isAudioOnly:c,remoteStream:a?a.streams.first():null}):null};function i(a){__p&&__p();var c=a.conferenceState,d=a.isAudioCall,e=a.isScreenContentPoppedOut;a=a.remoteUser;if(d)return!0;if(c!==b("RTCConferenceState").CONNECTED)return!1;d=b("RTCP2PCallNUXStore").getState();c=d.showRemoteCameraControlsNUX;var f=d.showRemoteScreenContentPopOutNUX,g=d.showRemoteStreamsSliderNUX;d=d.showSettingsNUX;return d||b("FBRTCConfig").isVCEndpointCall()&&c||!!a&&a.hasScreenStream()&&!e&&(g||f)}e.exports=a}),null);
__d("RTCPeerConnectionStats.react",["FBRTCLogger","React","RTCConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PureComponent;d=babelHelpers.inherits(a,c);g=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.state={stats:[]},b}a.prototype.render=function(){if(!b("RTCConfig").PeerConnectionStatsGK)return null;if(this.state.stats.length<1)return null;var a={background:"white",bottom:0,color:"black",fontSize:10,left:0,margin:0,opacity:.7,padding:"1em",position:"absolute",textAlign:"left",zIndex:9};return b("React").createElement("pre",{style:babelHelpers["extends"]({},a,this.props.style)},[this.$2("in"),this.$2("out")].filter(Boolean).join("\n"))};a.prototype.$2=function(a){__p&&__p();var b=this.state.stats.filter(function(b){return b.direction===a}).map(function(b){__p&&__p();b.id;var c=b.type,d=b.packetsLost,e=b.resolution,f=b.frameRate;b=babelHelpers.objectWithoutProperties(b,["id","type","packetsLost","resolution","frameRate"]);var g=void 0;if(a==="in"){var h=b.bytesReceived,i=b.packetsReceived,j=d/(i+d)||0;g=["b:  "+h,"p:  "+d+" / "+i,"l:  "+j.toFixed(4).replace(/\.?0+$/,"")+"%"]}else{h=b.bytesSent;i=b.packetsSent;j=d/(i+d)||0;g=["b:  "+h,"p:  "+d+" / "+i,"l:  "+j.toFixed(4).replace(/\.?0+$/,"")+"%"]}f&&g.unshift("fr: "+f);e&&g.unshift("r:  "+e);return c+" "+a+":\n  "+g.join("\n  ")}).join("\n");return!b.length?"":b};a.prototype.componentDidMount=function(){__p&&__p();if(!b("RTCConfig").PeerConnectionStatsGK)return;this.$1=setInterval(function(){__p&&__p();var a=this.props.connection;if(!a||a.getIceConnectionState()==="closed"||a.getIceConnectionState()==="disconnected")return;a.getStats().then(function(a){__p&&__p();var b=[];for(var a=a.values(),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;if(e.type==="ssrc"){var f={id:e.id,packetsLost:e.packetsLost||0,type:e.mediaType};if(e.mediaType==="video"){var g=e.googBandwidthLimitedResolution?" (BW limited)":"";if("googFrameWidthSent"in e){var h=e.googFrameWidthSent,i=e.googFrameHeightSent;f.resolution=h+"x"+i+g}else if("googFrameWidthReceived"in e){h=e.googFrameWidthReceived;i=e.googFrameHeightReceived;f.resolution=h+"x"+i+g}if("googFrameRateInput"in e){h=e.googFrameRateInput;i=e.googFrameRateSent;f.frameRate=h+" -> "+i}else if("googFrameRateOutput"in e){g=e.googFrameRateOutput;h=e.googFrameRateReceived;f.frameRate=g+" -> "+h}}"bytesSent"in e?(f.bytesSent=e.bytesSent,f.packetsSent=e.packetsSent,f.direction="out"):(f.bytesReceived=e.bytesReceived,f.packetsReceived=e.packetsReceived,f.direction="in");b.push(f)}}return b}).then(function(a){return this.setState({stats:a})}.bind(this))["catch"](function(a){b("FBRTCLogger").getInstance().logToConsole(JSON.stringify(a))})}.bind(this),1e3)};a.prototype.componentWillUnmount=function(){clearInterval(this.$1)};e.exports=a}),null);
__d("RTCP2PAppView.react",["React","RTCAppSpinner.react","RTCAppView.react","RTCAppViewFooter.react","RTCAppViewHeader.react","RTCAppViewMain.react","RTCGrantUserMediaAccessView.react","RTCMediaDeniedPrompt.react","RTCP2PAppViewContentContainer.react","RTCP2PAppViewFooterContainer.react","RTCP2PAppViewHeader.react","RTCPeerConnectionStats.react","RTCUserMediaRequest","RTCUserMediaRequestState"],(function(a,b,c,d,e,f){"use strict";a=function(a){var c=a.conferenceState,d=a.isAudioCall,e=a.isScreenContentPoppedOut,f=a.remoteUser,g=a.userMediaRequest;switch(g.state){case b("RTCUserMediaRequestState").PENDING:case b("RTCUserMediaRequestState").REJECTED:return b("React").createElement(b("RTCAppView.react"),{isAudioCall:d},b("React").createElement(b("RTCMediaDeniedPrompt.react"),null),b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:d}),b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!0},b("React").createElement(b("RTCGrantUserMediaAccessView.react"),{isAudioCall:d,userMediaRequest:g})),b("React").createElement(b("RTCAppViewFooter.react"),null));case b("RTCUserMediaRequestState").FULFILLED:return b("React").createElement(b("RTCAppView.react"),{isAudioCall:d&&!a.acceptedEscalation},b("React").createElement(b("RTCP2PAppViewHeader.react"),{conferenceState:c,isAudioCall:d,isScreenContentPoppedOut:e,remoteUser:f}),b("React").createElement(b("RTCP2PAppViewContentContainer.react"),{conferenceName:a.conferenceName,conferenceState:c,connectionStatus:a.connectionStatus,endCallReason:a.endCallReason,isAudioCall:d,isScreenContentPoppedOut:e,remoteUser:f}),b("React").createElement(b("RTCP2PAppViewFooterContainer.react"),{canPeerReceiveScreenSharing:a.canPeerReceiveScreenSharing,conferenceState:c,hasRemoteScreenStream:f?f.hasScreenStream():!1,isAudioCall:d,localUser:a.localUser,remotePeerName:f?f.userName:"",remoteUserID:f?f.FBID:"",shouldHideCloseButton:a.shouldHideCloseButton}),a.allowsMWEscalation?null:b("React").createElement(b("RTCPeerConnectionStats.react"),{connection:a.connection,style:{marginBottom:40}}));default:return b("React").createElement(b("RTCAppView.react"),{isAudioCall:d},b("React").createElement(b("RTCAppViewHeader.react"),{isAudioCall:d}),b("React").createElement(b("RTCAppViewMain.react"),{fullBleed:!0},b("React").createElement(b("RTCAppSpinner.react"),null)),b("React").createElement(b("RTCAppViewFooter.react"),null))}};e.exports=a}),null);
__d("RTCP2PAppViewContainer.react",["FBRTCScreenSharingUtils","FluxContainer","React","RTCAppDispatcher","RTCP2PAppView.react","RTCP2PCallEscalationStore","RTCP2PCallStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;a=babelHelpers.inherits(h,b("React").PureComponent);g=a&&a.prototype;h.getStores=function(){return[b("RTCP2PCallEscalationStore"),b("RTCP2PCallStore")]};h.calculateState=function(){var a=b("RTCP2PCallStore").getState(),c=a.connectionStatus,d=a.endCallReason,e=a.isScreenContentPoppedOut;a=a.signalingExperiments;return{acceptedEscalation:b("RTCP2PCallEscalationStore").getState().response,connectionStatus:c,endCallReason:d,canPeerReceiveScreenSharing:b("FBRTCScreenSharingUtils").canPeerReceiveScreenSharing(a),isAudioCall:b("RTCP2PCallStore").isAudioOnly(),isScreenContentPoppedOut:e}};function h(){g.constructor.call(this),b("RTCAppDispatcher").explicitlyRegisterStores([].concat(h.getStores()))}h.prototype.render=function(){return b("React").createElement(b("RTCP2PAppView.react"),babelHelpers["extends"]({},this.props,this.state))};e.exports=b("FluxContainer").create(h)}),null);
__d("RTCP2PCallView.react",["cx","fbt","PageHooks","Bootloader","BootloadOnRender.react","CollabCallMessengerBrowserEventEnum","CollabInitStreamTriggerType","CSS","FBRTCCallSummary","FBRTCCallSummaryStore","FBRTCConfig","FBRTCConstants","FBRTCLogger","FBRTCMessageListener","FBRTCVideoEscalationStore","JSResource","LazyComponent.react","MercuryIDs","MessengerBugNub.react","MessengerRTCFunnelLogger","MercurySyncEnvironment","React","RTCCallActions","RTCCallControlsButton.react","RTCCallStore","RTCCallType","RTCCallInitUtils","RTCConferenceState","RTCP2PAppViewContainer.react","RTCP2PCallActions","RTCP2PCallWindowHandler","RTCP2PProtocolHandler","RTCUIXIcon.react","RTCUser","RTCUserMediaRequest","RTCUserMediaRequestState","Run","UserMediaRequestError","RTWebUserActionLogger","RTWebLoggingSurface"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;b("PageHooks");var j=b("FBRTCConstants").SignalingProtocol;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(a){__p&&__p();i.constructor.call(this,a);this.state={userMediaRequest:new(b("RTCUserMediaRequest"))()};this.$1=null;this.$2=b("FBRTCLogger").getInstance();this.$3=function(){return this.props.conferenceState===b("RTCConferenceState").CONNECTED?h._("Leaving this page will end your call."):null}.bind(this);this.$4=function(){__p&&__p();if(this.props.conferenceState===b("RTCConferenceState").TERMINATED)return;var a=b("FBRTCConstants").CallEndReason.HANGUP_CALL,c="BrowserClosed",d=this.state.userMediaRequest;if(d.state===b("RTCUserMediaRequestState").PENDING)a=b("FBRTCConstants").CallEndReason.CLIENT_ERROR,c="MediaPending";else if(d.state===b("RTCUserMediaRequestState").REJECTED){d=d.error;a=b("FBRTCConstants").CallEndReason.CLIENT_ERROR;c=!d||d.name==="NotAllowedError"?"MediaDenied":d.getEndCallSubReason()}this.props.protocolHandler.endCall(a,c,!0)}.bind(this);this.props.nonce&&b("MessengerRTCFunnelLogger").setWindowNonce(this.props.nonce);b("Run").onBeforeUnload(this.$3,!1);b("Run").onUnload(this.$4);if(!a.allowsMWEscalation){a=this.props.conferenceName;b("RTCCallActions").initialize(j.P2P,a,null,a);b("RTCP2PCallActions").setCallType(this.props.isInitiallyAudioCall?b("RTCCallType").AUDIO_ONLY:b("RTCCallType").AUDIO_VIDEO);b("RTCP2PCallActions").setIsCaller(this.props.isCaller)}}a.prototype.componentDidMount=function(){__p&&__p();b("RTCP2PCallWindowHandler").init(window);document.documentElement!=null&&b("CSS").addClass(document.documentElement,"_2ujx");this.$2.logCallAction(this.$5(),this.$6(),b("FBRTCLogger").CallAction.POPUP_OPENED);var a=b("FBRTCCallSummary").restoreOrInitialize(b("FBRTCCallSummaryStore").getInstance(),this.$5(),this.$6(),this.props.isCaller);b("RTCCallActions").setCallSummary(a);r(function(a){a.setClientVersion("2.0"),a.onPopupOpened(),a.setCallType(this.props.isInitiallyAudioCall?b("FBRTCVideoEscalationStore").CallType.voip:b("FBRTCVideoEscalationStore").CallType.direct_video),a.setActiveConnection("p2p")}.bind(this));this.props.protocolHandler.init(this.$5(),this.$6());a=[this.props.localUser.FBID,this.props.remoteUserFBID];b("RTCCallInitUtils").initializeRTCUsers(a,function(){this.$1=setTimeout(function(){this.setState(function(a){a=a.userMediaRequest;return{userMediaRequest:a.set("state",a.state||b("RTCUserMediaRequestState").PENDING)}})}.bind(this),2e3),this.$7().then(function(a){return b("RTCCallActions").addLocalStream(a)}).then(function(){return this.$8()}.bind(this))["catch"](q)}.bind(this))};a.prototype.$5=function(){return this.props.remoteUserFBID};a.prototype.$6=function(){return Number(this.props.conferenceName)};a.prototype.$7=function(){__p&&__p();b("MessengerRTCFunnelLogger").appendAction("user_media_requested");r(function(a){return a.onMediaRequested()});return b("RTCP2PProtocolHandler").initStream(!this.props.isInitiallyAudioCall).then(function(a){this.setState(function(a){a=a.userMediaRequest;return{userMediaRequest:a.set("state",b("RTCUserMediaRequestState").FULFILLED)}});r(function(a){return a.onMediaSucceeded()});b("MessengerRTCFunnelLogger").appendAction("user_media_succeeded");return a}.bind(this))["catch"](function(a){this.setState(function(c){c=c.userMediaRequest;return{userMediaRequest:c.set("error",a).set("state",b("RTCUserMediaRequestState").REJECTED)}});r(function(c){return c.onCallEnded(b("FBRTCConstants").CallEndReason.CLIENT_ERROR,!1,!0,"MediaDenied: "+a.name+", "+a.constraint)});this.$2.logError(this.$5(),this.$6(),"MediaDenied: "+a.name+", "+a.constraint);b("MessengerRTCFunnelLogger").appendAction("user_media_rejected");this.$9(a,b("CollabInitStreamTriggerType").USER_MEDIA_REQUEST);throw a}.bind(this))};a.prototype.$8=function(){this.props.protocolHandler.fetchTURNCredentials().then(function(){var a=b("FBRTCMessageListener").setParentWindowStartCallHandler(function(){this.props.protocolHandler.startCall(),a&&(a(),a=null)}.bind(this));b("FBRTCMessageListener").init(!0,this.$5());setTimeout(function(){b("RTCCallActions").waitForUserInput(),a&&(a(),a=null)},1500)}.bind(this))["catch"](function(a){return b("MessengerRTCFunnelLogger").appendAction("start_call_failed")})};a.prototype.$9=function(a,c){this.$10(b("CollabCallMessengerBrowserEventEnum").GET_USER_MEDIA_ERROR,JSON.stringify({error:a.name,constraint:a.constraint,trigger:c})),b("RTWebUserActionLogger").logError({errorDomain:b("CollabCallMessengerBrowserEventEnum").GET_USER_MEDIA_ERROR,errorType:JSON.stringify(a),page:b("RTWebUserActionLogger").getPage(),surface:b("RTWebLoggingSurface").P2P_CALL_CONTAINER})};a.prototype.$10=function(event,a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["CollabMessengerLogger"],function(b){return b.log(event,{peerID:this.props.remoteUserFBID,callID:this.$6(),eventDetails:a})}.bind(this),"RTCP2PCallView.react")};a.prototype.render=function(){return b("React").createElement(k,{calleeID:this.$5(),callerID:this.props.localUser.FBID,enabled:this.props.chatWindowVisible},b("React").createElement("div",null,b("React").createElement(b("RTCP2PAppViewContainer.react"),{allowsMWEscalation:this.props.allowsMWEscalation,conferenceName:this.props.conferenceName,conferenceState:this.props.conferenceState,connection:this.props.connection,localUser:this.props.localUser,remoteUser:this.props.remoteUser,shouldHideCloseButton:!this.props.nonce,userMediaRequest:this.state.userMediaRequest}),b("React").createElement(b("MessengerBugNub.react"),{isBetaEnabled:this.props.isBetaEnabled,unixName:this.props.unixName})))};a.prototype.componentDidUpdate=function(a){__p&&__p();if(a.userSettings.editing&&!this.props.userSettings.editing){var c=this.props.userSettings,d=c.audioInput;c=c.videoInput;(a.userSettings.audioInput!==d||a.userSettings.videoInput!==c)&&b("RTCP2PProtocolHandler").initStream(!this.props.isAudioCall,d,c).then(function(a){return b("RTCP2PProtocolHandler").replaceLocalStream(a,!0)})["catch"](function(a){return this.$9(a,b("CollabInitStreamTriggerType").USER_SETTINGS_CHANGED)}.bind(this))}this.props.conferenceState===a.conferenceState?this.$2.logToConsole('UI: no state change; current state - "'+this.props.conferenceState+'"'):this.$2.logToConsole('UI: state change - from "'+a.conferenceState+'" to "'+this.props.conferenceState+'"');d=this.state.userMediaRequest;d.state===b("RTCUserMediaRequestState").PENDING&&r(function(a){return a.onCallEnded(b("FBRTCConstants").CallEndReason.CLIENT_ERROR,!1,!0,"MediaPending")})};a.prototype.componentWillUnmount=function(){clearTimeout(this.$1),document.documentElement!=null&&b("CSS").removeClass(document.documentElement,"_2ujx")};function k(a){var c=b("MercuryIDs").getThreadIDFromUserID(a.calleeID);return b("React").createElement("div",{className:"_2txj"},b("React").createElement("div",{className:"_2tz1"},a.children),a.enabled?b("React").createElement("div",{className:"_1a7z"},b("React").createElement(p,{fbId:a.callerID,threadID:c,title:h._("Chat")})):null)}var l=!1;function m(){l||(b("MercurySyncEnvironment").setUp(),l=!0)}function n(){r(function(a){return a.onChatPanelClosed()}),b("RTCP2PCallActions").toggleChatWindow()}var o=function(){return b("React").createElement(b("RTCCallControlsButton.react"),{className:"icon-30 _31j4",onClick:function(){return n()},title:h._("Close Chat")},b("React").createElement(b("RTCUIXIcon.react"),null))};function p(a){m();return b("React").createElement("div",null,b("React").createElement("div",{className:"_1a7p"},a.title,b("React").createElement(o,null)),b("React").createElement("div",{className:"_1a7y"},b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{activeThreadID:a.threadID,blockedIds:new Set([]),deliveryReceipts:{},isWorkUser:!1,readReceipts:{},showMinimalForRTC:!0,viewer:a.fbId}),loader:b("JSResource")("MessengerDetailView.react").__setRef("RTCP2PCallView.react"),placeholder:b("React").createElement("div",null)})))}function q(a){}function r(a){var c=b("RTCCallStore").getState();c=c.callSummary;a(c);c.save(b("FBRTCCallSummaryStore").getInstance())}e.exports=a}),null);
__d("RTCP2PLoggerStore",["Bootloader","CollabCallMessengerBrowserEventEnum","FBRTCConfig","FBRTCLogger","FluxReduceStore","RTCAppDispatcher","RTCCallActionTypes","RTCCallStore","RTCUserSettingsActionTypes"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxReduceStore"));g&&g.prototype;a.prototype.getInitialState=function(){return 1};a.prototype.reduce=function(a,c){__p&&__p();a=b("RTCCallStore").getState();var d=a.remoteUsers;a=a.callInfo;if(!d.count())return 1;var e=b("FBRTCLogger").getInstance();d=d.first().FBID;switch(c.type){case b("RTCCallActionTypes").AUDIO_MUTED:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.SET_MUTE,!0);break;case b("RTCCallActionTypes").AUDIO_UNMUTED:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.SET_MUTE,!1);break;case b("RTCCallActionTypes").VIDEO_MUTED:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.SET_VIDEO_ON,!1);break;case b("RTCCallActionTypes").VIDEO_UNMUTED:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.SET_VIDEO_ON,!0);break;case b("RTCCallActionTypes").SELF_VIEW_COLLAPSED:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.SET_SELF_VIEW_ON,!1);break;case b("RTCCallActionTypes").SELF_VIEW_UNCOLLAPSED:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.SET_SELF_VIEW_ON,!0);break;case b("RTCCallActionTypes").ADD_LOCAL_STREAM:this.$RTCP2PLoggerStore1(b("CollabCallMessengerBrowserEventEnum").LOCAL_STREAM_SET,c.stream,d,Number(a.conferenceName));break;case b("RTCUserSettingsActionTypes").USER_SETTINGS_SAVE:case b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_AUDIO_INPUT:case b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_AUDIO_OUTPUT:case b("RTCUserSettingsActionTypes").USER_SETTINGS_SET_VIDEO_INPUT:e.logCallAction(d,a.conferenceName,b("FBRTCLogger").CallAction.USER_SETTINGS_CHANGED),this.$RTCP2PLoggerStore1(b("CollabCallMessengerBrowserEventEnum").USER_SETTINGS_CHANGED,c,d,Number(a.conferenceName))}return 1};a.prototype.$RTCP2PLoggerStore1=function(event,a,b,c){h(function(d){return d.log(event,{peerID:b,callID:c,eventDetails:a})})};function a(){g.apply(this,arguments)}a.__moduleID=e.id;function h(a){if(!b("FBRTCConfig").isVCEndpointCall())return;b("Bootloader").loadModules(["CollabMessengerLogger"],a,"RTCP2PLoggerStore")}e.exports=new a(b("RTCAppDispatcher"))}),null);
__d("RTCP2PCallContainer.react",["FBRTCUtils","FluxContainer","React","RTCAppDispatcher","RTCCallStore","RTCCallType","RTCMediaDevicesStore","RTCP2PCallEscalationStore","RTCP2PCallNUXStore","RTCP2PCallStore","RTCP2PCallView.react","RTCP2PLoggerStore","RTCUserSettingsStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("FBRTCUtils").generateRandomInt().toString();a=babelHelpers.inherits(i,b("React").PureComponent);g=a&&a.prototype;i.getStores=function(){return[b("RTCCallStore"),b("RTCP2PCallStore"),b("RTCUserSettingsStore")]};i.calculateState=function(){var a=b("RTCCallStore").getState(),c=a.callInfo,d=c.conferenceState;c=c.conferenceName;var e=a.connections,f=a.localUser;a=a.remoteUsers;var g=b("RTCP2PCallStore").getState(),h=g.callType,i=g.chatWindowVisible;g=g.protocolHandler;return{chatWindowVisible:i,conferenceName:c,conferenceState:d,connection:e.first(),isAudioCall:h===b("RTCCallType").AUDIO_ONLY,localUser:f,protocolHandler:g,remoteUser:a.first(),userSettings:b("RTCUserSettingsStore").getState()}};function i(){g.constructor.call(this),b("RTCAppDispatcher").explicitlyRegisterStores([].concat(i.getStores(),[b("RTCMediaDevicesStore"),b("RTCP2PCallEscalationStore"),b("RTCP2PCallNUXStore"),b("RTCP2PLoggerStore")]))}i.prototype.render=function(){var a=this.props,c=a.conferenceName;a=babelHelpers.objectWithoutProperties(a,["conferenceName"]);return b("React").createElement(b("RTCP2PCallView.react"),babelHelpers["extends"]({},a,this.state,{conferenceName:c||this.state.conferenceName||h}))};e.exports=b("FluxContainer").create(i)}),null);
__d("RTCCallContainer.react",["fbt","PageHooks","FBRTCConstants","FBRTCGroupCallStore","FBRTCHangupReason","FBRTCMWProtocolStore","FBRTCUtils","FluxContainer","FunnelLogger","MessengerBannerOverlay.react","MessengerBugNub.react","MessengerRTCFunnelLogger","RTCGroupCallView.react","RTCMWProtocolHandler","RTCP2PCallContainer.react","RTCGroupCallEscalationStore","RTCP2PCallEscalationStore","RTCUserMediaRequest","RTCUserMediaRequestState","Run","immutable","intlList","React","RTCAppDispatcher","RTCCallActions","RTCCallStore","RTCCallType","RTCConferenceState","RTCMediaDevicesStore","RTCP2PCallActions","RTCP2PCallNUXStore","RTCP2PCallStore","RTCP2PLoggerStore","RTCUser","RTCUserSettingsStore"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;b("PageHooks");var i=b("FBRTCConstants").SignalingProtocol;a=babelHelpers.inherits(j,b("React").PureComponent);h=a&&a.prototype;j.getStores=function(){return[b("FBRTCGroupCallStore"),b("RTCCallStore"),b("RTCGroupCallEscalationStore")]};j.calculateState=function(){var a=b("RTCGroupCallEscalationStore").getState(),c=a.aborted,d=a.inProgress;a=a.readyToTransition;var e=b("RTCCallStore").getState(),f=e.callInfo,g=e.localUser;e=e.remoteUsers;var h=b("FBRTCGroupCallStore").getState(),i=h.layout;h=h.participants;return{abortedMWEscalation:c,conferenceState:f.conferenceState,escalationToMWInProgress:d,layout:i,localUser:g,participants:h,protocol:f.protocol,remoteUsers:e,serverInfoData:f.serverInfoData,useGroupCallView:a}};function j(a){__p&&__p();h.constructor.call(this,a);this.state=babelHelpers["extends"]({},j.calculateState());this.$2=function(){__p&&__p();if(this.state.conferenceState===b("RTCConferenceState").TERMINATED)return;var a=b("FBRTCConstants").CallEndReason.HANGUP_CALL,c="BrowserClosed";this.state.protocol===i.P2P&&b("RTCP2PCallStore").getState().protocolHandler.endCall(a,c,!0);if(this.state.protocol===i.MULTIWAY){a=b("RTCCallStore").getState().callInfo;var d=a.conferenceName;a=a.serverInfoData;b("RTCMWProtocolHandler").endCall(d,a,b("FBRTCHangupReason").HANGUP_CALL,c)}}.bind(this);this.$1=function(){return this.state.conferenceState===b("RTCConferenceState").CONNECTED?g._("Leaving this page will end your call."):null}.bind(this);document.documentElement&&(document.documentElement.style.overflow="hidden");b("RTCAppDispatcher").explicitlyRegisterStores([b("RTCCallStore"),b("RTCP2PCallEscalationStore"),b("RTCP2PCallNUXStore"),b("RTCP2PCallStore"),b("RTCP2PLoggerStore"),b("RTCMediaDevicesStore"),b("RTCUserSettingsStore"),b("RTCGroupCallEscalationStore"),b("FBRTCMWProtocolStore")]);a=this.props.conferenceName||b("FBRTCUtils").generateRandomInt().toString();b("RTCCallActions").initialize(i.P2P,a,null,a);b("RTCP2PCallActions").setCallType(this.props.isInitiallyAudioCall?b("RTCCallType").AUDIO_ONLY:b("RTCCallType").AUDIO_VIDEO);b("Run").onBeforeUnload(this.$1,!1);b("Run").onUnload(this.$2);b("FunnelLogger").startFunnel("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL")}j.prototype.render=function(){__p&&__p();var a=null;if(this.props.allowsMWEscalation&&this.state.useGroupCallView){var c=b("RTCP2PCallStore").getState();c=c.escalationConferenceName;c=c||"";var d=b("RTCCallStore").hasRemoteVideo(),e=new(b("RTCUserMediaRequest"))();e=e.set("state",b("RTCUserMediaRequestState").FULFILLED);a=b("React").createElement(b("React").Fragment,null,b("React").createElement(b("RTCGroupCallView.react"),{conferenceName:c,conferenceState:this.state.conferenceState,endCallReason:null,isAudioCall:!d,layout:this.state.layout,localUser:this.state.localUser,onStartCallClick:this.$3,participants:this.state.participants,remoteUsers:this.state.remoteUsers,serverInfoData:this.state.serverInfoData,thread:null,userMediaRequest:e}),b("React").createElement(b("MessengerBugNub.react"),{isBetaEnabled:this.props.isBetaEnabled,unixName:this.props.unixName}))}else a=b("React").createElement(b("RTCP2PCallContainer.react"),{allowsMWEscalation:this.props.allowsMWEscalation,conferenceName:this.props.conferenceName,isBetaEnabled:this.props.isBetaEnabled,isCaller:this.props.isCaller,isInitiallyAudioCall:this.props.isInitiallyAudioCall,nonce:this.props.nonce,remoteUserFBID:this.props.remoteUserFBID,unixName:this.props.unixName});return b("React").createElement(b("React").Fragment,null,b("React").createElement(b("MessengerBannerOverlay.react"),{display:this.state.conferenceState!==b("RTCConferenceState").TERMINATED,useTimeout:this.state.abortedMWEscalation},this.$4(b("RTCP2PCallStore").isAudioOnly(),b("RTCGroupCallEscalationStore").getState().usersToRing)),a)};j.prototype.$3=function(a,c,d){b("MessengerRTCFunnelLogger").appendAction("click_start_call_button")};j.prototype.$4=function(a,c){c=c?c.toArray().map(function(a){return a.short_name}):null;var d=null;this.state.escalationToMWInProgress&&!this.state.useGroupCallView?(b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","render_adding_participant_escalation_banner"),c?d=a?g._("Adding {names of users being added to call} to your call...",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.AND))]):g._("Adding {names of users being added to call} to your video chat...",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.AND))]):d=a?g._("Adding someone to your call..."):g._("Adding someone to your video chat...")):this.state.abortedMWEscalation&&(b("FunnelLogger").appendAction("WWW_MESSENGER_GROUP_ESCALATION_FUNNEL","render_failed_to_escalate_banner"),c?d=g._("Unable to add {names of users being added to call}",[g._param("names of users being added to call",b("intlList")(c,b("intlList").CONJUNCTIONS.OR))]):d=a?g._("Unable to add person to your call"):g._("Unable to add person to your video chat"));return d};e.exports=b("FluxContainer").create(j)}),null);